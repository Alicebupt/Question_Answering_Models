2018-12-03 21:04:36.023670: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
300
Pre-trained: 26838 (92.18%)
(?, 100, 128)
[epoch 0, batch 10]Loss:0.13847684860229492
[epoch 0, batch 20]Loss:0.1630534529685974
[epoch 0, batch 30]Loss:0.27820608019828796
[epoch 0, batch 40]Loss:0.27475884556770325
[epoch 0, batch 50]Loss:0.14387062191963196
[epoch 0, batch 60]Loss:0.16252535581588745
[epoch 0, batch 70]Loss:0.09087058901786804
[epoch 0, batch 80]Loss:0.25514838099479675
[epoch 0, batch 90]Loss:0.1649378538131714
[epoch 0, batch 100]Loss:0.18617823719978333
[epoch 0, batch 110]Loss:0.18664304912090302
[epoch 0, batch 120]Loss:0.1146155595779419
[epoch 0, batch 130]Loss:0.16448310017585754
[epoch 0, batch 140]Loss:0.23340213298797607
[epoch 0, batch 150]Loss:0.29931217432022095
[epoch 0, batch 160]Loss:0.04139155521988869
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 1, batch 10]Loss:0.26966020464897156
[epoch 1, batch 20]Loss:0.1612875759601593
[epoch 1, batch 30]Loss:0.19155541062355042
[epoch 1, batch 40]Loss:0.10813083499670029
[epoch 1, batch 50]Loss:0.2597922086715698
[epoch 1, batch 60]Loss:0.19900253415107727
[epoch 1, batch 70]Loss:0.21056708693504333
[epoch 1, batch 80]Loss:0.17016522586345673
[epoch 1, batch 90]Loss:0.21886765956878662
[epoch 1, batch 100]Loss:0.24748088419437408
[epoch 1, batch 110]Loss:0.16764411330223083
[epoch 1, batch 120]Loss:0.16360309720039368
[epoch 1, batch 130]Loss:0.18047986924648285
[epoch 1, batch 140]Loss:0.19182559847831726
[epoch 1, batch 150]Loss:0.22972312569618225
[epoch 1, batch 160]Loss:0.0597672238945961
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 2, batch 10]Loss:0.20710331201553345
[epoch 2, batch 20]Loss:0.12728476524353027
[epoch 2, batch 30]Loss:0.24616402387619019
[epoch 2, batch 40]Loss:0.26348596811294556
[epoch 2, batch 50]Loss:0.16805438697338104
[epoch 2, batch 60]Loss:0.19305291771888733
[epoch 2, batch 70]Loss:0.16181285679340363
[epoch 2, batch 80]Loss:0.26555660367012024
[epoch 2, batch 90]Loss:0.15635260939598083
[epoch 2, batch 100]Loss:0.28367695212364197
[epoch 2, batch 110]Loss:0.11584880948066711
[epoch 2, batch 120]Loss:0.11947783827781677
[epoch 2, batch 130]Loss:0.2409668117761612
[epoch 2, batch 140]Loss:0.14207226037979126
[epoch 2, batch 150]Loss:0.22465088963508606
[epoch 2, batch 160]Loss:0.07647758722305298
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 3, batch 10]Loss:0.16918820142745972
[epoch 3, batch 20]Loss:0.1445048749446869
[epoch 3, batch 30]Loss:0.15050578117370605
[epoch 3, batch 40]Loss:0.23302391171455383
[epoch 3, batch 50]Loss:0.15094321966171265
[epoch 3, batch 60]Loss:0.1533592790365219
[epoch 3, batch 70]Loss:0.21921208500862122
[epoch 3, batch 80]Loss:0.34549492597579956
[epoch 3, batch 90]Loss:0.1383388340473175
[epoch 3, batch 100]Loss:0.15586474537849426
[epoch 3, batch 110]Loss:0.1365407109260559
[epoch 3, batch 120]Loss:0.151621013879776
[epoch 3, batch 130]Loss:0.3270726203918457
[epoch 3, batch 140]Loss:0.29625487327575684
[epoch 3, batch 150]Loss:0.258552610874176
[epoch 3, batch 160]Loss:0.3387032449245453
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 4, batch 10]Loss:0.14694207906723022
[epoch 4, batch 20]Loss:0.18993033468723297
[epoch 4, batch 30]Loss:0.22935698926448822
[epoch 4, batch 40]Loss:0.3242449164390564
[epoch 4, batch 50]Loss:0.16200563311576843
[epoch 4, batch 60]Loss:0.1932363361120224
[epoch 4, batch 70]Loss:0.13841092586517334
[epoch 4, batch 80]Loss:0.1411415934562683
[epoch 4, batch 90]Loss:0.19771569967269897
[epoch 4, batch 100]Loss:0.1864623725414276
[epoch 4, batch 110]Loss:0.1874990165233612
[epoch 4, batch 120]Loss:0.13100402057170868
[epoch 4, batch 130]Loss:0.16608667373657227
[epoch 4, batch 140]Loss:0.11793075501918793
[epoch 4, batch 150]Loss:0.2831346094608307
[epoch 4, batch 160]Loss:0.03755654767155647
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 5, batch 10]Loss:0.31095582246780396
[epoch 5, batch 20]Loss:0.1745566725730896
[epoch 5, batch 30]Loss:0.10896656662225723
[epoch 5, batch 40]Loss:0.24348077178001404
[epoch 5, batch 50]Loss:0.09589313715696335
[epoch 5, batch 60]Loss:0.20336079597473145
[epoch 5, batch 70]Loss:0.21208390593528748
[epoch 5, batch 80]Loss:0.14044539630413055
[epoch 5, batch 90]Loss:0.20471596717834473
[epoch 5, batch 100]Loss:0.30168649554252625
[epoch 5, batch 110]Loss:0.1441541612148285
[epoch 5, batch 120]Loss:0.20334386825561523
[epoch 5, batch 130]Loss:0.11968951672315598
[epoch 5, batch 140]Loss:0.19358856976032257
[epoch 5, batch 150]Loss:0.2220965027809143
[epoch 5, batch 160]Loss:0.2827150523662567
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 6, batch 10]Loss:0.133003368973732
[epoch 6, batch 20]Loss:0.2037251591682434
[epoch 6, batch 30]Loss:0.13705085217952728
[epoch 6, batch 40]Loss:0.16413353383541107
[epoch 6, batch 50]Loss:0.0988515317440033
[epoch 6, batch 60]Loss:0.1450382024049759
[epoch 6, batch 70]Loss:0.08120527118444443
[epoch 6, batch 80]Loss:0.19769823551177979
[epoch 6, batch 90]Loss:0.11875966191291809
[epoch 6, batch 100]Loss:0.13351094722747803
[epoch 6, batch 110]Loss:0.21806836128234863
[epoch 6, batch 120]Loss:0.14471307396888733
[epoch 6, batch 130]Loss:0.143546462059021
[epoch 6, batch 140]Loss:0.2467389702796936
[epoch 6, batch 150]Loss:0.23768648505210876
[epoch 6, batch 160]Loss:0.037645526230335236
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 7, batch 10]Loss:0.13423524796962738
[epoch 7, batch 20]Loss:0.1587492823600769
[epoch 7, batch 30]Loss:0.2771205008029938
[epoch 7, batch 40]Loss:0.16301292181015015
[epoch 7, batch 50]Loss:0.12845027446746826
[epoch 7, batch 60]Loss:0.19710208475589752
[epoch 7, batch 70]Loss:0.1595560908317566
[epoch 7, batch 80]Loss:0.10645145922899246
[epoch 7, batch 90]Loss:0.10811008512973785
[epoch 7, batch 100]Loss:0.21615520119667053
[epoch 7, batch 110]Loss:0.19377350807189941
[epoch 7, batch 120]Loss:0.16442427039146423
[epoch 7, batch 130]Loss:0.2300378382205963
[epoch 7, batch 140]Loss:0.1645662933588028
[epoch 7, batch 150]Loss:0.106264628469944
[epoch 7, batch 160]Loss:0.03838524594902992
[train] MAP:0.6091781189542347, MRR:0.6139307483815843
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 8, batch 10]Loss:0.19809678196907043
[epoch 8, batch 20]Loss:0.12890025973320007
[epoch 8, batch 30]Loss:0.18531692028045654
[epoch 8, batch 40]Loss:0.13219980895519257
[epoch 8, batch 50]Loss:0.1609671413898468
[epoch 8, batch 60]Loss:0.11999483406543732
[epoch 8, batch 70]Loss:0.1981276273727417
[epoch 8, batch 80]Loss:0.19874434173107147
[epoch 8, batch 90]Loss:0.17589756846427917
[epoch 8, batch 100]Loss:0.18018385767936707
[epoch 8, batch 110]Loss:0.1595611870288849
[epoch 8, batch 120]Loss:0.180525541305542
[epoch 8, batch 130]Loss:0.13550977408885956
[epoch 8, batch 140]Loss:0.23005250096321106
[epoch 8, batch 150]Loss:0.20440351963043213
[epoch 8, batch 160]Loss:0.09220065176486969
[train] MAP:0.6100372254834443, MRR:0.6150762237538638
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 9, batch 10]Loss:0.1694394052028656
[epoch 9, batch 20]Loss:0.14323599636554718
[epoch 9, batch 30]Loss:0.052160292863845825
[epoch 9, batch 40]Loss:0.1627277135848999
[epoch 9, batch 50]Loss:0.16976255178451538
[epoch 9, batch 60]Loss:0.19907373189926147
[epoch 9, batch 70]Loss:0.1536778211593628
[epoch 9, batch 80]Loss:0.20198997855186462
[epoch 9, batch 90]Loss:0.11594784259796143
[epoch 9, batch 100]Loss:0.21651026606559753
[epoch 9, batch 110]Loss:0.11952096968889236
[epoch 9, batch 120]Loss:0.2227007895708084
[epoch 9, batch 130]Loss:0.1676899790763855
[epoch 9, batch 140]Loss:0.25745683908462524
[epoch 9, batch 150]Loss:0.08461868762969971
[epoch 9, batch 160]Loss:0.1700746715068817
[train] MAP:0.6149054958156321, MRR:0.6198490378050284
[eval] MAP:0.6767573696145125, MRR:0.6790060468631897
[epoch 10, batch 10]Loss:0.13542938232421875
[epoch 10, batch 20]Loss:0.1289435625076294
[epoch 10, batch 30]Loss:0.1794809103012085
[epoch 10, batch 40]Loss:0.17234553396701813
[epoch 10, batch 50]Loss:0.1727631688117981
[epoch 10, batch 60]Loss:0.35067427158355713
[epoch 10, batch 70]Loss:0.17131786048412323
[epoch 10, batch 80]Loss:0.12843964993953705
[epoch 10, batch 90]Loss:0.15477991104125977
[epoch 10, batch 100]Loss:0.118523970246315
[epoch 10, batch 110]Loss:0.16366875171661377
[epoch 10, batch 120]Loss:0.07467429339885712
[epoch 10, batch 130]Loss:0.13284599781036377
[epoch 10, batch 140]Loss:0.14968439936637878
[epoch 10, batch 150]Loss:0.11785673350095749
[epoch 10, batch 160]Loss:0.050750937312841415
[train] MAP:0.6183037394200613, MRR:0.6238200190955974
[eval] MAP:0.6820483749055178, MRR:0.684297052154195
[epoch 11, batch 10]Loss:0.13839569687843323
[epoch 11, batch 20]Loss:0.2098015546798706
[epoch 11, batch 30]Loss:0.08144282549619675
[epoch 11, batch 40]Loss:0.22505120933055878
[epoch 11, batch 50]Loss:0.14886030554771423
[epoch 11, batch 60]Loss:0.1628454029560089
[epoch 11, batch 70]Loss:0.09773179888725281
[epoch 11, batch 80]Loss:0.10584091395139694
[epoch 11, batch 90]Loss:0.15015682578086853
[epoch 11, batch 100]Loss:0.15090450644493103
[epoch 11, batch 110]Loss:0.13096751272678375
[epoch 11, batch 120]Loss:0.11899694800376892
[epoch 11, batch 130]Loss:0.1483311951160431
[epoch 11, batch 140]Loss:0.1326414793729782
[epoch 11, batch 150]Loss:0.22243914008140564
[epoch 11, batch 160]Loss:0.016237668693065643
[train] MAP:0.6108008757316306, MRR:0.6158398740020502
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 12, batch 10]Loss:0.27634671330451965
[epoch 12, batch 20]Loss:0.09549018740653992
[epoch 12, batch 30]Loss:0.15678340196609497
[epoch 12, batch 40]Loss:0.17899277806282043
[epoch 12, batch 50]Loss:0.25506001710891724
[epoch 12, batch 60]Loss:0.14132681488990784
[epoch 12, batch 70]Loss:0.13790497183799744
[epoch 12, batch 80]Loss:0.09252135455608368
[epoch 12, batch 90]Loss:0.13026511669158936
[epoch 12, batch 100]Loss:0.14584821462631226
[epoch 12, batch 110]Loss:0.23885203897953033
[epoch 12, batch 120]Loss:0.198926642537117
[epoch 12, batch 130]Loss:0.20233219861984253
[epoch 12, batch 140]Loss:0.2255699187517166
[epoch 12, batch 150]Loss:0.1415378451347351
[epoch 12, batch 160]Loss:0.019188448786735535
[train] MAP:0.6461140935477124, MRR:0.6540401140064144
[eval] MAP:0.6873393801965232, MRR:0.6895880574452002
[epoch 13, batch 10]Loss:0.1631721705198288
[epoch 13, batch 20]Loss:0.2791004776954651
[epoch 13, batch 30]Loss:0.10327987372875214
[epoch 13, batch 40]Loss:0.204903244972229
[epoch 13, batch 50]Loss:0.13259026408195496
[epoch 13, batch 60]Loss:0.10596388578414917
[epoch 13, batch 70]Loss:0.08699654042720795
[epoch 13, batch 80]Loss:0.11268718540668488
[epoch 13, batch 90]Loss:0.1137256920337677
[epoch 13, batch 100]Loss:0.17583227157592773
[epoch 13, batch 110]Loss:0.1908307522535324
[epoch 13, batch 120]Loss:0.13362732529640198
[epoch 13, batch 130]Loss:0.3601858615875244
[epoch 13, batch 140]Loss:0.1106279045343399
[epoch 13, batch 150]Loss:0.09473200142383575
[epoch 13, batch 160]Loss:0.05357639491558075
[train] MAP:0.6165282525930282, MRR:0.6210899694583312
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 14, batch 10]Loss:0.14120405912399292
[epoch 14, batch 20]Loss:0.13375011086463928
[epoch 14, batch 30]Loss:0.2118222713470459
[epoch 14, batch 40]Loss:0.15964822471141815
[epoch 14, batch 50]Loss:0.14270596206188202
[epoch 14, batch 60]Loss:0.1277994066476822
[epoch 14, batch 70]Loss:0.1729125827550888
[epoch 14, batch 80]Loss:0.12876299023628235
[epoch 14, batch 90]Loss:0.13593341410160065
[epoch 14, batch 100]Loss:0.13218238949775696
[epoch 14, batch 110]Loss:0.22957836091518402
[epoch 14, batch 120]Loss:0.16366073489189148
[epoch 14, batch 130]Loss:0.1770458221435547
[epoch 14, batch 140]Loss:0.11617614328861237
[epoch 14, batch 150]Loss:0.1197991669178009
[epoch 14, batch 160]Loss:0.016114385798573494
[train] MAP:0.6228856409091793, MRR:0.6276382703365291
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 15, batch 10]Loss:0.13450345396995544
[epoch 15, batch 20]Loss:0.10442237555980682
[epoch 15, batch 30]Loss:0.23472490906715393
[epoch 15, batch 40]Loss:0.10561830550432205
[epoch 15, batch 50]Loss:0.16872432827949524
[epoch 15, batch 60]Loss:0.15165366232395172
[epoch 15, batch 70]Loss:0.12561307847499847
[epoch 15, batch 80]Loss:0.08586397767066956
[epoch 15, batch 90]Loss:0.11526982486248016
[epoch 15, batch 100]Loss:0.1641301065683365
[epoch 15, batch 110]Loss:0.15052907168865204
[epoch 15, batch 120]Loss:0.12539637088775635
[epoch 15, batch 130]Loss:0.07376439869403839
[epoch 15, batch 140]Loss:0.1395571082830429
[epoch 15, batch 150]Loss:0.15544632077217102
[epoch 15, batch 160]Loss:0.42160770297050476
[train] MAP:0.666497012431286, MRR:0.6755444385605671
[eval] MAP:0.6889928193499623, MRR:0.69421768707483
[epoch 16, batch 10]Loss:0.14575210213661194
[epoch 16, batch 20]Loss:0.0860871970653534
[epoch 16, batch 30]Loss:0.2040419578552246
[epoch 16, batch 40]Loss:0.09397029876708984
[epoch 16, batch 50]Loss:0.08984733372926712
[epoch 16, batch 60]Loss:0.14185884594917297
[epoch 16, batch 70]Loss:0.21866890788078308
[epoch 16, batch 80]Loss:0.16705621778964996
[epoch 16, batch 90]Loss:0.10686766356229782
[epoch 16, batch 100]Loss:0.15098342299461365
[epoch 16, batch 110]Loss:0.1410834789276123
[epoch 16, batch 120]Loss:0.1175125315785408
[epoch 16, batch 130]Loss:0.17511820793151855
[epoch 16, batch 140]Loss:0.10401926934719086
[epoch 16, batch 150]Loss:0.1575070470571518
[epoch 16, batch 160]Loss:0.06391815096139908
[train] MAP:0.6572971756643572, MRR:0.6669603489197764
[eval] MAP:0.6889928193499623, MRR:0.69421768707483
[epoch 17, batch 10]Loss:0.08322502672672272
[epoch 17, batch 20]Loss:0.17647644877433777
[epoch 17, batch 30]Loss:0.11639264971017838
[epoch 17, batch 40]Loss:0.1226242333650589
[epoch 17, batch 50]Loss:0.13207384943962097
[epoch 17, batch 60]Loss:0.08575408905744553
[epoch 17, batch 70]Loss:0.15208008885383606
[epoch 17, batch 80]Loss:0.1049598753452301
[epoch 17, batch 90]Loss:0.09237019717693329
[epoch 17, batch 100]Loss:0.12910501658916473
[epoch 17, batch 110]Loss:0.15709277987480164
[epoch 17, batch 120]Loss:0.1359158456325531
[epoch 17, batch 130]Loss:0.1552754044532776
[epoch 17, batch 140]Loss:0.13700607419013977
[epoch 17, batch 150]Loss:0.1281639039516449
[epoch 17, batch 160]Loss:0.28809916973114014
[train] MAP:0.7754149146410272, MRR:0.785595947929845
[eval] MAP:0.6905423280423281, MRR:0.6964285714285715
[epoch 18, batch 10]Loss:0.13125303387641907
[epoch 18, batch 20]Loss:0.15328696370124817
[epoch 18, batch 30]Loss:0.070225790143013
[epoch 18, batch 40]Loss:0.1610162854194641
[epoch 18, batch 50]Loss:0.19871720671653748
[epoch 18, batch 60]Loss:0.12139436602592468
[epoch 18, batch 70]Loss:0.14970055222511292
[epoch 18, batch 80]Loss:0.06461986154317856
[epoch 18, batch 90]Loss:0.1843530535697937
[epoch 18, batch 100]Loss:0.1220882385969162
[epoch 18, batch 110]Loss:0.1068667620420456
[epoch 18, batch 120]Loss:0.10347512364387512
[epoch 18, batch 130]Loss:0.1681704819202423
[epoch 18, batch 140]Loss:0.18463477492332458
[epoch 18, batch 150]Loss:0.07133078575134277
[epoch 18, batch 160]Loss:0.10364069789648056
[train] MAP:0.7877064234152528, MRR:0.7976964742106827
[eval] MAP:0.6859126984126985, MRR:0.6891534391534392
[epoch 19, batch 10]Loss:0.06034974008798599
[epoch 19, batch 20]Loss:0.1479361355304718
[epoch 19, batch 30]Loss:0.06800669431686401
[epoch 19, batch 40]Loss:0.13895194232463837
[epoch 19, batch 50]Loss:0.08844920992851257
[epoch 19, batch 60]Loss:0.09858879446983337
[epoch 19, batch 70]Loss:0.10092521458864212
[epoch 19, batch 80]Loss:0.13379766047000885
[epoch 19, batch 90]Loss:0.09408912062644958
[epoch 19, batch 100]Loss:0.11685611307621002
[epoch 19, batch 110]Loss:0.07596670091152191
[epoch 19, batch 120]Loss:0.18311987817287445
[epoch 19, batch 130]Loss:0.14428061246871948
[epoch 19, batch 140]Loss:0.16835597157478333
[epoch 19, batch 150]Loss:0.17285306751728058
[epoch 19, batch 160]Loss:0.039839159697294235
[train] MAP:0.7583591340349466, MRR:0.7706948335391411
[eval] MAP:0.6960978835978836, MRR:0.6983465608465608
[epoch 20, batch 10]Loss:0.12884216010570526
[epoch 20, batch 20]Loss:0.1331799477338791
[epoch 20, batch 30]Loss:0.10956667363643646
[epoch 20, batch 40]Loss:0.13205638527870178
[epoch 20, batch 50]Loss:0.07558014243841171
[epoch 20, batch 60]Loss:0.105600506067276
[epoch 20, batch 70]Loss:0.0824468657374382
[epoch 20, batch 80]Loss:0.09910392761230469
[epoch 20, batch 90]Loss:0.09966419637203217
[epoch 20, batch 100]Loss:0.055344000458717346
[epoch 20, batch 110]Loss:0.09956873953342438
[epoch 20, batch 120]Loss:0.06175168603658676
[epoch 20, batch 130]Loss:0.13972406089305878
[epoch 20, batch 140]Loss:0.13413415849208832
[epoch 20, batch 150]Loss:0.1091058999300003
[epoch 20, batch 160]Loss:0.01743830181658268
[train] MAP:0.8616228404908717, MRR:0.8711901733108097
[eval] MAP:0.6921957671957674, MRR:0.6960978835978837
[epoch 21, batch 10]Loss:0.12321107089519501
[epoch 21, batch 20]Loss:0.15166078507900238
[epoch 21, batch 30]Loss:0.09056159853935242
[epoch 21, batch 40]Loss:0.17293742299079895
[epoch 21, batch 50]Loss:0.1280490905046463
[epoch 21, batch 60]Loss:0.09311670809984207
[epoch 21, batch 70]Loss:0.08928210288286209
[epoch 21, batch 80]Loss:0.23299339413642883
[epoch 21, batch 90]Loss:0.08478225767612457
[epoch 21, batch 100]Loss:0.076946921646595
[epoch 21, batch 110]Loss:0.058759771287441254
[epoch 21, batch 120]Loss:0.1206124946475029
[epoch 21, batch 130]Loss:0.15810909867286682
[epoch 21, batch 140]Loss:0.07252195477485657
[epoch 21, batch 150]Loss:0.0596311092376709
[epoch 21, batch 160]Loss:0.06246316432952881
[train] MAP:0.8649091303750996, MRR:0.8729320644856906
[eval] MAP:0.6937925170068026, MRR:0.6967025699168555
[epoch 22, batch 10]Loss:0.0710282027721405
[epoch 22, batch 20]Loss:0.14706222712993622
[epoch 22, batch 30]Loss:0.13236039876937866
[epoch 22, batch 40]Loss:0.07575670629739761
[epoch 22, batch 50]Loss:0.04762003570795059
[epoch 22, batch 60]Loss:0.07400554418563843
[epoch 22, batch 70]Loss:0.06253056228160858
[epoch 22, batch 80]Loss:0.07945215702056885
[epoch 22, batch 90]Loss:0.1083117127418518
[epoch 22, batch 100]Loss:0.12035517394542694
[epoch 22, batch 110]Loss:0.09844009578227997
[epoch 22, batch 120]Loss:0.07179538905620575
[epoch 22, batch 130]Loss:0.05447506159543991
[epoch 22, batch 140]Loss:0.060530662536621094
[epoch 22, batch 150]Loss:0.1592051088809967
[epoch 22, batch 160]Loss:0.10359232127666473
[train] MAP:0.8976630185168133, MRR:0.9055272597956627
[eval] MAP:0.6830813807004282, MRR:0.6833459309649785
[epoch 23, batch 10]Loss:0.07792714983224869
[epoch 23, batch 20]Loss:0.08655576407909393
[epoch 23, batch 30]Loss:0.031207973137497902
[epoch 23, batch 40]Loss:0.12219145148992538
[epoch 23, batch 50]Loss:0.05909744277596474
[epoch 23, batch 60]Loss:0.09160616993904114
[epoch 23, batch 70]Loss:0.049029745161533356
[epoch 23, batch 80]Loss:0.14766369760036469
[epoch 23, batch 90]Loss:0.08400742709636688
[epoch 23, batch 100]Loss:0.09402118623256683
[epoch 23, batch 110]Loss:0.038760341703891754
[epoch 23, batch 120]Loss:0.06525523215532303
[epoch 23, batch 130]Loss:0.0858415961265564
[epoch 23, batch 140]Loss:0.07153668999671936
[epoch 23, batch 150]Loss:0.04848429560661316
[epoch 23, batch 160]Loss:0.22929750382900238
[train] MAP:0.9384549510787635, MRR:0.9424857851833797
[eval] MAP:0.6645534139581758, MRR:0.6704396573444191
[epoch 24, batch 10]Loss:0.11761654168367386
[epoch 24, batch 20]Loss:0.1029244065284729
[epoch 24, batch 30]Loss:0.059887148439884186
[epoch 24, batch 40]Loss:0.02291550487279892
[epoch 24, batch 50]Loss:0.03726264089345932
[epoch 24, batch 60]Loss:0.07695095986127853
[epoch 24, batch 70]Loss:0.10078480839729309
[epoch 24, batch 80]Loss:0.06730912625789642
[epoch 24, batch 90]Loss:0.07482856512069702
[epoch 24, batch 100]Loss:0.08328035473823547
[epoch 24, batch 110]Loss:0.12891748547554016
[epoch 24, batch 120]Loss:0.07542544603347778
[epoch 24, batch 130]Loss:0.10930190980434418
[epoch 24, batch 140]Loss:0.12666834890842438
[epoch 24, batch 150]Loss:0.09960705041885376
[epoch 24, batch 160]Loss:0.043966908007860184
[train] MAP:0.93298096565156, MRR:0.9362629733763754
[eval] MAP:0.6658446712018138, MRR:0.6717309145880573
[epoch 25, batch 10]Loss:0.08783966302871704
[epoch 25, batch 20]Loss:0.0706043392419815
[epoch 25, batch 30]Loss:0.06875266134738922
[epoch 25, batch 40]Loss:0.057609397917985916
[epoch 25, batch 50]Loss:0.02118159458041191
[epoch 25, batch 60]Loss:0.07133112847805023
[epoch 25, batch 70]Loss:0.14305521547794342
[epoch 25, batch 80]Loss:0.0970415323972702
[epoch 25, batch 90]Loss:0.03961813077330589
[epoch 25, batch 100]Loss:0.06169654056429863
[epoch 25, batch 110]Loss:0.07928501069545746
[epoch 25, batch 120]Loss:0.040873195976018906
[epoch 25, batch 130]Loss:0.0923512801527977
[epoch 25, batch 140]Loss:0.11532562226057053
[epoch 25, batch 150]Loss:0.146586075425148
[epoch 25, batch 160]Loss:0.010142281651496887
[train] MAP:0.9592206762309856, MRR:0.9631829796778252
[eval] MAP:0.6787824389014865, MRR:0.6846686822877298
[epoch 26, batch 10]Loss:0.06441784650087357
[epoch 26, batch 20]Loss:0.07236989587545395
[epoch 26, batch 30]Loss:0.0400707833468914
[epoch 26, batch 40]Loss:0.09199953079223633
[epoch 26, batch 50]Loss:0.04916658625006676
[epoch 26, batch 60]Loss:0.10511250793933868
[epoch 26, batch 70]Loss:0.06442099809646606
[epoch 26, batch 80]Loss:0.07941249758005142
[epoch 26, batch 90]Loss:0.04473872855305672
[epoch 26, batch 100]Loss:0.07872983068227768
[epoch 26, batch 110]Loss:0.050557948648929596
[epoch 26, batch 120]Loss:0.03676581382751465
[epoch 26, batch 130]Loss:0.05784143507480621
[epoch 26, batch 140]Loss:0.09359690546989441
[epoch 26, batch 150]Loss:0.07179562747478485
[epoch 26, batch 160]Loss:0.0048266127705574036
[train] MAP:0.955551737031855, MRR:0.960112882535563
[eval] MAP:0.6862433862433862, MRR:0.691468253968254
[epoch 27, batch 10]Loss:0.04185081273317337
[epoch 27, batch 20]Loss:0.04948467016220093
[epoch 27, batch 30]Loss:0.0403563566505909
[epoch 27, batch 40]Loss:0.03167494013905525
[epoch 27, batch 50]Loss:0.05129259079694748
[epoch 27, batch 60]Loss:0.03281213343143463
[epoch 27, batch 70]Loss:0.05353673920035362
[epoch 27, batch 80]Loss:0.0916915163397789
[epoch 27, batch 90]Loss:0.06945227086544037
[epoch 27, batch 100]Loss:0.26984304189682007
[epoch 27, batch 110]Loss:0.0484393835067749
[epoch 27, batch 120]Loss:0.05314703658223152
[epoch 27, batch 130]Loss:0.09042765200138092
[epoch 27, batch 140]Loss:0.045269593596458435
[epoch 27, batch 150]Loss:0.05520223081111908
[epoch 27, batch 160]Loss:0.026673518121242523
[train] MAP:0.96594514914348, MRR:0.9699253749941036
[eval] MAP:0.6899281934996221, MRR:0.6958144368858654
[epoch 28, batch 10]Loss:0.1019146665930748
[epoch 28, batch 20]Loss:0.06798729300498962
[epoch 28, batch 30]Loss:0.0468074232339859
[epoch 28, batch 40]Loss:0.03626376390457153
[epoch 28, batch 50]Loss:0.08811844885349274
[epoch 28, batch 60]Loss:0.039989158511161804
[epoch 28, batch 70]Loss:0.05529674515128136
[epoch 28, batch 80]Loss:0.022484181448817253
[epoch 28, batch 90]Loss:0.06338005512952805
[epoch 28, batch 100]Loss:0.0482514351606369
[epoch 28, batch 110]Loss:0.050681568682193756
[epoch 28, batch 120]Loss:0.07556258887052536
[epoch 28, batch 130]Loss:0.015909798443317413
[epoch 28, batch 140]Loss:0.07534719258546829
[epoch 28, batch 150]Loss:0.08625969290733337
[epoch 28, batch 160]Loss:0.0064309993758797646
[train] MAP:0.9643567856575741, MRR:0.969085401044164
[eval] MAP:0.6922619047619047, MRR:0.6945105820105819
[epoch 29, batch 10]Loss:0.07904548943042755
[epoch 29, batch 20]Loss:0.047284796833992004
[epoch 29, batch 30]Loss:0.06094776839017868
[epoch 29, batch 40]Loss:0.03685765713453293
[epoch 29, batch 50]Loss:0.0789531022310257
[epoch 29, batch 60]Loss:0.08427733182907104
[epoch 29, batch 70]Loss:0.026685912162065506
[epoch 29, batch 80]Loss:0.052490416914224625
[epoch 29, batch 90]Loss:0.02785613015294075
[epoch 29, batch 100]Loss:0.07135137170553207
[epoch 29, batch 110]Loss:0.03286128118634224
[epoch 29, batch 120]Loss:0.14711306989192963
[epoch 29, batch 130]Loss:0.070641428232193
[epoch 29, batch 140]Loss:0.039023153483867645
[epoch 29, batch 150]Loss:0.059523411095142365
[epoch 29, batch 160]Loss:0.10576038807630539
[train] MAP:0.9825833196967217, MRR:0.9843478972344953
[eval] MAP:0.688690476190476, MRR:0.6916005291005289
[epoch 30, batch 10]Loss:0.034953273832798004
[epoch 30, batch 20]Loss:0.0797133594751358
[epoch 30, batch 30]Loss:0.030859077349305153
[epoch 30, batch 40]Loss:0.044007934629917145
[epoch 30, batch 50]Loss:0.04539799690246582
[epoch 30, batch 60]Loss:0.024386759847402573
[epoch 30, batch 70]Loss:0.05577044188976288
[epoch 30, batch 80]Loss:0.02287258207798004
[epoch 30, batch 90]Loss:0.01882920414209366
[epoch 30, batch 100]Loss:0.04827527701854706
[epoch 30, batch 110]Loss:0.0967206209897995
[epoch 30, batch 120]Loss:0.031841084361076355
[epoch 30, batch 130]Loss:0.07156389951705933
[epoch 30, batch 140]Loss:0.046126507222652435
[epoch 30, batch 150]Loss:0.012444349937140942
[epoch 30, batch 160]Loss:0.0036836457438766956
[train] MAP:0.9696625730130884, MRR:0.9720476163775134
[eval] MAP:0.688558201058201, MRR:0.6908068783068783
[epoch 31, batch 10]Loss:0.06185559928417206
[epoch 31, batch 20]Loss:0.05829313024878502
[epoch 31, batch 30]Loss:0.0506570041179657
[epoch 31, batch 40]Loss:0.04854079708456993
[epoch 31, batch 50]Loss:0.02160707116127014
[epoch 31, batch 60]Loss:0.07228660583496094
[epoch 31, batch 70]Loss:0.028492942452430725
[epoch 31, batch 80]Loss:0.0339166633784771
[epoch 31, batch 90]Loss:0.04179532080888748
[epoch 31, batch 100]Loss:0.010635528713464737
[epoch 31, batch 110]Loss:0.06159679591655731
[epoch 31, batch 120]Loss:0.021572884172201157
[epoch 31, batch 130]Loss:0.0494656004011631
[epoch 31, batch 140]Loss:0.026804298162460327
[epoch 31, batch 150]Loss:0.03815299645066261
[epoch 31, batch 160]Loss:0.0005359908100217581
[train] MAP:0.9788618883979708, MRR:0.9800537282496047
[eval] MAP:0.6902777777777778, MRR:0.6931878306878307
[epoch 32, batch 10]Loss:0.012078305706381798
[epoch 32, batch 20]Loss:0.06508185714483261
[epoch 32, batch 30]Loss:0.012877877801656723
[epoch 32, batch 40]Loss:0.026364348828792572
[epoch 32, batch 50]Loss:0.05328541249036789
[epoch 32, batch 60]Loss:0.0506150983273983
[epoch 32, batch 70]Loss:0.0467904694378376
[epoch 32, batch 80]Loss:0.04465971887111664
[epoch 32, batch 90]Loss:0.008678553625941277
[epoch 32, batch 100]Loss:0.03442881256341934
[epoch 32, batch 110]Loss:0.03273923695087433
[epoch 32, batch 120]Loss:0.08828617632389069
[epoch 32, batch 130]Loss:0.05749378353357315
[epoch 32, batch 140]Loss:0.015856489539146423
[epoch 32, batch 150]Loss:0.1377352476119995
[epoch 32, batch 160]Loss:0.0009059106232598424
[train] MAP:0.991962581137839, MRR:0.9924971363115693
[eval] MAP:0.6917233560090703, MRR:0.6946334089191232
[epoch 33, batch 10]Loss:0.04488447681069374
[epoch 33, batch 20]Loss:0.025390617549419403
[epoch 33, batch 30]Loss:0.009761251509189606
[epoch 33, batch 40]Loss:0.029660258442163467
[epoch 33, batch 50]Loss:0.04766217619180679
[epoch 33, batch 60]Loss:0.018769241869449615
[epoch 33, batch 70]Loss:0.011277695186436176
[epoch 33, batch 80]Loss:0.0398055799305439
[epoch 33, batch 90]Loss:0.05222808197140694
[epoch 33, batch 100]Loss:0.04583527147769928
[epoch 33, batch 110]Loss:0.04021123796701431
[epoch 33, batch 120]Loss:0.009508747607469559
[epoch 33, batch 130]Loss:0.007682216819375753
[epoch 33, batch 140]Loss:0.020386047661304474
[epoch 33, batch 150]Loss:0.04427945241332054
[epoch 33, batch 160]Loss:0.007318693213164806
[train] MAP:0.9812204977153431, MRR:0.9820986955007575
[eval] MAP:0.6925264550264549, MRR:0.6947751322751322
[epoch 34, batch 10]Loss:0.0055497740395367146
[epoch 34, batch 20]Loss:0.024027269333600998
[epoch 34, batch 30]Loss:0.018337078392505646
[epoch 34, batch 40]Loss:0.048737622797489166
[epoch 34, batch 50]Loss:0.032727185636758804
[epoch 34, batch 60]Loss:0.029540609568357468
[epoch 34, batch 70]Loss:0.0318480059504509
[epoch 34, batch 80]Loss:0.03031717985868454
[epoch 34, batch 90]Loss:0.02193387597799301
[epoch 34, batch 100]Loss:0.051837269216775894
[epoch 34, batch 110]Loss:0.054136402904987335
[epoch 34, batch 120]Loss:0.0650637075304985
[epoch 34, batch 130]Loss:0.034751810133457184
[epoch 34, batch 140]Loss:0.06619288772344589
[epoch 34, batch 150]Loss:0.0143045112490654
[epoch 34, batch 160]Loss:1.0825912952423096
[train] MAP:0.9893383725857953, MRR:0.9898292906024864
[eval] MAP:0.690542328042328, MRR:0.6934523809523809
[epoch 35, batch 10]Loss:0.04755853861570358
[epoch 35, batch 20]Loss:0.01513828244060278
[epoch 35, batch 30]Loss:0.01848749816417694
[epoch 35, batch 40]Loss:0.061943087726831436
[epoch 35, batch 50]Loss:0.024017632007598877
[epoch 35, batch 60]Loss:0.055362507700920105
[epoch 35, batch 70]Loss:0.009843578562140465
[epoch 35, batch 80]Loss:0.029185879975557327
[epoch 35, batch 90]Loss:0.007888348773121834
[epoch 35, batch 100]Loss:0.024894844740629196
[epoch 35, batch 110]Loss:0.05073815584182739
[epoch 35, batch 120]Loss:0.06158646196126938
[epoch 35, batch 130]Loss:0.03959561511874199
[epoch 35, batch 140]Loss:0.018962688744068146
[epoch 35, batch 150]Loss:0.013852912001311779
[epoch 35, batch 160]Loss:0.0001365462230751291
[train] MAP:0.9905520310159487, MRR:0.9905138485035394
[eval] MAP:0.6971560846560846, MRR:0.7000661375661376
[epoch 36, batch 10]Loss:0.006388746201992035
[epoch 36, batch 20]Loss:0.013630971312522888
[epoch 36, batch 30]Loss:0.019509203732013702
[epoch 36, batch 40]Loss:0.03048817813396454
[epoch 36, batch 50]Loss:0.00488577876240015
[epoch 36, batch 60]Loss:0.05213388055562973
[epoch 36, batch 70]Loss:0.02908269874751568
[epoch 36, batch 80]Loss:0.016194256022572517
[epoch 36, batch 90]Loss:0.010066315531730652
[epoch 36, batch 100]Loss:0.01678656041622162
[epoch 36, batch 110]Loss:0.045607417821884155
[epoch 36, batch 120]Loss:0.031762756407260895
[epoch 36, batch 130]Loss:0.024800335988402367
[epoch 36, batch 140]Loss:0.01724632829427719
[epoch 36, batch 150]Loss:0.011029277928173542
[epoch 36, batch 160]Loss:0.0015475379768759012
[train] MAP:0.9957426498663613, MRR:0.9960862924780451
[eval] MAP:0.6964947089947089, MRR:0.6987433862433862
[epoch 37, batch 10]Loss:0.019661132246255875
[epoch 37, batch 20]Loss:0.00636958796530962
[epoch 37, batch 30]Loss:0.020686034113168716
[epoch 37, batch 40]Loss:0.01609053649008274
[epoch 37, batch 50]Loss:0.0018541914178058505
[epoch 37, batch 60]Loss:0.06552927196025848
[epoch 37, batch 70]Loss:0.025414813309907913
[epoch 37, batch 80]Loss:0.05239821970462799
[epoch 37, batch 90]Loss:0.039554305374622345
[epoch 37, batch 100]Loss:0.02436814084649086
[epoch 37, batch 110]Loss:0.021025069057941437
[epoch 37, batch 120]Loss:0.040030356496572495
[epoch 37, batch 130]Loss:0.008309675380587578
[epoch 37, batch 140]Loss:0.03357943892478943
[epoch 37, batch 150]Loss:0.003200916340574622
[epoch 37, batch 160]Loss:0.009886038489639759
[train] MAP:0.9915739377079584, MRR:0.992203949162712
[eval] MAP:0.7017857142857141, MRR:0.7046957671957672
[epoch 38, batch 10]Loss:0.008907919749617577
[epoch 38, batch 20]Loss:0.014588977210223675
[epoch 38, batch 30]Loss:0.019963130354881287
[epoch 38, batch 40]Loss:0.0184969212859869
[epoch 38, batch 50]Loss:0.004690447822213173
[epoch 38, batch 60]Loss:0.024482589215040207
[epoch 38, batch 70]Loss:0.030342306941747665
[epoch 38, batch 80]Loss:0.04620007798075676
[epoch 38, batch 90]Loss:0.02855963259935379
[epoch 38, batch 100]Loss:0.06906827539205551
[epoch 38, batch 110]Loss:0.012573320418596268
[epoch 38, batch 120]Loss:0.021944595500826836
[epoch 38, batch 130]Loss:0.021040380001068115
[epoch 38, batch 140]Loss:0.028708575293421745
[epoch 38, batch 150]Loss:0.017918892204761505
[epoch 38, batch 160]Loss:2.515231244615279e-05
[train] MAP:0.9920607647411772, MRR:0.9922994054437354
[eval] MAP:0.6922619047619047, MRR:0.6945105820105819
[epoch 39, batch 10]Loss:0.0034057442098855972
[epoch 39, batch 20]Loss:0.006073193624615669
[epoch 39, batch 30]Loss:0.010102411732077599
[epoch 39, batch 40]Loss:0.05846122279763222
[epoch 39, batch 50]Loss:0.011213108897209167
[epoch 39, batch 60]Loss:0.03984586521983147
[epoch 39, batch 70]Loss:0.01084215845912695
[epoch 39, batch 80]Loss:0.004383744206279516
[epoch 39, batch 90]Loss:0.026910196989774704
[epoch 39, batch 100]Loss:0.0071292445063591
[epoch 39, batch 110]Loss:0.00321619538590312
[epoch 39, batch 120]Loss:0.08868436515331268
[epoch 39, batch 130]Loss:0.036879416555166245
[epoch 39, batch 140]Loss:0.01795199140906334
[epoch 39, batch 150]Loss:0.011844540014863014
[epoch 39, batch 160]Loss:0.0008087408496066928
[train] MAP:0.9975563192058038, MRR:0.997709049255441
[eval] MAP:0.6862433862433861, MRR:0.6891534391534391
[epoch 40, batch 10]Loss:0.04171697050333023
[epoch 40, batch 20]Loss:0.012261208146810532
[epoch 40, batch 30]Loss:0.046194445341825485
[epoch 40, batch 40]Loss:0.015498875640332699
[epoch 40, batch 50]Loss:0.028823476284742355
[epoch 40, batch 60]Loss:0.034239985048770905
[epoch 40, batch 70]Loss:0.01461221557110548
[epoch 40, batch 80]Loss:0.011901497840881348
[epoch 40, batch 90]Loss:0.025140948593616486
[epoch 40, batch 100]Loss:0.02312905341386795
[epoch 40, batch 110]Loss:0.020651737228035927
[epoch 40, batch 120]Loss:0.017134904861450195
[epoch 40, batch 130]Loss:0.05922196805477142
[epoch 40, batch 140]Loss:0.02112177573144436
[epoch 40, batch 150]Loss:0.006855356507003307
[epoch 40, batch 160]Loss:0.008007493801414967
[train] MAP:0.9809941299632022, MRR:0.9830137121374236
[eval] MAP:0.688558201058201, MRR:0.6908068783068783
[epoch 41, batch 10]Loss:0.013159895315766335
[epoch 41, batch 20]Loss:0.010493680834770203
[epoch 41, batch 30]Loss:0.03677051514387131
[epoch 41, batch 40]Loss:0.008430669084191322
[epoch 41, batch 50]Loss:0.015456476248800755
[epoch 41, batch 60]Loss:0.008662725798785686
[epoch 41, batch 70]Loss:0.02388773299753666
[epoch 41, batch 80]Loss:0.011617748066782951
[epoch 41, batch 90]Loss:0.02301299385726452
[epoch 41, batch 100]Loss:0.011659307405352592
[epoch 41, batch 110]Loss:0.06823000311851501
[epoch 41, batch 120]Loss:0.008176883682608604
[epoch 41, batch 130]Loss:0.015144335106015205
[epoch 41, batch 140]Loss:0.04142554849386215
[epoch 41, batch 150]Loss:0.004989114589989185
[epoch 41, batch 160]Loss:0.0817265585064888
[train] MAP:0.991876670484918, MRR:0.992315769377625
[eval] MAP:0.6931878306878307, MRR:0.6954365079365079
[epoch 42, batch 10]Loss:0.016491714864969254
[epoch 42, batch 20]Loss:0.013792643323540688
[epoch 42, batch 30]Loss:0.007237892597913742
[epoch 42, batch 40]Loss:0.011978069320321083
[epoch 42, batch 50]Loss:0.005074426531791687
[epoch 42, batch 60]Loss:0.008917942643165588
[epoch 42, batch 70]Loss:0.02410830557346344
[epoch 42, batch 80]Loss:0.005602029152214527
[epoch 42, batch 90]Loss:0.01712207682430744
[epoch 42, batch 100]Loss:0.029759034514427185
[epoch 42, batch 110]Loss:0.09200144559144974
[epoch 42, batch 120]Loss:0.03170093894004822
[epoch 42, batch 130]Loss:0.037381526082754135
[epoch 42, batch 140]Loss:0.010729728266596794
[epoch 42, batch 150]Loss:0.036141287535429
[epoch 42, batch 160]Loss:0.0048826392740011215
[train] MAP:0.9971363115693013, MRR:0.9971363115693013
[eval] MAP:0.6676492819349962, MRR:0.6735355253212396
[epoch 43, batch 10]Loss:0.012814965099096298
[epoch 43, batch 20]Loss:0.0033429088070988655
[epoch 43, batch 30]Loss:0.025984585285186768
[epoch 43, batch 40]Loss:0.010067087598145008
[epoch 43, batch 50]Loss:0.014984259381890297
[epoch 43, batch 60]Loss:0.0056565022096037865
[epoch 43, batch 70]Loss:0.07232247292995453
[epoch 43, batch 80]Loss:0.03571370616555214
[epoch 43, batch 90]Loss:0.09497466683387756
[epoch 43, batch 100]Loss:0.01046198233962059
[epoch 43, batch 110]Loss:0.02661527693271637
[epoch 43, batch 120]Loss:0.024444807320833206
[epoch 43, batch 130]Loss:0.015472420491278172
[epoch 43, batch 140]Loss:0.001137113431468606
[epoch 43, batch 150]Loss:0.016182541847229004
[epoch 43, batch 160]Loss:0.0005965689779259264
[train] MAP:0.9966972126765942, MRR:0.9970885834287897
[eval] MAP:0.6962301587301587, MRR:0.6991402116402117
[epoch 44, batch 10]Loss:0.03285127505660057
[epoch 44, batch 20]Loss:0.007449813652783632
[epoch 44, batch 30]Loss:0.025944527238607407
[epoch 44, batch 40]Loss:0.016780296340584755
[epoch 44, batch 50]Loss:0.0029763076454401016
[epoch 44, batch 60]Loss:0.008775619789958
[epoch 44, batch 70]Loss:0.0593942254781723
[epoch 44, batch 80]Loss:0.03161917254328728
[epoch 44, batch 90]Loss:0.08733031153678894
[epoch 44, batch 100]Loss:0.07301595062017441
[epoch 44, batch 110]Loss:0.05614468455314636
[epoch 44, batch 120]Loss:0.011592170223593712
[epoch 44, batch 130]Loss:0.018514983355998993
[epoch 44, batch 140]Loss:0.013192376121878624
[epoch 44, batch 150]Loss:0.02343478985130787
[epoch 44, batch 160]Loss:0.0051847221329808235
[train] MAP:0.993270332187858, MRR:0.993270332187858
[eval] MAP:0.651864449483497, MRR:0.6574861426051901
[epoch 45, batch 10]Loss:0.01689610630273819
[epoch 45, batch 20]Loss:0.007064314559102058
[epoch 45, batch 30]Loss:0.018181513994932175
[epoch 45, batch 40]Loss:0.009777436032891273
[epoch 45, batch 50]Loss:0.005208447575569153
[epoch 45, batch 60]Loss:0.008165376260876656
[epoch 45, batch 70]Loss:0.004821990616619587
[epoch 45, batch 80]Loss:0.026329796761274338
[epoch 45, batch 90]Loss:0.00586174288764596
[epoch 45, batch 100]Loss:0.04175163060426712
[epoch 45, batch 110]Loss:0.010052299126982689
[epoch 45, batch 120]Loss:0.021056517958641052
[epoch 45, batch 130]Loss:0.01267626229673624
[epoch 45, batch 140]Loss:0.002978733740746975
[epoch 45, batch 150]Loss:0.010488040745258331
[epoch 45, batch 160]Loss:0.00026839430211111903
[train] MAP:0.995504009163803, MRR:0.9956567392134403
[eval] MAP:0.6925264550264549, MRR:0.6954365079365079
[epoch 46, batch 10]Loss:0.0071646468713879585
[epoch 46, batch 20]Loss:0.025904402136802673
[epoch 46, batch 30]Loss:0.018895845860242844
[epoch 46, batch 40]Loss:0.027493253350257874
[epoch 46, batch 50]Loss:0.021255355328321457
[epoch 46, batch 60]Loss:0.009579457342624664
[epoch 46, batch 70]Loss:0.03563707321882248
[epoch 46, batch 80]Loss:0.01195252500474453
[epoch 46, batch 90]Loss:0.019230354577302933
[epoch 46, batch 100]Loss:0.005843659397214651
[epoch 46, batch 110]Loss:0.02451639622449875
[epoch 46, batch 120]Loss:0.0012699563521891832
[epoch 46, batch 130]Loss:0.011453487910330296
[epoch 46, batch 140]Loss:0.005319842137396336
[epoch 46, batch 150]Loss:0.008204811252653599
[epoch 46, batch 160]Loss:0.00012530371895991266
[train] MAP:0.9976986358429659, MRR:0.9981950085042869
[eval] MAP:0.6931878306878307, MRR:0.6954365079365079
[epoch 47, batch 10]Loss:0.030039053410291672
[epoch 47, batch 20]Loss:0.0015387276653200388
[epoch 47, batch 30]Loss:0.017822058871388435
[epoch 47, batch 40]Loss:0.00325207132846117
[epoch 47, batch 50]Loss:0.02472946047782898
[epoch 47, batch 60]Loss:0.0013710454804822803
[epoch 47, batch 70]Loss:0.006351226940751076
[epoch 47, batch 80]Loss:0.013624075800180435
[epoch 47, batch 90]Loss:0.00748192984610796
[epoch 47, batch 100]Loss:0.0017277238657698035
[epoch 47, batch 110]Loss:0.007620623800903559
[epoch 47, batch 120]Loss:0.0076128700748085976
[epoch 47, batch 130]Loss:0.002924948465079069
[epoch 47, batch 140]Loss:0.005452671553939581
[epoch 47, batch 150]Loss:0.029434090480208397
[epoch 47, batch 160]Loss:0.01413778867572546
[train] MAP:0.9951317296678123, MRR:0.9952271859488355
[eval] MAP:0.6662824389014864, MRR:0.6691924918115394
[epoch 48, batch 10]Loss:0.017522618174552917
[epoch 48, batch 20]Loss:0.005387119948863983
[epoch 48, batch 30]Loss:0.0025992924347519875
[epoch 48, batch 40]Loss:0.06818803399801254
[epoch 48, batch 50]Loss:0.00031101948115974665
[epoch 48, batch 60]Loss:0.0017020369414240122
[epoch 48, batch 70]Loss:0.005464717745780945
[epoch 48, batch 80]Loss:0.06334396451711655
[epoch 48, batch 90]Loss:0.004522507544606924
[epoch 48, batch 100]Loss:0.020208459347486496
[epoch 48, batch 110]Loss:0.06235349923372269
[epoch 48, batch 120]Loss:0.027779139578342438
[epoch 48, batch 130]Loss:0.016240760684013367
[epoch 48, batch 140]Loss:0.033458858728408813
[epoch 48, batch 150]Loss:0.0063215093687176704
[epoch 48, batch 160]Loss:0.00034159744973294437
[train] MAP:0.9976613211149294, MRR:0.9976613211149294
[eval] MAP:0.6742630385487529, MRR:0.6771730914588058
[epoch 49, batch 10]Loss:0.032833032310009
[epoch 49, batch 20]Loss:0.011623051948845387
[epoch 49, batch 30]Loss:0.006074331700801849
[epoch 49, batch 40]Loss:0.0017659284640103579
[epoch 49, batch 50]Loss:0.0015336200594902039
[epoch 49, batch 60]Loss:0.0023432152811437845
[epoch 49, batch 70]Loss:0.002954622497782111
[epoch 49, batch 80]Loss:0.045665666460990906
[epoch 49, batch 90]Loss:0.03453877940773964
[epoch 49, batch 100]Loss:0.020634742453694344
[epoch 49, batch 110]Loss:0.012606058269739151
[epoch 49, batch 120]Loss:0.1483919322490692
[epoch 49, batch 130]Loss:0.022233949974179268
[epoch 49, batch 140]Loss:0.03445254638791084
[epoch 49, batch 150]Loss:0.015398213639855385
[epoch 49, batch 160]Loss:4.399949102662504e-05
[train] MAP:0.9977854142802596, MRR:0.9982817869415808
[eval] MAP:0.6929232804232804, MRR:0.6951719576719577
[epoch 50, batch 10]Loss:0.008475280366837978
[epoch 50, batch 20]Loss:0.01803683303296566
[epoch 50, batch 30]Loss:0.0030039059929549694
[epoch 50, batch 40]Loss:0.003931974992156029
[epoch 50, batch 50]Loss:0.01999664679169655
[epoch 50, batch 60]Loss:0.0013161362148821354
[epoch 50, batch 70]Loss:0.0035641007125377655
[epoch 50, batch 80]Loss:0.02339591085910797
[epoch 50, batch 90]Loss:0.03588661924004555
[epoch 50, batch 100]Loss:0.006113770417869091
[epoch 50, batch 110]Loss:0.0046520228497684
[epoch 50, batch 120]Loss:0.0015518057625740767
[epoch 50, batch 130]Loss:0.02034047059714794
[epoch 50, batch 140]Loss:0.0010619183303788304
[epoch 50, batch 150]Loss:0.0022900188341736794
[epoch 50, batch 160]Loss:0.0007979630609042943
[train] MAP:0.9986158839251622, MRR:0.9988545246277205
[eval] MAP:0.6934429327286469, MRR:0.6956916099773243
[epoch 51, batch 10]Loss:0.0018099674489349127
[epoch 51, batch 20]Loss:0.016215601935982704
[epoch 51, batch 30]Loss:0.017619283869862556
[epoch 51, batch 40]Loss:0.051260050386190414
[epoch 51, batch 50]Loss:0.0063934652134776115
[epoch 51, batch 60]Loss:0.003161865519359708
[epoch 51, batch 70]Loss:0.011729801073670387
[epoch 51, batch 80]Loss:0.014856316149234772
[epoch 51, batch 90]Loss:0.002821020781993866
[epoch 51, batch 100]Loss:0.0014754877192899585
[epoch 51, batch 110]Loss:0.0012291932944208384
[epoch 51, batch 120]Loss:0.030912362039089203
[epoch 51, batch 130]Loss:0.012105744332075119
[epoch 51, batch 140]Loss:0.042484402656555176
[epoch 51, batch 150]Loss:0.007162627764046192
[epoch 51, batch 160]Loss:0.00019042324856854975
[train] MAP:0.9985108820160367, MRR:0.9988545246277205
[eval] MAP:0.7015211640211639, MRR:0.7037698412698412
[epoch 52, batch 10]Loss:0.012488288804888725
[epoch 52, batch 20]Loss:0.03408142924308777
[epoch 52, batch 30]Loss:0.017362315207719803
[epoch 52, batch 40]Loss:0.021318688988685608
[epoch 52, batch 50]Loss:0.034826185554265976
[epoch 52, batch 60]Loss:0.0013423756463453174
[epoch 52, batch 70]Loss:0.005650852806866169
[epoch 52, batch 80]Loss:0.03212233632802963
[epoch 52, batch 90]Loss:0.0033684740774333477
[epoch 52, batch 100]Loss:0.013346073217689991
[epoch 52, batch 110]Loss:0.0006354680517688394
[epoch 52, batch 120]Loss:0.0039537991397082806
[epoch 52, batch 130]Loss:0.0077690077014267445
[epoch 52, batch 140]Loss:0.004591346252709627
[epoch 52, batch 150]Loss:0.006248777266591787
[epoch 52, batch 160]Loss:0.03801305964589119
[train] MAP:0.9959908361970218, MRR:0.9959908361970218
[eval] MAP:0.677116402116402, MRR:0.6793650793650792
[epoch 53, batch 10]Loss:0.004245640244334936
[epoch 53, batch 20]Loss:0.0012454098323360085
[epoch 53, batch 30]Loss:0.06205526366829872
[epoch 53, batch 40]Loss:0.016498032957315445
[epoch 53, batch 50]Loss:0.02235344797372818
[epoch 53, batch 60]Loss:0.011914288625121117
[epoch 53, batch 70]Loss:0.0028177325148135424
[epoch 53, batch 80]Loss:0.004721125587821007
[epoch 53, batch 90]Loss:0.03479078784584999
[epoch 53, batch 100]Loss:0.0016952014993876219
[epoch 53, batch 110]Loss:0.017760906368494034
[epoch 53, batch 120]Loss:0.02061755210161209
[epoch 53, batch 130]Loss:0.007951495237648487
[epoch 53, batch 140]Loss:0.1589914858341217
[epoch 53, batch 150]Loss:0.003914898261427879
[epoch 53, batch 160]Loss:6.047607530490495e-05
[train] MAP:0.9990181639666176, MRR:0.9990181639666176
[eval] MAP:0.688558201058201, MRR:0.6908068783068783
[epoch 54, batch 10]Loss:0.0023467675782740116
[epoch 54, batch 20]Loss:0.022547446191310883
[epoch 54, batch 30]Loss:0.013080254197120667
[epoch 54, batch 40]Loss:0.008255490101873875
[epoch 54, batch 50]Loss:0.001501545775681734
[epoch 54, batch 60]Loss:0.0028715897351503372
[epoch 54, batch 70]Loss:0.05212157219648361
[epoch 54, batch 80]Loss:0.003097738139331341
[epoch 54, batch 90]Loss:0.018292082473635674
[epoch 54, batch 100]Loss:0.001821857993490994
[epoch 54, batch 110]Loss:0.012793493457138538
[epoch 54, batch 120]Loss:0.013955801725387573
[epoch 54, batch 130]Loss:0.02233230695128441
[epoch 54, batch 140]Loss:0.007559233345091343
[epoch 54, batch 150]Loss:0.052448973059654236
[epoch 54, batch 160]Loss:7.897604064055486e-07
[train] MAP:0.9951052394080068, MRR:0.9958602118124636
[eval] MAP:0.6843253968253967, MRR:0.686574074074074
[epoch 55, batch 10]Loss:0.0871807411313057
[epoch 55, batch 20]Loss:0.002973464783281088
[epoch 55, batch 30]Loss:0.0016598098445683718
[epoch 55, batch 40]Loss:0.012250223197042942
[epoch 55, batch 50]Loss:0.015604473650455475
[epoch 55, batch 60]Loss:0.0045323558151721954
[epoch 55, batch 70]Loss:0.008717038668692112
[epoch 55, batch 80]Loss:0.021408379077911377
[epoch 55, batch 90]Loss:0.002934075891971588
[epoch 55, batch 100]Loss:0.0030103670433163643
[epoch 55, batch 110]Loss:0.0053175357170403
[epoch 55, batch 120]Loss:0.00571006815880537
[epoch 55, batch 130]Loss:0.021122366189956665
[epoch 55, batch 140]Loss:0.03931232541799545
[epoch 55, batch 150]Loss:0.0309861209243536
[epoch 55, batch 160]Loss:0.05127181485295296
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6857898715041572, MRR:0.6910147392290249
[epoch 56, batch 10]Loss:0.004420327488332987
[epoch 56, batch 20]Loss:0.001328157028183341
[epoch 56, batch 30]Loss:0.002685943152755499
[epoch 56, batch 40]Loss:0.004183023236691952
[epoch 56, batch 50]Loss:0.005613628309220076
[epoch 56, batch 60]Loss:0.01891244575381279
[epoch 56, batch 70]Loss:0.016590043902397156
[epoch 56, batch 80]Loss:0.0005839283694513142
[epoch 56, batch 90]Loss:0.025127964094281197
[epoch 56, batch 100]Loss:0.012561903335154057
[epoch 56, batch 110]Loss:0.0033977753482759
[epoch 56, batch 120]Loss:0.005518235731869936
[epoch 56, batch 130]Loss:0.003943769261240959
[epoch 56, batch 140]Loss:0.006150891073048115
[epoch 56, batch 150]Loss:0.01241026446223259
[epoch 56, batch 160]Loss:0.0003015146648976952
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6937263794406651, MRR:0.6989512471655328
[epoch 57, batch 10]Loss:0.012010470032691956
[epoch 57, batch 20]Loss:0.007311390712857246
[epoch 57, batch 30]Loss:0.0013057223986834288
[epoch 57, batch 40]Loss:0.007271061651408672
[epoch 57, batch 50]Loss:0.0038323677144944668
[epoch 57, batch 60]Loss:0.0042849015444517136
[epoch 57, batch 70]Loss:0.0028422982431948185
[epoch 57, batch 80]Loss:0.005958680063486099
[epoch 57, batch 90]Loss:0.037965454161167145
[epoch 57, batch 100]Loss:0.03277776390314102
[epoch 57, batch 110]Loss:0.0268214400857687
[epoch 57, batch 120]Loss:0.01032270211726427
[epoch 57, batch 130]Loss:0.009990040212869644
[epoch 57, batch 140]Loss:0.00216528563760221
[epoch 57, batch 150]Loss:0.005204418208450079
[epoch 57, batch 160]Loss:0.005372319370508194
[train] MAP:0.9982817869415808, MRR:0.9982817869415808
[eval] MAP:0.6888321995464851, MRR:0.6947184429327284
[epoch 58, batch 10]Loss:0.0059484150260686874
[epoch 58, batch 20]Loss:0.004993359558284283
[epoch 58, batch 30]Loss:0.005052922293543816
[epoch 58, batch 40]Loss:0.012416754849255085
[epoch 58, batch 50]Loss:0.01455521397292614
[epoch 58, batch 60]Loss:0.0037426704075187445
[epoch 58, batch 70]Loss:0.014037498272955418
[epoch 58, batch 80]Loss:0.013232128694653511
[epoch 58, batch 90]Loss:0.0029773423448204994
[epoch 58, batch 100]Loss:0.012920062057673931
[epoch 58, batch 110]Loss:0.013710200786590576
[epoch 58, batch 120]Loss:0.033209796994924545
[epoch 58, batch 130]Loss:0.027441183105111122
[epoch 58, batch 140]Loss:0.05157892405986786
[epoch 58, batch 150]Loss:0.002929851645603776
[epoch 58, batch 160]Loss:3.939689850085415e-05
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6884353741496597, MRR:0.6936602418745275
[epoch 59, batch 10]Loss:0.0009232005104422569
[epoch 59, batch 20]Loss:0.0009747002623043954
[epoch 59, batch 30]Loss:0.004542842041701078
[epoch 59, batch 40]Loss:0.05608212947845459
[epoch 59, batch 50]Loss:0.006749339867383242
[epoch 59, batch 60]Loss:0.011813795194029808
[epoch 59, batch 70]Loss:0.014616992324590683
[epoch 59, batch 80]Loss:0.013204583898186684
[epoch 59, batch 90]Loss:0.0019036969169974327
[epoch 59, batch 100]Loss:0.01370964664965868
[epoch 59, batch 110]Loss:0.009056282229721546
[epoch 59, batch 120]Loss:0.005684463307261467
[epoch 59, batch 130]Loss:0.002925014356151223
[epoch 59, batch 140]Loss:0.014304090291261673
[epoch 59, batch 150]Loss:0.04969962686300278
[epoch 59, batch 160]Loss:0.03326578438282013
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6904195011337867, MRR:0.6963057445200301
[epoch 60, batch 10]Loss:0.004112976603209972
[epoch 60, batch 20]Loss:0.0031012827530503273
[epoch 60, batch 30]Loss:0.011090974323451519
[epoch 60, batch 40]Loss:0.020522911101579666
[epoch 60, batch 50]Loss:0.022490693256258965
[epoch 60, batch 60]Loss:0.0009231279254890978
[epoch 60, batch 70]Loss:0.0024732835590839386
[epoch 60, batch 80]Loss:0.0014210471417754889
[epoch 60, batch 90]Loss:0.00114525412209332
[epoch 60, batch 100]Loss:0.011684710159897804
[epoch 60, batch 110]Loss:0.03453092649579048
[epoch 60, batch 120]Loss:0.004799434915184975
[epoch 60, batch 130]Loss:0.0004208607133477926
[epoch 60, batch 140]Loss:0.015834972262382507
[epoch 60, batch 150]Loss:0.010560620576143265
[epoch 60, batch 160]Loss:0.0020546054001897573
[train] MAP:0.9976135929744177, MRR:0.997709049255441
[eval] MAP:0.6738284202569916, MRR:0.6794501133786848
[epoch 61, batch 10]Loss:0.005480966065078974
[epoch 61, batch 20]Loss:0.008219693787395954
[epoch 61, batch 30]Loss:0.008645846508443356
[epoch 61, batch 40]Loss:0.0060832304880023
[epoch 61, batch 50]Loss:0.004962146282196045
[epoch 61, batch 60]Loss:0.006498732138425112
[epoch 61, batch 70]Loss:0.0333891287446022
[epoch 61, batch 80]Loss:0.013659868389368057
[epoch 61, batch 90]Loss:0.006840893998742104
[epoch 61, batch 100]Loss:0.03905657306313515
[epoch 61, batch 110]Loss:0.06232813373208046
[epoch 61, batch 120]Loss:0.013407610356807709
[epoch 61, batch 130]Loss:0.002617760095745325
[epoch 61, batch 140]Loss:0.016788862645626068
[epoch 61, batch 150]Loss:0.01683518849313259
[epoch 61, batch 160]Loss:0.0008070789044722915
[train] MAP:0.980017818505791, MRR:0.980049637266132
[eval] MAP:0.6603080120937264, MRR:0.6659297052154195
[epoch 62, batch 10]Loss:0.04621737822890282
[epoch 62, batch 20]Loss:0.024394884705543518
[epoch 62, batch 30]Loss:0.009635143913328648
[epoch 62, batch 40]Loss:0.04206762835383415
[epoch 62, batch 50]Loss:0.020975256338715553
[epoch 62, batch 60]Loss:0.004423845559358597
[epoch 62, batch 70]Loss:0.005608695093542337
[epoch 62, batch 80]Loss:0.003743415465578437
[epoch 62, batch 90]Loss:0.007480993866920471
[epoch 62, batch 100]Loss:0.00813261978328228
[epoch 62, batch 110]Loss:0.0005950607592239976
[epoch 62, batch 120]Loss:0.004571456927806139
[epoch 62, batch 130]Loss:0.013015094213187695
[epoch 62, batch 140]Loss:0.02142205461859703
[epoch 62, batch 150]Loss:0.008361618965864182
[epoch 62, batch 160]Loss:0.0006703513208776712
[train] MAP:0.9982817869415808, MRR:0.9982817869415808
[eval] MAP:0.6882275132275132, MRR:0.6931878306878307
[epoch 63, batch 10]Loss:0.0022966130636632442
[epoch 63, batch 20]Loss:0.008963551372289658
[epoch 63, batch 30]Loss:0.028116365894675255
[epoch 63, batch 40]Loss:0.002388544147834182
[epoch 63, batch 50]Loss:0.006586299743503332
[epoch 63, batch 60]Loss:0.016635209321975708
[epoch 63, batch 70]Loss:0.0007987789576873183
[epoch 63, batch 80]Loss:0.012051532976329327
[epoch 63, batch 90]Loss:0.005827563814818859
[epoch 63, batch 100]Loss:0.010040667839348316
[epoch 63, batch 110]Loss:0.01441243290901184
[epoch 63, batch 120]Loss:0.001367952674627304
[epoch 63, batch 130]Loss:0.0006363174179568887
[epoch 63, batch 140]Loss:0.02578919008374214
[epoch 63, batch 150]Loss:0.00041169958421960473
[epoch 63, batch 160]Loss:0.17646557092666626
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6884920634920636, MRR:0.6934523809523809
[epoch 64, batch 10]Loss:0.026577414944767952
[epoch 64, batch 20]Loss:0.06616147607564926
[epoch 64, batch 30]Loss:0.00036230706609785557
[epoch 64, batch 40]Loss:0.010537013411521912
[epoch 64, batch 50]Loss:0.0016482177888974547
[epoch 64, batch 60]Loss:0.0031368304044008255
[epoch 64, batch 70]Loss:0.02512325905263424
[epoch 64, batch 80]Loss:0.0005068466998636723
[epoch 64, batch 90]Loss:0.0031434090342372656
[epoch 64, batch 100]Loss:0.012222851626574993
[epoch 64, batch 110]Loss:0.046147022396326065
[epoch 64, batch 120]Loss:0.024212606251239777
[epoch 64, batch 130]Loss:0.0023162055294960737
[epoch 64, batch 140]Loss:0.014723136089742184
[epoch 64, batch 150]Loss:0.07860737293958664
[epoch 64, batch 160]Loss:0.0003264898550696671
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6822089947089948, MRR:0.6841931216931216
[epoch 65, batch 10]Loss:0.0448552668094635
[epoch 65, batch 20]Loss:0.00700813252478838
[epoch 65, batch 30]Loss:0.041151951998472214
[epoch 65, batch 40]Loss:0.008972897194325924
[epoch 65, batch 50]Loss:0.004481915850192308
[epoch 65, batch 60]Loss:0.0035779171157628298
[epoch 65, batch 70]Loss:0.01344855222851038
[epoch 65, batch 80]Loss:0.0019152445020154119
[epoch 65, batch 90]Loss:0.03982152044773102
[epoch 65, batch 100]Loss:0.004949005786329508
[epoch 65, batch 110]Loss:0.017015179619193077
[epoch 65, batch 120]Loss:0.004976937081664801
[epoch 65, batch 130]Loss:0.018847713246941566
[epoch 65, batch 140]Loss:0.011987623758614063
[epoch 65, batch 150]Loss:0.0378933809697628
[epoch 65, batch 160]Loss:0.0015500347362831235
[train] MAP:0.9891179839633449, MRR:0.9893088965253914
[eval] MAP:0.6428602922650541, MRR:0.6484819853867472
[epoch 66, batch 10]Loss:0.0013260920532047749
[epoch 66, batch 20]Loss:0.03139951825141907
[epoch 66, batch 30]Loss:0.0005369982682168484
[epoch 66, batch 40]Loss:0.03917086124420166
[epoch 66, batch 50]Loss:0.0018084370531141758
[epoch 66, batch 60]Loss:0.0009559262543916702
[epoch 66, batch 70]Loss:0.015770157799124718
[epoch 66, batch 80]Loss:0.019719798117876053
[epoch 66, batch 90]Loss:0.001019704737700522
[epoch 66, batch 100]Loss:0.024013346061110497
[epoch 66, batch 110]Loss:0.03152065724134445
[epoch 66, batch 120]Loss:0.0009482128079980612
[epoch 66, batch 130]Loss:0.019586926326155663
[epoch 66, batch 140]Loss:0.006968911737203598
[epoch 66, batch 150]Loss:0.0009232212323695421
[epoch 66, batch 160]Loss:0.0009073987603187561
[train] MAP:0.9982817869415808, MRR:0.9982817869415808
[eval] MAP:0.6671863189720334, MRR:0.6728080120937264
[epoch 67, batch 10]Loss:0.0014031572500243783
[epoch 67, batch 20]Loss:0.006269409321248531
[epoch 67, batch 30]Loss:0.0064017255790531635
[epoch 67, batch 40]Loss:0.0004680738493334502
[epoch 67, batch 50]Loss:0.000855170248541981
[epoch 67, batch 60]Loss:0.0007374928682111204
[epoch 67, batch 70]Loss:0.0009013493545353413
[epoch 67, batch 80]Loss:0.007795714307576418
[epoch 67, batch 90]Loss:0.004322291351854801
[epoch 67, batch 100]Loss:0.00816204771399498
[epoch 67, batch 110]Loss:0.00860263966023922
[epoch 67, batch 120]Loss:0.0040374742820858955
[epoch 67, batch 130]Loss:0.021756459027528763
[epoch 67, batch 140]Loss:0.014758406206965446
[epoch 67, batch 150]Loss:0.0006926518399268389
[epoch 67, batch 160]Loss:0.0001457829785067588
[train] MAP:0.997709049255441, MRR:0.997709049255441
[eval] MAP:0.6556122448979591, MRR:0.6612339380196525
[epoch 68, batch 10]Loss:0.000245610746787861
[epoch 68, batch 20]Loss:0.021984059363603592
[epoch 68, batch 30]Loss:0.030910631641745567
[epoch 68, batch 40]Loss:0.0019375153351575136
[epoch 68, batch 50]Loss:0.04417923837900162
[epoch 68, batch 60]Loss:0.002486556302756071
[epoch 68, batch 70]Loss:0.009086748585104942
[epoch 68, batch 80]Loss:0.0018546364735811949
[epoch 68, batch 90]Loss:0.012644588015973568
[epoch 68, batch 100]Loss:0.015430217608809471
[epoch 68, batch 110]Loss:0.04891040921211243
[epoch 68, batch 120]Loss:0.004358289763331413
[epoch 68, batch 130]Loss:0.002369027119129896
[epoch 68, batch 140]Loss:0.03670942783355713
[epoch 68, batch 150]Loss:0.010778107680380344
[epoch 68, batch 160]Loss:0.00010894675506278872
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6871126228269084, MRR:0.6923374905517762
[epoch 69, batch 10]Loss:0.010885350406169891
[epoch 69, batch 20]Loss:0.0025088763795793056
[epoch 69, batch 30]Loss:0.00042365535045973957
[epoch 69, batch 40]Loss:0.0030997321009635925
[epoch 69, batch 50]Loss:0.031136296689510345
[epoch 69, batch 60]Loss:0.0038007227703928947
[epoch 69, batch 70]Loss:0.0018644146621227264
[epoch 69, batch 80]Loss:0.011491410434246063
[epoch 69, batch 90]Loss:0.16406597197055817
[epoch 69, batch 100]Loss:0.005272011272609234
[epoch 69, batch 110]Loss:0.002389230066910386
[epoch 69, batch 120]Loss:0.004128084052354097
[epoch 69, batch 130]Loss:0.00885128602385521
[epoch 69, batch 140]Loss:0.0004771486565005034
[epoch 69, batch 150]Loss:0.0002459640963934362
[epoch 69, batch 160]Loss:0.00011717380402842537
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6863189720332576, MRR:0.6915438397581254
[epoch 70, batch 10]Loss:0.0006940598832443357
[epoch 70, batch 20]Loss:0.000677776406519115
[epoch 70, batch 30]Loss:0.008713925257325172
[epoch 70, batch 40]Loss:4.507222183747217e-05
[epoch 70, batch 50]Loss:0.029935207217931747
[epoch 70, batch 60]Loss:0.046801868826150894
[epoch 70, batch 70]Loss:0.0006726724095642567
[epoch 70, batch 80]Loss:0.0028023943305015564
[epoch 70, batch 90]Loss:0.0010777234565466642
[epoch 70, batch 100]Loss:0.011072427965700626
[epoch 70, batch 110]Loss:0.003822233062237501
[epoch 70, batch 120]Loss:0.023051094263792038
[epoch 70, batch 130]Loss:0.0014530259650200605
[epoch 70, batch 140]Loss:0.010202450677752495
[epoch 70, batch 150]Loss:0.011031499132514
[epoch 70, batch 160]Loss:3.0574225093005225e-05
[train] MAP:0.9989499809087439, MRR:0.9992363497518137
[eval] MAP:0.7005291005291004, MRR:0.7057539682539682
[epoch 71, batch 10]Loss:0.0007271898211911321
[epoch 71, batch 20]Loss:0.0009887065971270204
[epoch 71, batch 30]Loss:0.001660563750192523
[epoch 71, batch 40]Loss:0.0009751693578436971
[epoch 71, batch 50]Loss:0.0009113855776377022
[epoch 71, batch 60]Loss:0.002633757423609495
[epoch 71, batch 70]Loss:0.006395482923835516
[epoch 71, batch 80]Loss:0.03348599001765251
[epoch 71, batch 90]Loss:0.0022371308878064156
[epoch 71, batch 100]Loss:0.0008032425539568067
[epoch 71, batch 110]Loss:0.005535759963095188
[epoch 71, batch 120]Loss:0.0005817320197820663
[epoch 71, batch 130]Loss:0.021175924688577652
[epoch 71, batch 140]Loss:0.0031879632733762264
[epoch 71, batch 150]Loss:0.0021197388414293528
[epoch 71, batch 160]Loss:0.529915452003479
[train] MAP:0.9991408934707904, MRR:0.9991408934707904
[eval] MAP:0.6978174603174602, MRR:0.7000661375661376
[epoch 72, batch 10]Loss:0.013921533711254597
[epoch 72, batch 20]Loss:0.0010552918538451195
[epoch 72, batch 30]Loss:0.0030348114669322968
[epoch 72, batch 40]Loss:0.00548664340749383
[epoch 72, batch 50]Loss:0.0006183803780004382
[epoch 72, batch 60]Loss:0.004331218544393778
[epoch 72, batch 70]Loss:0.0005530293565243483
[epoch 72, batch 80]Loss:0.002343275584280491
[epoch 72, batch 90]Loss:0.011254801414906979
[epoch 72, batch 100]Loss:0.01150134764611721
[epoch 72, batch 110]Loss:0.001032308442518115
[epoch 72, batch 120]Loss:0.0010385045316070318
[epoch 72, batch 130]Loss:0.0020497578661888838
[epoch 72, batch 140]Loss:0.011129569262266159
[epoch 72, batch 150]Loss:0.005881803575903177
[epoch 72, batch 160]Loss:0.010149356909096241
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6707010582010582, MRR:0.6765873015873015
[epoch 73, batch 10]Loss:0.000951172667555511
[epoch 73, batch 20]Loss:0.00015668997366447002
[epoch 73, batch 30]Loss:0.012201806530356407
[epoch 73, batch 40]Loss:0.0010979326907545328
[epoch 73, batch 50]Loss:0.017231248319149017
[epoch 73, batch 60]Loss:0.006213350221514702
[epoch 73, batch 70]Loss:0.002207578159868717
[epoch 73, batch 80]Loss:0.00788155384361744
[epoch 73, batch 90]Loss:0.01703854463994503
[epoch 73, batch 100]Loss:0.003242496633902192
[epoch 73, batch 110]Loss:0.0013409684179350734
[epoch 73, batch 120]Loss:0.005635118577629328
[epoch 73, batch 130]Loss:0.00247342512011528
[epoch 73, batch 140]Loss:0.0007689814083278179
[epoch 73, batch 150]Loss:0.0004059792263433337
[epoch 73, batch 160]Loss:0.000271521566901356
[train] MAP:0.9919498536337025, MRR:0.9923634975181367
[eval] MAP:0.663186570924666, MRR:0.6688082640463592
[epoch 74, batch 10]Loss:0.0006075338460505009
[epoch 74, batch 20]Loss:0.0031971728894859552
[epoch 74, batch 30]Loss:0.0011524427682161331
[epoch 74, batch 40]Loss:0.013371269218623638
[epoch 74, batch 50]Loss:0.0015362546546384692
[epoch 74, batch 60]Loss:0.009860270656645298
[epoch 74, batch 70]Loss:0.009289765730500221
[epoch 74, batch 80]Loss:0.000627690926194191
[epoch 74, batch 90]Loss:0.0010523350210860372
[epoch 74, batch 100]Loss:0.01896204613149166
[epoch 74, batch 110]Loss:0.0021966348867863417
[epoch 74, batch 120]Loss:0.002503045601770282
[epoch 74, batch 130]Loss:0.0006524967029690742
[epoch 74, batch 140]Loss:0.008523242548108101
[epoch 74, batch 150]Loss:0.014148853719234467
[epoch 74, batch 160]Loss:7.748591315248632e-07
[train] MAP:0.9997136311569301, MRR:1.0
[eval] MAP:0.6925264550264549, MRR:0.6947751322751322
[epoch 75, batch 10]Loss:0.06731296330690384
[epoch 75, batch 20]Loss:0.011406882666051388
[epoch 75, batch 30]Loss:0.0013791777892038226
[epoch 75, batch 40]Loss:0.0008694907301105559
[epoch 75, batch 50]Loss:0.008187445811927319
[epoch 75, batch 60]Loss:0.016376599669456482
[epoch 75, batch 70]Loss:0.0022340568248182535
[epoch 75, batch 80]Loss:0.006132031790912151
[epoch 75, batch 90]Loss:0.0030698534101247787
[epoch 75, batch 100]Loss:0.05056977644562721
[epoch 75, batch 110]Loss:0.003272042144089937
[epoch 75, batch 120]Loss:0.0004925319226458669
[epoch 75, batch 130]Loss:0.0009666068945080042
[epoch 75, batch 140]Loss:0.0026689423248171806
[epoch 75, batch 150]Loss:0.014747560024261475
[epoch 75, batch 160]Loss:0.000589468632824719
[train] MAP:0.9986317933053328, MRR:0.9988545246277205
[eval] MAP:0.6782407407407406, MRR:0.6838624338624337
[epoch 76, batch 10]Loss:0.0040332903154194355
[epoch 76, batch 20]Loss:0.0005900186952203512
[epoch 76, batch 30]Loss:0.0027862994465976954
[epoch 76, batch 40]Loss:0.0027728648856282234
[epoch 76, batch 50]Loss:0.0018932922976091504
[epoch 76, batch 60]Loss:0.0005680125905200839
[epoch 76, batch 70]Loss:0.0007824983913451433
[epoch 76, batch 80]Loss:0.0029066530987620354
[epoch 76, batch 90]Loss:0.005666461307555437
[epoch 76, batch 100]Loss:0.006901174318045378
[epoch 76, batch 110]Loss:0.0029480785597115755
[epoch 76, batch 120]Loss:0.0006726760766468942
[epoch 76, batch 130]Loss:0.0005526080494746566
[epoch 76, batch 140]Loss:0.0021156177390366793
[epoch 76, batch 150]Loss:0.018345540389418602
[epoch 76, batch 160]Loss:0.019101209938526154
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6925264550264549, MRR:0.6947751322751322
[epoch 77, batch 10]Loss:0.0035198628902435303
[epoch 77, batch 20]Loss:0.0029768210370093584
[epoch 77, batch 30]Loss:8.257219451479614e-05
[epoch 77, batch 40]Loss:0.03895700350403786
[epoch 77, batch 50]Loss:0.013473358005285263
[epoch 77, batch 60]Loss:0.04734906181693077
[epoch 77, batch 70]Loss:0.00321828736923635
[epoch 77, batch 80]Loss:0.000143476776429452
[epoch 77, batch 90]Loss:0.0017181135481223464
[epoch 77, batch 100]Loss:0.008237112313508987
[epoch 77, batch 110]Loss:0.013732176274061203
[epoch 77, batch 120]Loss:0.00105754635296762
[epoch 77, batch 130]Loss:0.004678541794419289
[epoch 77, batch 140]Loss:0.01092744991183281
[epoch 77, batch 150]Loss:0.01633242331445217
[epoch 77, batch 160]Loss:0.00032719920272938907
[train] MAP:0.9998472699503628, MRR:1.0
[eval] MAP:0.700462962962963, MRR:0.7027116402116401
[epoch 78, batch 10]Loss:0.023096218705177307
[epoch 78, batch 20]Loss:0.0029284136835485697
[epoch 78, batch 30]Loss:0.0007443409413099289
[epoch 78, batch 40]Loss:0.000537342915777117
[epoch 78, batch 50]Loss:0.0004395533469505608
[epoch 78, batch 60]Loss:0.018261875957250595
[epoch 78, batch 70]Loss:0.015106838196516037
[epoch 78, batch 80]Loss:0.01574983261525631
[epoch 78, batch 90]Loss:0.0002464441058691591
[epoch 78, batch 100]Loss:0.0010509289568290114
[epoch 78, batch 110]Loss:0.005254427902400494
[epoch 78, batch 120]Loss:0.006895300000905991
[epoch 78, batch 130]Loss:0.004227238707244396
[epoch 78, batch 140]Loss:0.017964240163564682
[epoch 78, batch 150]Loss:0.003083702176809311
[epoch 78, batch 160]Loss:1.5526085917372257e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6925264550264549, MRR:0.6947751322751322
[epoch 79, batch 10]Loss:0.0006812993087805808
[epoch 79, batch 20]Loss:0.006621477659791708
[epoch 79, batch 30]Loss:0.0019023681525141
[epoch 79, batch 40]Loss:0.004605012945830822
[epoch 79, batch 50]Loss:0.0017337274039164186
[epoch 79, batch 60]Loss:0.01986602321267128
[epoch 79, batch 70]Loss:0.004158167168498039
[epoch 79, batch 80]Loss:0.012665106914937496
[epoch 79, batch 90]Loss:0.0027895099483430386
[epoch 79, batch 100]Loss:0.004515830427408218
[epoch 79, batch 110]Loss:0.001772337593138218
[epoch 79, batch 120]Loss:0.020190086215734482
[epoch 79, batch 130]Loss:0.00100462615955621
[epoch 79, batch 140]Loss:0.008878126740455627
[epoch 79, batch 150]Loss:0.04756298288702965
[epoch 79, batch 160]Loss:0.0013111395528540015
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.690542328042328, MRR:0.6934523809523809
[epoch 80, batch 10]Loss:0.007037927396595478
[epoch 80, batch 20]Loss:0.014348233118653297
[epoch 80, batch 30]Loss:0.0022923857904970646
[epoch 80, batch 40]Loss:0.017780818045139313
[epoch 80, batch 50]Loss:0.0005901631666347384
[epoch 80, batch 60]Loss:0.0024199571926146746
[epoch 80, batch 70]Loss:0.008576944470405579
[epoch 80, batch 80]Loss:0.04320839047431946
[epoch 80, batch 90]Loss:0.004402711056172848
[epoch 80, batch 100]Loss:0.002973526017740369
[epoch 80, batch 110]Loss:0.001993129262700677
[epoch 80, batch 120]Loss:0.00011701139737851918
[epoch 80, batch 130]Loss:0.036013443022966385
[epoch 80, batch 140]Loss:0.017333609983325005
[epoch 80, batch 150]Loss:0.024162912741303444
[epoch 80, batch 160]Loss:5.878723823116161e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.7023148148148148, MRR:0.7045634920634921
[epoch 81, batch 10]Loss:0.003221668768674135
[epoch 81, batch 20]Loss:0.0075851790606975555
[epoch 81, batch 30]Loss:0.010413795709609985
[epoch 81, batch 40]Loss:0.004946990869939327
[epoch 81, batch 50]Loss:0.005516506265848875
[epoch 81, batch 60]Loss:0.006505326367914677
[epoch 81, batch 70]Loss:0.0068282391875982285
[epoch 81, batch 80]Loss:0.0011462188558652997
[epoch 81, batch 90]Loss:0.001410357654094696
[epoch 81, batch 100]Loss:0.02619047649204731
[epoch 81, batch 110]Loss:0.05798693001270294
[epoch 81, batch 120]Loss:0.008421745151281357
[epoch 81, batch 130]Loss:0.022626198828220367
[epoch 81, batch 140]Loss:0.009058271534740925
[epoch 81, batch 150]Loss:0.002266198629513383
[epoch 81, batch 160]Loss:4.738502866530325e-06
[train] MAP:0.9959335624284078, MRR:0.9959335624284078
[eval] MAP:0.691468253968254, MRR:0.6937169312169312
[epoch 82, batch 10]Loss:0.0005806210683658719
[epoch 82, batch 20]Loss:0.0011339804623275995
[epoch 82, batch 30]Loss:0.01342749036848545
[epoch 82, batch 40]Loss:0.006096473895013332
[epoch 82, batch 50]Loss:0.0016647775191813707
[epoch 82, batch 60]Loss:0.0018802887061610818
[epoch 82, batch 70]Loss:0.0017627595225349069
[epoch 82, batch 80]Loss:0.009551642462611198
[epoch 82, batch 90]Loss:0.03838596120476723
[epoch 82, batch 100]Loss:0.0022017688024789095
[epoch 82, batch 110]Loss:0.0021086190827190876
[epoch 82, batch 120]Loss:0.001805245177820325
[epoch 82, batch 130]Loss:0.00017325337103102356
[epoch 82, batch 140]Loss:0.00144577759783715
[epoch 82, batch 150]Loss:0.015147539786994457
[epoch 82, batch 160]Loss:2.4884752747311722e-06
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6960411942554798, MRR:0.6982898715041571
[epoch 83, batch 10]Loss:0.0008334415033459663
[epoch 83, batch 20]Loss:0.0002643715706653893
[epoch 83, batch 30]Loss:0.012028220109641552
[epoch 83, batch 40]Loss:0.0074663227424025536
[epoch 83, batch 50]Loss:0.004151774104684591
[epoch 83, batch 60]Loss:0.043927647173404694
[epoch 83, batch 70]Loss:0.0017806757241487503
[epoch 83, batch 80]Loss:0.016658999025821686
[epoch 83, batch 90]Loss:0.013422666117548943
[epoch 83, batch 100]Loss:0.0040390267968177795
[epoch 83, batch 110]Loss:0.019139885902404785
[epoch 83, batch 120]Loss:0.0020410388242453337
[epoch 83, batch 130]Loss:0.00036852137418463826
[epoch 83, batch 140]Loss:0.025957811623811722
[epoch 83, batch 150]Loss:0.0008871711906976998
[epoch 83, batch 160]Loss:0.00034846816561184824
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6898809523809523, MRR:0.6921296296296295
[epoch 84, batch 10]Loss:0.016707293689250946
[epoch 84, batch 20]Loss:0.0035448865965008736
[epoch 84, batch 30]Loss:0.00038364523788914084
[epoch 84, batch 40]Loss:0.0013036411255598068
[epoch 84, batch 50]Loss:0.04643050953745842
[epoch 84, batch 60]Loss:0.003149555530399084
[epoch 84, batch 70]Loss:0.0009556286968290806
[epoch 84, batch 80]Loss:0.004440438933670521
[epoch 84, batch 90]Loss:6.259129440877587e-05
[epoch 84, batch 100]Loss:0.0022724128793925047
[epoch 84, batch 110]Loss:0.030959127470850945
[epoch 84, batch 120]Loss:0.009065168909728527
[epoch 84, batch 130]Loss:0.015066463500261307
[epoch 84, batch 140]Loss:0.03402690216898918
[epoch 84, batch 150]Loss:0.0004308089555706829
[epoch 84, batch 160]Loss:2.3394682102662046e-06
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6897581254724111, MRR:0.6949829931972789
[epoch 85, batch 10]Loss:0.0016310613136738539
[epoch 85, batch 20]Loss:0.007232434116303921
[epoch 85, batch 30]Loss:0.03466800972819328
[epoch 85, batch 40]Loss:0.002651138696819544
[epoch 85, batch 50]Loss:0.00028828997164964676
[epoch 85, batch 60]Loss:0.006908886134624481
[epoch 85, batch 70]Loss:0.0025227598380297422
[epoch 85, batch 80]Loss:0.018270503729581833
[epoch 85, batch 90]Loss:0.0026425239630043507
[epoch 85, batch 100]Loss:0.005664714612066746
[epoch 85, batch 110]Loss:0.001671039150096476
[epoch 85, batch 120]Loss:0.006573091726750135
[epoch 85, batch 130]Loss:0.0005780760548077524
[epoch 85, batch 140]Loss:0.0009614366572350264
[epoch 85, batch 150]Loss:0.0011770593700930476
[epoch 85, batch 160]Loss:6.323179695755243e-05
[train] MAP:0.997709049255441, MRR:0.997709049255441
[eval] MAP:0.6618512219702695, MRR:0.6674729150919626
[epoch 86, batch 10]Loss:0.000976958079263568
[epoch 86, batch 20]Loss:0.001031095627695322
[epoch 86, batch 30]Loss:0.00684692244976759
[epoch 86, batch 40]Loss:0.0005721856141462922
[epoch 86, batch 50]Loss:0.0003168830298818648
[epoch 86, batch 60]Loss:0.00697265425696969
[epoch 86, batch 70]Loss:0.00011435610213084146
[epoch 86, batch 80]Loss:0.0005267781671136618
[epoch 86, batch 90]Loss:0.0018370008328929543
[epoch 86, batch 100]Loss:0.0008934441721066833
[epoch 86, batch 110]Loss:0.0012079664738848805
[epoch 86, batch 120]Loss:0.00023584431619383395
[epoch 86, batch 130]Loss:0.006036705337464809
[epoch 86, batch 140]Loss:0.000979286152869463
[epoch 86, batch 150]Loss:0.00114781828597188
[epoch 86, batch 160]Loss:0.006100817117840052
[train] MAP:0.9992363497518137, MRR:0.9992363497518137
[eval] MAP:0.6965608465608465, MRR:0.7017857142857142
[epoch 87, batch 10]Loss:0.002690487075597048
[epoch 87, batch 20]Loss:0.000937777862418443
[epoch 87, batch 30]Loss:0.0003542588383425027
[epoch 87, batch 40]Loss:0.0008950482588261366
[epoch 87, batch 50]Loss:0.015254511497914791
[epoch 87, batch 60]Loss:0.00023447003331966698
[epoch 87, batch 70]Loss:0.0013577616773545742
[epoch 87, batch 80]Loss:0.0005328620318323374
[epoch 87, batch 90]Loss:0.036708150058984756
[epoch 87, batch 100]Loss:0.03512614965438843
[epoch 87, batch 110]Loss:0.002259399276226759
[epoch 87, batch 120]Loss:0.0053956592455506325
[epoch 87, batch 130]Loss:0.0005436650244519114
[epoch 87, batch 140]Loss:0.0014306033262982965
[epoch 87, batch 150]Loss:0.007084925193339586
[epoch 87, batch 160]Loss:8.996413089334965e-05
[train] MAP:0.9930704355052445, MRR:0.9937577207286121
[eval] MAP:0.6881613756613756, MRR:0.6904100529100529
[epoch 88, batch 10]Loss:0.0003755640937015414
[epoch 88, batch 20]Loss:0.002531658858060837
[epoch 88, batch 30]Loss:0.003607773222029209
[epoch 88, batch 40]Loss:0.002004041103646159
[epoch 88, batch 50]Loss:0.0024607274681329727
[epoch 88, batch 60]Loss:0.0005221754545345902
[epoch 88, batch 70]Loss:0.00012558473099488765
[epoch 88, batch 80]Loss:0.0005704743671230972
[epoch 88, batch 90]Loss:0.03253526985645294
[epoch 88, batch 100]Loss:0.004929033573716879
[epoch 88, batch 110]Loss:0.01073549222201109
[epoch 88, batch 120]Loss:0.004452956840395927
[epoch 88, batch 130]Loss:0.014427090995013714
[epoch 88, batch 140]Loss:0.0005523617146536708
[epoch 88, batch 150]Loss:0.0010137984063476324
[epoch 88, batch 160]Loss:1.4274660316004883e-05
[train] MAP:0.9983015924964869, MRR:0.9982817869415808
[eval] MAP:0.681900352733686, MRR:0.6877865961199293
[epoch 89, batch 10]Loss:0.007362263277173042
[epoch 89, batch 20]Loss:0.00731431320309639
[epoch 89, batch 30]Loss:0.006736405659466982
[epoch 89, batch 40]Loss:0.004472489468753338
[epoch 89, batch 50]Loss:0.0001607581798452884
[epoch 89, batch 60]Loss:0.0003998464671894908
[epoch 89, batch 70]Loss:0.0009464806644245982
[epoch 89, batch 80]Loss:0.0001292210363317281
[epoch 89, batch 90]Loss:0.0003492955875117332
[epoch 89, batch 100]Loss:0.03457416594028473
[epoch 89, batch 110]Loss:0.03469362109899521
[epoch 89, batch 120]Loss:0.033716075122356415
[epoch 89, batch 130]Loss:0.00043470258242450655
[epoch 89, batch 140]Loss:0.006971358321607113
[epoch 89, batch 150]Loss:0.008365620858967304
[epoch 89, batch 160]Loss:0.0003653363964986056
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.685978835978836, MRR:0.6898809523809524
[epoch 90, batch 10]Loss:0.0010051901917904615
[epoch 90, batch 20]Loss:0.00464834226295352
[epoch 90, batch 30]Loss:0.007492817938327789
[epoch 90, batch 40]Loss:0.0008077428792603314
[epoch 90, batch 50]Loss:0.01709616184234619
[epoch 90, batch 60]Loss:0.0014209094224497676
[epoch 90, batch 70]Loss:0.0003741674590855837
[epoch 90, batch 80]Loss:0.01991819031536579
[epoch 90, batch 90]Loss:0.0027393274940550327
[epoch 90, batch 100]Loss:0.0003092392289545387
[epoch 90, batch 110]Loss:0.02320411056280136
[epoch 90, batch 120]Loss:0.004882713779807091
[epoch 90, batch 130]Loss:0.007353441324084997
[epoch 90, batch 140]Loss:0.0053706904873251915
[epoch 90, batch 150]Loss:0.0008433294715359807
[epoch 90, batch 160]Loss:0.01106240600347519
[train] MAP:0.999695903561883, MRR:0.9994272623138603
[eval] MAP:0.6871693121693121, MRR:0.6923941798941798
[epoch 91, batch 10]Loss:0.0005512663628906012
[epoch 91, batch 20]Loss:0.005114798434078693
[epoch 91, batch 30]Loss:0.0027758984360843897
[epoch 91, batch 40]Loss:0.0004653333453461528
[epoch 91, batch 50]Loss:5.2361203415784985e-05
[epoch 91, batch 60]Loss:0.002283108187839389
[epoch 91, batch 70]Loss:0.010468736290931702
[epoch 91, batch 80]Loss:0.0008630650117993355
[epoch 91, batch 90]Loss:0.00042377138743177056
[epoch 91, batch 100]Loss:0.015260047279298306
[epoch 91, batch 110]Loss:0.0020289819221943617
[epoch 91, batch 120]Loss:0.003020745934918523
[epoch 91, batch 130]Loss:0.012139706872403622
[epoch 91, batch 140]Loss:0.0001639162073843181
[epoch 91, batch 150]Loss:0.0011663871118798852
[epoch 91, batch 160]Loss:0.00018359713430982083
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6909391534391535, MRR:0.6931878306878307
[epoch 92, batch 10]Loss:0.00416644336655736
[epoch 92, batch 20]Loss:0.008797778747975826
[epoch 92, batch 30]Loss:6.811218190705404e-05
[epoch 92, batch 40]Loss:0.00791336689144373
[epoch 92, batch 50]Loss:0.0022709572222083807
[epoch 92, batch 60]Loss:0.004634692333638668
[epoch 92, batch 70]Loss:6.46852859063074e-05
[epoch 92, batch 80]Loss:0.004452232271432877
[epoch 92, batch 90]Loss:0.004963437095284462
[epoch 92, batch 100]Loss:0.0011291586561128497
[epoch 92, batch 110]Loss:0.020529815927147865
[epoch 92, batch 120]Loss:0.00017610678332857788
[epoch 92, batch 130]Loss:0.001298224087804556
[epoch 92, batch 140]Loss:0.00373400142416358
[epoch 92, batch 150]Loss:0.02250567451119423
[epoch 92, batch 160]Loss:3.319658208056353e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6962868480725624, MRR:0.7019085411942556
[epoch 93, batch 10]Loss:0.005782321095466614
[epoch 93, batch 20]Loss:0.0009893856476992369
[epoch 93, batch 30]Loss:9.925727499648929e-05
[epoch 93, batch 40]Loss:0.021612798795104027
[epoch 93, batch 50]Loss:0.00010809498780872673
[epoch 93, batch 60]Loss:0.002899854676797986
[epoch 93, batch 70]Loss:0.033474188297986984
[epoch 93, batch 80]Loss:0.00018754972552414984
[epoch 93, batch 90]Loss:0.0004809888487216085
[epoch 93, batch 100]Loss:0.005138052627444267
[epoch 93, batch 110]Loss:0.0013183268019929528
[epoch 93, batch 120]Loss:0.0018091511446982622
[epoch 93, batch 130]Loss:0.0003443502355366945
[epoch 93, batch 140]Loss:0.00491630332544446
[epoch 93, batch 150]Loss:0.0007261038990691304
[epoch 93, batch 160]Loss:0.0023715361021459103
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6828703703703703, MRR:0.6865079365079365
[epoch 94, batch 10]Loss:0.0006705223931930959
[epoch 94, batch 20]Loss:0.007012632209807634
[epoch 94, batch 30]Loss:0.002184769371524453
[epoch 94, batch 40]Loss:0.00041276507545262575
[epoch 94, batch 50]Loss:0.0008727700915187597
[epoch 94, batch 60]Loss:0.06547629833221436
[epoch 94, batch 70]Loss:0.0026396538596600294
[epoch 94, batch 80]Loss:0.0045274789445102215
[epoch 94, batch 90]Loss:0.0010371636599302292
[epoch 94, batch 100]Loss:2.2988979253568687e-05
[epoch 94, batch 110]Loss:0.0022261724807322025
[epoch 94, batch 120]Loss:0.006255231332033873
[epoch 94, batch 130]Loss:0.00327998585999012
[epoch 94, batch 140]Loss:0.0034097323659807444
[epoch 94, batch 150]Loss:0.00010115418263012543
[epoch 94, batch 160]Loss:7.323323370655999e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6882936507936508, MRR:0.690542328042328
[epoch 95, batch 10]Loss:0.00021201773779466748
[epoch 95, batch 20]Loss:0.0004177586524747312
[epoch 95, batch 30]Loss:0.027257397770881653
[epoch 95, batch 40]Loss:0.006931481882929802
[epoch 95, batch 50]Loss:0.0009147441014647484
[epoch 95, batch 60]Loss:0.03990925848484039
[epoch 95, batch 70]Loss:0.0064984653145074844
[epoch 95, batch 80]Loss:0.030787715688347816
[epoch 95, batch 90]Loss:0.00045686529483646154
[epoch 95, batch 100]Loss:0.001995262922719121
[epoch 95, batch 110]Loss:0.022599391639232635
[epoch 95, batch 120]Loss:0.0016209379537031054
[epoch 95, batch 130]Loss:0.024663271382451057
[epoch 95, batch 140]Loss:0.0053043607622385025
[epoch 95, batch 150]Loss:0.0003188061818946153
[epoch 95, batch 160]Loss:0.0
[train] MAP:0.9994749904543718, MRR:1.0
[eval] MAP:0.6921296296296295, MRR:0.6943783068783068
[epoch 96, batch 10]Loss:0.0009166097734123468
[epoch 96, batch 20]Loss:0.0144835589453578
[epoch 96, batch 30]Loss:0.0009089554660022259
[epoch 96, batch 40]Loss:0.017820872366428375
[epoch 96, batch 50]Loss:0.05547455698251724
[epoch 96, batch 60]Loss:0.008087905123829842
[epoch 96, batch 70]Loss:0.0028449594974517822
[epoch 96, batch 80]Loss:0.001884653465822339
[epoch 96, batch 90]Loss:0.030610626563429832
[epoch 96, batch 100]Loss:0.023167958483099937
[epoch 96, batch 110]Loss:0.018367145210504532
[epoch 96, batch 120]Loss:0.00021632970310747623
[epoch 96, batch 130]Loss:0.006453628186136484
[epoch 96, batch 140]Loss:0.0003529052482917905
[epoch 96, batch 150]Loss:0.035281162708997726
[epoch 96, batch 160]Loss:6.457038398366421e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6924603174603176, MRR:0.6963624338624338
[epoch 97, batch 10]Loss:0.004438897594809532
[epoch 97, batch 20]Loss:0.004864346701651812
[epoch 97, batch 30]Loss:0.0021192231215536594
[epoch 97, batch 40]Loss:0.0071088639087975025
[epoch 97, batch 50]Loss:6.718334770994261e-05
[epoch 97, batch 60]Loss:0.006387141067534685
[epoch 97, batch 70]Loss:0.036427710205316544
[epoch 97, batch 80]Loss:0.01729315146803856
[epoch 97, batch 90]Loss:0.00047452456783503294
[epoch 97, batch 100]Loss:0.006477131973952055/home/xh2018/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters

[epoch 97, batch 110]Loss:0.001898240647278726
[epoch 97, batch 120]Loss:0.0007382099865935743
[epoch 97, batch 130]Loss:0.004737373441457748
[epoch 97, batch 140]Loss:0.005526096094399691
[epoch 97, batch 150]Loss:0.046609096229076385
[epoch 97, batch 160]Loss:2.059249163721688e-05
[train] MAP:0.9936044291714395, MRR:0.9935089728904163
[eval] MAP:0.6575963718820861, MRR:0.6632180650037793
[epoch 98, batch 10]Loss:3.1054871215019375e-05
[epoch 98, batch 20]Loss:0.0006707878783345222
[epoch 98, batch 30]Loss:0.020390644669532776
[epoch 98, batch 40]Loss:0.002858339808881283
[epoch 98, batch 50]Loss:6.547868542838842e-05
[epoch 98, batch 60]Loss:0.0002520617563277483
[epoch 98, batch 70]Loss:0.010407832451164722
[epoch 98, batch 80]Loss:0.0012251848820596933
[epoch 98, batch 90]Loss:0.013820817694067955
[epoch 98, batch 100]Loss:0.0054896981455385685
[epoch 98, batch 110]Loss:0.020632004365324974
[epoch 98, batch 120]Loss:0.0004307842464186251
[epoch 98, batch 130]Loss:0.0055621895007789135
[epoch 98, batch 140]Loss:0.0003778732498176396
[epoch 98, batch 150]Loss:0.0014289168175309896
[epoch 98, batch 160]Loss:9.83474706117704e-07
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6912037037037038, MRR:0.6934523809523809
[epoch 99, batch 10]Loss:0.02467728778719902
[epoch 99, batch 20]Loss:4.794983033207245e-05
[epoch 99, batch 30]Loss:0.00016806893108878285
[epoch 99, batch 40]Loss:0.0006460677832365036
[epoch 99, batch 50]Loss:0.0032886676490306854
[epoch 99, batch 60]Loss:0.0017516775988042355
[epoch 99, batch 70]Loss:0.00017613635282032192
[epoch 99, batch 80]Loss:0.0005311269778758287
[epoch 99, batch 90]Loss:0.00040477607399225235
[epoch 99, batch 100]Loss:0.0012249026913195848
[epoch 99, batch 110]Loss:0.0024490016512572765
[epoch 99, batch 120]Loss:0.00038487400161102414
[epoch 99, batch 130]Loss:0.00018070661462843418
[epoch 99, batch 140]Loss:0.0051254164427518845
[epoch 99, batch 150]Loss:0.0020345733501017094
[epoch 99, batch 160]Loss:1.186112240247894e-05
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6976946334089191, MRR:0.7035808767951625
total time:   7478.825808286667
