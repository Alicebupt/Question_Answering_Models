2018-12-04 09:17:29.972749: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
/home/xh2018/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
300
Pre-trained: 26838 (92.18%)
Traceback (most recent call last):
  File "seq_match_seq_py3.py", line 181, in <module>
    main(args)
  File "seq_match_seq_py3.py", line 161, in main
    train(deepcopy(train_corpus), config, val_corpus, deepcopy(train_corpus))
  File "seq_match_seq_py3.py", line 57, in train
    model = SeqMatchSeq(config)
  File "/home/xh2018/workspace/Question_Answering_Models/cQA/seq_match_seq/models.py", line 20, in __init__
    t = self.compare(a_encode, h_a)
  File "/home/xh2018/workspace/Question_Answering_Models/cQA/seq_match_seq/models.py", line 122, in compare
    self.config.comp_type))
ValueError: ntn method is not implemented!
2018-12-04 09:34:35.030146: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
300
Pre-trained: 26838 (92.18%)
(?, 100, 128)
[epoch 0, batch 10]Loss:0.2803416848182678
[epoch 0, batch 20]Loss:0.14214231073856354
[epoch 0, batch 30]Loss:0.21694239974021912
[epoch 0, batch 40]Loss:0.2430032342672348
[epoch 0, batch 50]Loss:0.13204136490821838
[epoch 0, batch 60]Loss:0.21072955429553986
[epoch 0, batch 70]Loss:0.14338938891887665
[epoch 0, batch 80]Loss:0.21492858231067657
[epoch 0, batch 90]Loss:0.27947187423706055
[epoch 0, batch 100]Loss:0.20882700383663177
[epoch 0, batch 110]Loss:0.26021891832351685
[epoch 0, batch 120]Loss:0.2578924894332886
[epoch 0, batch 130]Loss:0.1876997947692871
[epoch 0, batch 140]Loss:0.15190613269805908
[epoch 0, batch 150]Loss:0.16554443538188934
[epoch 0, batch 160]Loss:0.058404143899679184
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 1, batch 10]Loss:0.1953173726797104
[epoch 1, batch 20]Loss:0.20432250201702118
[epoch 1, batch 30]Loss:0.22547347843647003
[epoch 1, batch 40]Loss:0.15432286262512207
[epoch 1, batch 50]Loss:0.14927855134010315
[epoch 1, batch 60]Loss:0.1560368537902832
[epoch 1, batch 70]Loss:0.18551507592201233
[epoch 1, batch 80]Loss:0.11610561609268188
[epoch 1, batch 90]Loss:0.12382428348064423
[epoch 1, batch 100]Loss:0.17848491668701172
[epoch 1, batch 110]Loss:0.21848715841770172
[epoch 1, batch 120]Loss:0.08758726716041565
[epoch 1, batch 130]Loss:0.2537277936935425
[epoch 1, batch 140]Loss:0.22487416863441467
[epoch 1, batch 150]Loss:0.17982344329357147
[epoch 1, batch 160]Loss:0.053085144609212875
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 2, batch 10]Loss:0.16230186820030212
[epoch 2, batch 20]Loss:0.21328812837600708
[epoch 2, batch 30]Loss:0.1909063160419464
[epoch 2, batch 40]Loss:0.09770132601261139
[epoch 2, batch 50]Loss:0.13461658358573914
[epoch 2, batch 60]Loss:0.14781466126441956
[epoch 2, batch 70]Loss:0.19084303081035614
[epoch 2, batch 80]Loss:0.12416306883096695
[epoch 2, batch 90]Loss:0.18102094531059265
[epoch 2, batch 100]Loss:0.12532277405261993
[epoch 2, batch 110]Loss:0.19349968433380127
[epoch 2, batch 120]Loss:0.22871136665344238
[epoch 2, batch 130]Loss:0.2680896818637848
[epoch 2, batch 140]Loss:0.30458685755729675
[epoch 2, batch 150]Loss:0.2182292640209198
[epoch 2, batch 160]Loss:0.28482264280319214
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 3, batch 10]Loss:0.2083130031824112
[epoch 3, batch 20]Loss:0.14086243510246277
[epoch 3, batch 30]Loss:0.17015284299850464
[epoch 3, batch 40]Loss:0.14049318432807922
[epoch 3, batch 50]Loss:0.10224239528179169
[epoch 3, batch 60]Loss:0.16060541570186615
[epoch 3, batch 70]Loss:0.14220628142356873
[epoch 3, batch 80]Loss:0.1211397647857666
[epoch 3, batch 90]Loss:0.051499828696250916
[epoch 3, batch 100]Loss:0.15623490512371063
[epoch 3, batch 110]Loss:0.22142446041107178
[epoch 3, batch 120]Loss:0.1346316784620285
[epoch 3, batch 130]Loss:0.09392768144607544
[epoch 3, batch 140]Loss:0.186197891831398
[epoch 3, batch 150]Loss:0.13661175966262817
[epoch 3, batch 160]Loss:0.43992865085601807
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 4, batch 10]Loss:0.11663281172513962
[epoch 4, batch 20]Loss:0.14104390144348145
[epoch 4, batch 30]Loss:0.10965755581855774
[epoch 4, batch 40]Loss:0.22992022335529327
[epoch 4, batch 50]Loss:0.1675567328929901
[epoch 4, batch 60]Loss:0.13909900188446045
[epoch 4, batch 70]Loss:0.21334308385849
[epoch 4, batch 80]Loss:0.2971808910369873
[epoch 4, batch 90]Loss:0.1087116152048111
[epoch 4, batch 100]Loss:0.12058687955141068
[epoch 4, batch 110]Loss:0.184067040681839
[epoch 4, batch 120]Loss:0.16887925565242767
[epoch 4, batch 130]Loss:0.17162977159023285
[epoch 4, batch 140]Loss:0.16893370449543
[epoch 4, batch 150]Loss:0.12238355726003647
[epoch 4, batch 160]Loss:0.050523895770311356
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 5, batch 10]Loss:0.201031893491745
[epoch 5, batch 20]Loss:0.12110859900712967
[epoch 5, batch 30]Loss:0.13685891032218933
[epoch 5, batch 40]Loss:0.15538787841796875
[epoch 5, batch 50]Loss:0.1600896418094635
[epoch 5, batch 60]Loss:0.24555692076683044
[epoch 5, batch 70]Loss:0.15274643898010254
[epoch 5, batch 80]Loss:0.14043855667114258
[epoch 5, batch 90]Loss:0.11867163330316544
[epoch 5, batch 100]Loss:0.1961963176727295
[epoch 5, batch 110]Loss:0.1853509396314621
[epoch 5, batch 120]Loss:0.17681267857551575
[epoch 5, batch 130]Loss:0.13528473675251007
[epoch 5, batch 140]Loss:0.2339594066143036
[epoch 5, batch 150]Loss:0.12703168392181396
[epoch 5, batch 160]Loss:0.09642229974269867
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 6, batch 10]Loss:0.11613453924655914
[epoch 6, batch 20]Loss:0.14584757387638092
[epoch 6, batch 30]Loss:0.26869404315948486
[epoch 6, batch 40]Loss:0.10411635041236877
[epoch 6, batch 50]Loss:0.18414676189422607
[epoch 6, batch 60]Loss:0.1850930154323578
[epoch 6, batch 70]Loss:0.10374778509140015
[epoch 6, batch 80]Loss:0.18961918354034424
[epoch 6, batch 90]Loss:0.1608455777168274
[epoch 6, batch 100]Loss:0.15058429539203644
[epoch 6, batch 110]Loss:0.07947539538145065
[epoch 6, batch 120]Loss:0.11416229605674744
[epoch 6, batch 130]Loss:0.09359455108642578
[epoch 6, batch 140]Loss:0.14425191283226013
[epoch 6, batch 150]Loss:0.12383739650249481
[epoch 6, batch 160]Loss:0.020050108432769775
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 7, batch 10]Loss:0.12445932626724243
[epoch 7, batch 20]Loss:0.1729397177696228
[epoch 7, batch 30]Loss:0.18328529596328735
[epoch 7, batch 40]Loss:0.21339216828346252
[epoch 7, batch 50]Loss:0.26347634196281433
[epoch 7, batch 60]Loss:0.16632592678070068
[epoch 7, batch 70]Loss:0.22906102240085602
[epoch 7, batch 80]Loss:0.2113734483718872
[epoch 7, batch 90]Loss:0.1261512041091919
[epoch 7, batch 100]Loss:0.2042565643787384
[epoch 7, batch 110]Loss:0.181064635515213
[epoch 7, batch 120]Loss:0.09455011785030365
[epoch 7, batch 130]Loss:0.2619962692260742
[epoch 7, batch 140]Loss:0.2747921943664551
[epoch 7, batch 150]Loss:0.16303467750549316
[epoch 7, batch 160]Loss:0.4297046661376953
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 8, batch 10]Loss:0.22284819185733795
[epoch 8, batch 20]Loss:0.1330879181623459
[epoch 8, batch 30]Loss:0.14767636358737946
[epoch 8, batch 40]Loss:0.2558535933494568
[epoch 8, batch 50]Loss:0.08702141791582108
[epoch 8, batch 60]Loss:0.10914313793182373
[epoch 8, batch 70]Loss:0.15539410710334778
[epoch 8, batch 80]Loss:0.15961004793643951
[epoch 8, batch 90]Loss:0.07851618528366089
[epoch 8, batch 100]Loss:0.0973067656159401
[epoch 8, batch 110]Loss:0.1607244908809662
[epoch 8, batch 120]Loss:0.11230608820915222
[epoch 8, batch 130]Loss:0.13970249891281128
[epoch 8, batch 140]Loss:0.2240827977657318
[epoch 8, batch 150]Loss:0.19447985291481018
[epoch 8, batch 160]Loss:0.04834680259227753
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 9, batch 10]Loss:0.21070221066474915
[epoch 9, batch 20]Loss:0.12397825717926025
[epoch 9, batch 30]Loss:0.1672368049621582
[epoch 9, batch 40]Loss:0.20009249448776245
[epoch 9, batch 50]Loss:0.17440536618232727
[epoch 9, batch 60]Loss:0.18173395097255707
[epoch 9, batch 70]Loss:0.15786287188529968
[epoch 9, batch 80]Loss:0.060462258756160736
[epoch 9, batch 90]Loss:0.2228069305419922
[epoch 9, batch 100]Loss:0.13397109508514404
[epoch 9, batch 110]Loss:0.12656265497207642
[epoch 9, batch 120]Loss:0.21275390684604645
[epoch 9, batch 130]Loss:0.15252432227134705
[epoch 9, batch 140]Loss:0.12553025782108307
[epoch 9, batch 150]Loss:0.2139536738395691
[epoch 9, batch 160]Loss:0.018308112397789955
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 10, batch 10]Loss:0.12680736184120178
[epoch 10, batch 20]Loss:0.09712673723697662
[epoch 10, batch 30]Loss:0.17015483975410461
[epoch 10, batch 40]Loss:0.16310331225395203
[epoch 10, batch 50]Loss:0.11417355388402939
[epoch 10, batch 60]Loss:0.06793879717588425
[epoch 10, batch 70]Loss:0.10337784886360168
[epoch 10, batch 80]Loss:0.1813613772392273
[epoch 10, batch 90]Loss:0.2335071563720703
[epoch 10, batch 100]Loss:0.17907695472240448
[epoch 10, batch 110]Loss:0.14660733938217163
[epoch 10, batch 120]Loss:0.2130013406276703
[epoch 10, batch 130]Loss:0.19614830613136292
[epoch 10, batch 140]Loss:0.14108061790466309
[epoch 10, batch 150]Loss:0.12034531682729721
[epoch 10, batch 160]Loss:0.033505912870168686
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 11, batch 10]Loss:0.16256751120090485
[epoch 11, batch 20]Loss:0.1312328577041626
[epoch 11, batch 30]Loss:0.12394462525844574
[epoch 11, batch 40]Loss:0.17286939918994904
[epoch 11, batch 50]Loss:0.14884161949157715
[epoch 11, batch 60]Loss:0.19885878264904022
[epoch 11, batch 70]Loss:0.14392651617527008
[epoch 11, batch 80]Loss:0.09208013117313385
[epoch 11, batch 90]Loss:0.14869624376296997
[epoch 11, batch 100]Loss:0.11769725382328033
[epoch 11, batch 110]Loss:0.10269641876220703
[epoch 11, batch 120]Loss:0.11452831327915192
[epoch 11, batch 130]Loss:0.15766239166259766
[epoch 11, batch 140]Loss:0.10973425209522247
[epoch 11, batch 150]Loss:0.16809247434139252
[epoch 11, batch 160]Loss:0.11599301546812057
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 12, batch 10]Loss:0.1494552195072174
[epoch 12, batch 20]Loss:0.14400747418403625
[epoch 12, batch 30]Loss:0.08614926785230637
[epoch 12, batch 40]Loss:0.0993550643324852
[epoch 12, batch 50]Loss:0.09762755036354065
[epoch 12, batch 60]Loss:0.11707019805908203
[epoch 12, batch 70]Loss:0.09678830206394196
[epoch 12, batch 80]Loss:0.11464685201644897
[epoch 12, batch 90]Loss:0.09561964124441147
[epoch 12, batch 100]Loss:0.13923299312591553
[epoch 12, batch 110]Loss:0.21513819694519043
[epoch 12, batch 120]Loss:0.16589894890785217
[epoch 12, batch 130]Loss:0.10761353373527527
[epoch 12, batch 140]Loss:0.11092909425497055
[epoch 12, batch 150]Loss:0.12184177339076996
[epoch 12, batch 160]Loss:0.22925502061843872
[train] MAP:0.630886240920089, MRR:0.6354752310085415
[eval] MAP:0.6804610733182161, MRR:0.6856859410430839
[epoch 13, batch 10]Loss:0.18824131786823273
[epoch 13, batch 20]Loss:0.09071840345859528
[epoch 13, batch 30]Loss:0.1338343620300293
[epoch 13, batch 40]Loss:0.17624813318252563
[epoch 13, batch 50]Loss:0.11235696077346802
[epoch 13, batch 60]Loss:0.17418509721755981
[epoch 13, batch 70]Loss:0.1270093023777008
[epoch 13, batch 80]Loss:0.2532792389392853
[epoch 13, batch 90]Loss:0.1712242215871811
[epoch 13, batch 100]Loss:0.1668378710746765
[epoch 13, batch 110]Loss:0.12051260471343994
[epoch 13, batch 120]Loss:0.1619243621826172
[epoch 13, batch 130]Loss:0.21098151803016663
[epoch 13, batch 140]Loss:0.13827954232692719
[epoch 13, batch 150]Loss:0.17618723213672638
[epoch 13, batch 160]Loss:0.03128278627991676
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 14, batch 10]Loss:0.16822612285614014
[epoch 14, batch 20]Loss:0.11667027324438095
[epoch 14, batch 30]Loss:0.12458034604787827
[epoch 14, batch 40]Loss:0.14318406581878662
[epoch 14, batch 50]Loss:0.21473507583141327
[epoch 14, batch 60]Loss:0.18572476506233215
[epoch 14, batch 70]Loss:0.09527663886547089
[epoch 14, batch 80]Loss:0.22058135271072388
[epoch 14, batch 90]Loss:0.1837773472070694
[epoch 14, batch 100]Loss:0.12430757284164429
[epoch 14, batch 110]Loss:0.08772821724414825
[epoch 14, batch 120]Loss:0.09758737683296204
[epoch 14, batch 130]Loss:0.12272103130817413
[epoch 14, batch 140]Loss:0.12200887501239777
[epoch 14, batch 150]Loss:0.1944124698638916
[epoch 14, batch 160]Loss:0.18426474928855896
[train] MAP:0.6307001928868607, MRR:0.6370083337494471
[eval] MAP:0.686885865457294, MRR:0.6891345427059712
[epoch 15, batch 10]Loss:0.12802794575691223
[epoch 15, batch 20]Loss:0.14115461707115173
[epoch 15, batch 30]Loss:0.09732571244239807
[epoch 15, batch 40]Loss:0.12002400308847427
[epoch 15, batch 50]Loss:0.084282785654068
[epoch 15, batch 60]Loss:0.1619071066379547
[epoch 15, batch 70]Loss:0.1655675768852234
[epoch 15, batch 80]Loss:0.1308324933052063
[epoch 15, batch 90]Loss:0.15396159887313843
[epoch 15, batch 100]Loss:0.05703161656856537
[epoch 15, batch 110]Loss:0.17476047575473785
[epoch 15, batch 120]Loss:0.15028174221515656
[epoch 15, batch 130]Loss:0.10837391763925552
[epoch 15, batch 140]Loss:0.11984680593013763
[epoch 15, batch 150]Loss:0.1769711971282959
[epoch 15, batch 160]Loss:0.126041442155838
[train] MAP:0.6665652517084736, MRR:0.6737474108235757
[eval] MAP:0.7055303602922651, MRR:0.710755228017133
[epoch 16, batch 10]Loss:0.17452555894851685
[epoch 16, batch 20]Loss:0.1420021653175354
[epoch 16, batch 30]Loss:0.12306047230958939
[epoch 16, batch 40]Loss:0.0841934084892273
[epoch 16, batch 50]Loss:0.11616647988557816
[epoch 16, batch 60]Loss:0.15432651340961456
[epoch 16, batch 70]Loss:0.10737055540084839
[epoch 16, batch 80]Loss:0.14555448293685913
[epoch 16, batch 90]Loss:0.15823763608932495
[epoch 16, batch 100]Loss:0.11944420635700226
[epoch 16, batch 110]Loss:0.19724413752555847
[epoch 16, batch 120]Loss:0.1243341714143753
[epoch 16, batch 130]Loss:0.11345794796943665
[epoch 16, batch 140]Loss:0.170022115111351
[epoch 16, batch 150]Loss:0.16459886729717255
[epoch 16, batch 160]Loss:0.022073736414313316
[train] MAP:0.6393206208791785, MRR:0.6455833693383295
[eval] MAP:0.686885865457294, MRR:0.6891345427059712
[epoch 17, batch 10]Loss:0.14167490601539612
[epoch 17, batch 20]Loss:0.10460884869098663
[epoch 17, batch 30]Loss:0.06727992743253708
[epoch 17, batch 40]Loss:0.06873972713947296
[epoch 17, batch 50]Loss:0.14249642193317413
[epoch 17, batch 60]Loss:0.15395554900169373
[epoch 17, batch 70]Loss:0.10110707581043243
[epoch 17, batch 80]Loss:0.1772197186946869
[epoch 17, batch 90]Loss:0.22195366024971008
[epoch 17, batch 100]Loss:0.18553534150123596
[epoch 17, batch 110]Loss:0.12768122553825378
[epoch 17, batch 120]Loss:0.21167883276939392
[epoch 17, batch 130]Loss:0.09135167300701141
[epoch 17, batch 140]Loss:0.13740622997283936
[epoch 17, batch 150]Loss:0.17794781923294067
[epoch 17, batch 160]Loss:0.0686635747551918
[train] MAP:0.6416666700281242, MRR:0.6487159262939106
[eval] MAP:0.6815948601662887, MRR:0.6838435374149661
[epoch 18, batch 10]Loss:0.16910947859287262
[epoch 18, batch 20]Loss:0.1314249485731125
[epoch 18, batch 30]Loss:0.0911499559879303
[epoch 18, batch 40]Loss:0.14784090220928192
[epoch 18, batch 50]Loss:0.15862831473350525
[epoch 18, batch 60]Loss:0.14613953232765198
[epoch 18, batch 70]Loss:0.11195602267980576
[epoch 18, batch 80]Loss:0.1346910297870636
[epoch 18, batch 90]Loss:0.13074633479118347
[epoch 18, batch 100]Loss:0.14178158342838287
[epoch 18, batch 110]Loss:0.13128411769866943
[epoch 18, batch 120]Loss:0.1415332406759262
[epoch 18, batch 130]Loss:0.08914855122566223
[epoch 18, batch 140]Loss:0.16633504629135132
[epoch 18, batch 150]Loss:0.10766486823558807
[epoch 18, batch 160]Loss:0.01267891377210617
[train] MAP:0.6586696752521051, MRR:0.6663890952178375
[eval] MAP:0.6827758881330309, MRR:0.6850245653817083
[epoch 19, batch 10]Loss:0.09203402698040009
[epoch 19, batch 20]Loss:0.1489155888557434
[epoch 19, batch 30]Loss:0.1000179871916771
[epoch 19, batch 40]Loss:0.12853102385997772
[epoch 19, batch 50]Loss:0.177891343832016
[epoch 19, batch 60]Loss:0.12430042028427124
[epoch 19, batch 70]Loss:0.17251349985599518
[epoch 19, batch 80]Loss:0.05771372467279434
[epoch 19, batch 90]Loss:0.15441930294036865
[epoch 19, batch 100]Loss:0.14051088690757751
[epoch 19, batch 110]Loss:0.15753977000713348
[epoch 19, batch 120]Loss:0.18693771958351135
[epoch 19, batch 130]Loss:0.12749552726745605
[epoch 19, batch 140]Loss:0.14216698706150055
[epoch 19, batch 150]Loss:0.1466536819934845
[epoch 19, batch 160]Loss:0.05976139008998871
[train] MAP:0.7082440195863976, MRR:0.7191633064972037
[eval] MAP:0.6668272864701436, MRR:0.6707294028722601
[epoch 20, batch 10]Loss:0.08653727173805237
[epoch 20, batch 20]Loss:0.14080055058002472
[epoch 20, batch 30]Loss:0.1379292756319046
[epoch 20, batch 40]Loss:0.05539095774292946
[epoch 20, batch 50]Loss:0.10580430179834366
[epoch 20, batch 60]Loss:0.09964592754840851
[epoch 20, batch 70]Loss:0.10269046574831009
[epoch 20, batch 80]Loss:0.1406620442867279
[epoch 20, batch 90]Loss:0.1442587673664093
[epoch 20, batch 100]Loss:0.22953778505325317
[epoch 20, batch 110]Loss:0.1802346408367157
[epoch 20, batch 120]Loss:0.07011528313159943
[epoch 20, batch 130]Loss:0.10892955958843231
[epoch 20, batch 140]Loss:0.1020616814494133
[epoch 20, batch 150]Loss:0.1645660400390625
[epoch 20, batch 160]Loss:0.16424407064914703
[train] MAP:0.7285664361287457, MRR:0.7379859087390501
[eval] MAP:0.7021164021164021, MRR:0.7073412698412699
[epoch 21, batch 10]Loss:0.11436732858419418
[epoch 21, batch 20]Loss:0.12249555438756943
[epoch 21, batch 30]Loss:0.19027797877788544
[epoch 21, batch 40]Loss:0.16300560534000397
[epoch 21, batch 50]Loss:0.05712014436721802
[epoch 21, batch 60]Loss:0.10121612995862961
[epoch 21, batch 70]Loss:0.12127785384654999
[epoch 21, batch 80]Loss:0.1486412137746811
[epoch 21, batch 90]Loss:0.1921936571598053
[epoch 21, batch 100]Loss:0.12079878151416779
[epoch 21, batch 110]Loss:0.1417108178138733
[epoch 21, batch 120]Loss:0.11484245955944061
[epoch 21, batch 130]Loss:0.09817561507225037
[epoch 21, batch 140]Loss:0.1769283264875412
[epoch 21, batch 150]Loss:0.0793725848197937
[epoch 21, batch 160]Loss:0.09461972117424011
[train] MAP:0.7010673188529959, MRR:0.7098421866090734
[eval] MAP:0.6817838246409674, MRR:0.6840325018896448
[epoch 22, batch 10]Loss:0.056559741497039795
[epoch 22, batch 20]Loss:0.06821779906749725
[epoch 22, batch 30]Loss:0.15955618023872375
[epoch 22, batch 40]Loss:0.09969347715377808
[epoch 22, batch 50]Loss:0.09197437763214111
[epoch 22, batch 60]Loss:0.11272405087947845
[epoch 22, batch 70]Loss:0.13684256374835968
[epoch 22, batch 80]Loss:0.1398952305316925
[epoch 22, batch 90]Loss:0.08839154988527298
[epoch 22, batch 100]Loss:0.06688319146633148
[epoch 22, batch 110]Loss:0.1280846893787384
[epoch 22, batch 120]Loss:0.06701965630054474
[epoch 22, batch 130]Loss:0.08617420494556427
[epoch 22, batch 140]Loss:0.07210758328437805
[epoch 22, batch 150]Loss:0.09350608289241791
[epoch 22, batch 160]Loss:0.039597027003765106
[train] MAP:0.7498701502028736, MRR:0.758864271498856
[eval] MAP:0.6780045351473923, MRR:0.6802532123960696
[epoch 23, batch 10]Loss:0.10759498924016953
[epoch 23, batch 20]Loss:0.25197097659111023
[epoch 23, batch 30]Loss:0.1473379135131836
[epoch 23, batch 40]Loss:0.08768792450428009
[epoch 23, batch 50]Loss:0.16407153010368347
[epoch 23, batch 60]Loss:0.12236678600311279
[epoch 23, batch 70]Loss:0.10156466066837311
[epoch 23, batch 80]Loss:0.1739688515663147
[epoch 23, batch 90]Loss:0.12935155630111694
[epoch 23, batch 100]Loss:0.06936191022396088
[epoch 23, batch 110]Loss:0.045502789318561554
[epoch 23, batch 120]Loss:0.0618300661444664
[epoch 23, batch 130]Loss:0.07211528718471527
[epoch 23, batch 140]Loss:0.0810006782412529
[epoch 23, batch 150]Loss:0.20005324482917786
[epoch 23, batch 160]Loss:0.009031878784298897
[train] MAP:0.7814944188444064, MRR:0.7906942383374138
[eval] MAP:0.6846182917611489, MRR:0.6898431594860167
[epoch 24, batch 10]Loss:0.05116139352321625
[epoch 24, batch 20]Loss:0.10869187116622925
[epoch 24, batch 30]Loss:0.09473735094070435
[epoch 24, batch 40]Loss:0.10650284588336945
[epoch 24, batch 50]Loss:0.11079049110412598
[epoch 24, batch 60]Loss:0.17932677268981934
[epoch 24, batch 70]Loss:0.10904626548290253
[epoch 24, batch 80]Loss:0.11421549320220947
[epoch 24, batch 90]Loss:0.05375203490257263
[epoch 24, batch 100]Loss:0.13730067014694214
[epoch 24, batch 110]Loss:0.11820477992296219
[epoch 24, batch 120]Loss:0.12598195672035217
[epoch 24, batch 130]Loss:0.03705897927284241
[epoch 24, batch 140]Loss:0.06330212950706482
[epoch 24, batch 150]Loss:0.08928345143795013
[epoch 24, batch 160]Loss:0.08707987517118454
[train] MAP:0.8261262999254428, MRR:0.8328055697958242
[eval] MAP:0.68260582010582, MRR:0.6878306878306879
[epoch 25, batch 10]Loss:0.17167076468467712
[epoch 25, batch 20]Loss:0.1345272958278656
[epoch 25, batch 30]Loss:0.1829117238521576
[epoch 25, batch 40]Loss:0.06575518101453781
[epoch 25, batch 50]Loss:0.08138561248779297
[epoch 25, batch 60]Loss:0.15562735497951508
[epoch 25, batch 70]Loss:0.16887567937374115
[epoch 25, batch 80]Loss:0.06852201372385025
[epoch 25, batch 90]Loss:0.1271718144416809
[epoch 25, batch 100]Loss:0.12632763385772705
[epoch 25, batch 110]Loss:0.15622448921203613
[epoch 25, batch 120]Loss:0.08762325346469879
[epoch 25, batch 130]Loss:0.15282762050628662
[epoch 25, batch 140]Loss:0.16769632697105408
[epoch 25, batch 150]Loss:0.14241757988929749
[epoch 25, batch 160]Loss:0.4134454131126404
[train] MAP:0.8678649187409336, MRR:0.8746896997484807
[eval] MAP:0.6737906273620559, MRR:0.6776927437641722
[epoch 26, batch 10]Loss:0.12465613335371017
[epoch 26, batch 20]Loss:0.1213371679186821
[epoch 26, batch 30]Loss:0.09309716522693634
[epoch 26, batch 40]Loss:0.14081688225269318
[epoch 26, batch 50]Loss:0.1183914914727211
[epoch 26, batch 60]Loss:0.15740415453910828
[epoch 26, batch 70]Loss:0.11299002170562744
[epoch 26, batch 80]Loss:0.08252576738595963
[epoch 26, batch 90]Loss:0.07570327073335648
[epoch 26, batch 100]Loss:0.07281647622585297
[epoch 26, batch 110]Loss:0.1417207419872284
[epoch 26, batch 120]Loss:0.14063794910907745
[epoch 26, batch 130]Loss:0.07559922337532043
[epoch 26, batch 140]Loss:0.10721158981323242
[epoch 26, batch 150]Loss:0.18122318387031555
[epoch 26, batch 160]Loss:0.06806003302335739
[train] MAP:0.8166055896315368, MRR:0.8233575880969836
[eval] MAP:0.6904006046863189, MRR:0.6956254724111867
[epoch 27, batch 10]Loss:0.05495687201619148
[epoch 27, batch 20]Loss:0.07333053648471832
[epoch 27, batch 30]Loss:0.1131744384765625
[epoch 27, batch 40]Loss:0.13039752840995789
[epoch 27, batch 50]Loss:0.12180878221988678
[epoch 27, batch 60]Loss:0.11316940188407898
[epoch 27, batch 70]Loss:0.11117008328437805
[epoch 27, batch 80]Loss:0.06672296673059464
[epoch 27, batch 90]Loss:0.0905948057770729
[epoch 27, batch 100]Loss:0.1957385092973709
[epoch 27, batch 110]Loss:0.16105914115905762
[epoch 27, batch 120]Loss:0.18184909224510193
[epoch 27, batch 130]Loss:0.08544432371854782
[epoch 27, batch 140]Loss:0.10855169594287872
[epoch 27, batch 150]Loss:0.12599124014377594
[epoch 27, batch 160]Loss:0.04595351964235306
[train] MAP:0.8042136303129891, MRR:0.8136953753798891
[eval] MAP:0.6800547996976568, MRR:0.6823034769463342
[epoch 28, batch 10]Loss:0.04196397215127945
[epoch 28, batch 20]Loss:0.08207891881465912
[epoch 28, batch 30]Loss:0.06386595219373703
[epoch 28, batch 40]Loss:0.05353322997689247
[epoch 28, batch 50]Loss:0.10898783057928085
[epoch 28, batch 60]Loss:0.10757076740264893
[epoch 28, batch 70]Loss:0.07855244725942612
[epoch 28, batch 80]Loss:0.1464247703552246
[epoch 28, batch 90]Loss:0.08136600255966187
[epoch 28, batch 100]Loss:0.15382467210292816
[epoch 28, batch 110]Loss:0.08448751270771027
[epoch 28, batch 120]Loss:0.09116198867559433
[epoch 28, batch 130]Loss:0.08586153388023376
[epoch 28, batch 140]Loss:0.09909608215093613
[epoch 28, batch 150]Loss:0.08161261677742004
[epoch 28, batch 160]Loss:0.18052449822425842
[train] MAP:0.9021980351776185, MRR:0.9066166036046772
[eval] MAP:0.6755952380952381, MRR:0.6792328042328042
[epoch 29, batch 10]Loss:0.09120761603116989
[epoch 29, batch 20]Loss:0.06479301303625107
[epoch 29, batch 30]Loss:0.11957833915948868
[epoch 29, batch 40]Loss:0.08032761514186859
[epoch 29, batch 50]Loss:0.09648428857326508
[epoch 29, batch 60]Loss:0.06054726988077164
[epoch 29, batch 70]Loss:0.07132033258676529
[epoch 29, batch 80]Loss:0.09310831129550934
[epoch 29, batch 90]Loss:0.10907627642154694
[epoch 29, batch 100]Loss:0.037156254053115845
[epoch 29, batch 110]Loss:0.09673095494508743
[epoch 29, batch 120]Loss:0.16689243912696838
[epoch 29, batch 130]Loss:0.07889500260353088
[epoch 29, batch 140]Loss:0.08988018333911896
[epoch 29, batch 150]Loss:0.13883233070373535
[epoch 29, batch 160]Loss:0.14247137308120728
[train] MAP:0.8981786943076613, MRR:0.9040346685485153
[eval] MAP:0.680026455026455, MRR:0.6809523809523809
[epoch 30, batch 10]Loss:0.139689102768898
[epoch 30, batch 20]Loss:0.11028305441141129
[epoch 30, batch 30]Loss:0.08056482672691345
[epoch 30, batch 40]Loss:0.08844169229269028
[epoch 30, batch 50]Loss:0.09728224575519562
[epoch 30, batch 60]Loss:0.12604032456874847
[epoch 30, batch 70]Loss:0.12352152168750763
[epoch 30, batch 80]Loss:0.11589188873767853
[epoch 30, batch 90]Loss:0.09542074799537659
[epoch 30, batch 100]Loss:0.09177441895008087
[epoch 30, batch 110]Loss:0.05644216388463974
[epoch 30, batch 120]Loss:0.1010158434510231
[epoch 30, batch 130]Loss:0.14031711220741272
[epoch 30, batch 140]Loss:0.12049710750579834
[epoch 30, batch 150]Loss:0.14985491335391998
[epoch 30, batch 160]Loss:0.007489034906029701
[train] MAP:0.9037159841601208, MRR:0.9074688918280996
[eval] MAP:0.6790910808767952, MRR:0.680017006802721
[epoch 31, batch 10]Loss:0.0678984671831131
[epoch 31, batch 20]Loss:0.12446080893278122
[epoch 31, batch 30]Loss:0.08496667444705963
[epoch 31, batch 40]Loss:0.10140125453472137
[epoch 31, batch 50]Loss:0.05294964089989662
[epoch 31, batch 60]Loss:0.07366571575403214
[epoch 31, batch 70]Loss:0.09360077977180481
[epoch 31, batch 80]Loss:0.046448275446891785
[epoch 31, batch 90]Loss:0.07338349521160126
[epoch 31, batch 100]Loss:0.16662636399269104
[epoch 31, batch 110]Loss:0.1166251003742218
[epoch 31, batch 120]Loss:0.03907516971230507
[epoch 31, batch 130]Loss:0.14314183592796326
[epoch 31, batch 140]Loss:0.10500261187553406
[epoch 31, batch 150]Loss:0.06082364171743393
[epoch 31, batch 160]Loss:0.23494559526443481
[train] MAP:0.9304450517754399, MRR:0.9314683407466915
[eval] MAP:0.6548878810783573, MRR:0.6558799445704208
[epoch 32, batch 10]Loss:0.07565547525882721
[epoch 32, batch 20]Loss:0.03302683308720589
[epoch 32, batch 30]Loss:0.05830920487642288
[epoch 32, batch 40]Loss:0.0983070582151413
[epoch 32, batch 50]Loss:0.07463133335113525
[epoch 32, batch 60]Loss:0.07588665187358856
[epoch 32, batch 70]Loss:0.1124006062746048
[epoch 32, batch 80]Loss:0.10395845770835876
[epoch 32, batch 90]Loss:0.06709528714418411
[epoch 32, batch 100]Loss:0.02676866389811039
[epoch 32, batch 110]Loss:0.09146498143672943
[epoch 32, batch 120]Loss:0.15133008360862732
[epoch 32, batch 130]Loss:0.060435254126787186
[epoch 32, batch 140]Loss:0.05828200280666351
[epoch 32, batch 150]Loss:0.06995020806789398
[epoch 32, batch 160]Loss:0.3285622298717499
[train] MAP:0.8992874149389791, MRR:0.9054661223204359
[eval] MAP:0.6808862433862434, MRR:0.6831349206349207
[epoch 33, batch 10]Loss:0.07178812474012375
[epoch 33, batch 20]Loss:0.12402617931365967
[epoch 33, batch 30]Loss:0.07190826535224915
[epoch 33, batch 40]Loss:0.08132568001747131
[epoch 33, batch 50]Loss:0.022433564066886902
[epoch 33, batch 60]Loss:0.07030633091926575
[epoch 33, batch 70]Loss:0.05651586502790451
[epoch 33, batch 80]Loss:0.08659526705741882
[epoch 33, batch 90]Loss:0.09497460722923279
[epoch 33, batch 100]Loss:0.09145992249250412
[epoch 33, batch 110]Loss:0.1050308495759964
[epoch 33, batch 120]Loss:0.03995152935385704
[epoch 33, batch 130]Loss:0.08413469791412354
[epoch 33, batch 140]Loss:0.06310147047042847
[epoch 33, batch 150]Loss:0.06794612109661102
[epoch 33, batch 160]Loss:0.06199900060892105
[train] MAP:0.9403491126048811, MRR:0.9436412480226916
[eval] MAP:0.6737339380196522, MRR:0.6746598639455783
[epoch 34, batch 10]Loss:0.17370417714118958
[epoch 34, batch 20]Loss:0.09712839126586914
[epoch 34, batch 30]Loss:0.11424612998962402
[epoch 34, batch 40]Loss:0.12380629777908325
[epoch 34, batch 50]Loss:0.06487035751342773
[epoch 34, batch 60]Loss:0.13505123555660248
[epoch 34, batch 70]Loss:0.13151979446411133
[epoch 34, batch 80]Loss:0.09990446269512177
[epoch 34, batch 90]Loss:0.06959901750087738
[epoch 34, batch 100]Loss:0.10579245537519455
[epoch 34, batch 110]Loss:0.07236155867576599
[epoch 34, batch 120]Loss:0.10843271017074585
[epoch 34, batch 130]Loss:0.08456184715032578
[epoch 34, batch 140]Loss:0.06886285543441772
[epoch 34, batch 150]Loss:0.09131886810064316
[epoch 34, batch 160]Loss:0.49016663432121277
[train] MAP:0.9115027943794447, MRR:0.9159259739744456
[eval] MAP:0.6821334089191231, MRR:0.6830593348450491
[epoch 35, batch 10]Loss:0.08859545737504959
[epoch 35, batch 20]Loss:0.07697194069623947
[epoch 35, batch 30]Loss:0.06265151500701904
[epoch 35, batch 40]Loss:0.046855002641677856
[epoch 35, batch 50]Loss:0.07638253271579742
[epoch 35, batch 60]Loss:0.06013557314872742
[epoch 35, batch 70]Loss:0.11077332496643066
[epoch 35, batch 80]Loss:0.07296127825975418
[epoch 35, batch 90]Loss:0.06264722347259521
[epoch 35, batch 100]Loss:0.06503435224294662
[epoch 35, batch 110]Loss:0.09862902760505676
[epoch 35, batch 120]Loss:0.0397353433072567
[epoch 35, batch 130]Loss:0.16502000391483307
[epoch 35, batch 140]Loss:0.0907866358757019
[epoch 35, batch 150]Loss:0.06563546508550644
[epoch 35, batch 160]Loss:0.04522272199392319
[train] MAP:0.9484555504314955, MRR:0.9499977685544696
[eval] MAP:0.6485008818342152, MRR:0.6494268077601411
[epoch 36, batch 10]Loss:0.07531975209712982
[epoch 36, batch 20]Loss:0.06316536664962769
[epoch 36, batch 30]Loss:0.04420505464076996
[epoch 36, batch 40]Loss:0.09072472900152206
[epoch 36, batch 50]Loss:0.0575832799077034
[epoch 36, batch 60]Loss:0.07445743680000305
[epoch 36, batch 70]Loss:0.06836790591478348
[epoch 36, batch 80]Loss:0.09012444317340851
[epoch 36, batch 90]Loss:0.047910965979099274
[epoch 36, batch 100]Loss:0.039619993418455124
[epoch 36, batch 110]Loss:0.10661320388317108
[epoch 36, batch 120]Loss:0.049913205206394196
[epoch 36, batch 130]Loss:0.08024874329566956
[epoch 36, batch 140]Loss:0.08119505643844604
[epoch 36, batch 150]Loss:0.13535964488983154
[epoch 36, batch 160]Loss:0.138519749045372
[train] MAP:0.9559269386588974, MRR:0.9588887693698691
[eval] MAP:0.664937641723356, MRR:0.6671863189720333
[epoch 37, batch 10]Loss:0.049307484179735184
[epoch 37, batch 20]Loss:0.12294447422027588
[epoch 37, batch 30]Loss:0.049087848514318466
[epoch 37, batch 40]Loss:0.0645446926355362
[epoch 37, batch 50]Loss:0.14343731105327606
[epoch 37, batch 60]Loss:0.05756331980228424
[epoch 37, batch 70]Loss:0.06963308900594711
[epoch 37, batch 80]Loss:0.04467794671654701
[epoch 37, batch 90]Loss:0.04550639167428017
[epoch 37, batch 100]Loss:0.03407479450106621
[epoch 37, batch 110]Loss:0.07759858667850494
[epoch 37, batch 120]Loss:0.0918910801410675
[epoch 37, batch 130]Loss:0.035831764340400696
[epoch 37, batch 140]Loss:0.10535790026187897
[epoch 37, batch 150]Loss:0.06357913464307785
[epoch 37, batch 160]Loss:0.0021611875854432583
[train] MAP:0.961056081502817, MRR:0.9622837897751988
[eval] MAP:0.6686413454270597, MRR:0.6708900226757369
[epoch 38, batch 10]Loss:0.060716647654771805
[epoch 38, batch 20]Loss:0.094185009598732
[epoch 38, batch 30]Loss:0.04796166718006134
[epoch 38, batch 40]Loss:0.052885375916957855
[epoch 38, batch 50]Loss:0.04997999593615532
[epoch 38, batch 60]Loss:0.06870967149734497
[epoch 38, batch 70]Loss:0.036919005215168
[epoch 38, batch 80]Loss:0.03469502925872803
[epoch 38, batch 90]Loss:0.04803381860256195
[epoch 38, batch 100]Loss:0.07894277572631836
[epoch 38, batch 110]Loss:0.1139160767197609
[epoch 38, batch 120]Loss:0.07090037316083908
[epoch 38, batch 130]Loss:0.02976907230913639
[epoch 38, batch 140]Loss:0.04649648070335388
[epoch 38, batch 150]Loss:0.07492130249738693
[epoch 38, batch 160]Loss:0.15483742952346802
[train] MAP:0.9019532670684884, MRR:0.9089760807064223
[eval] MAP:0.697250566893424, MRR:0.6994992441421014
[epoch 39, batch 10]Loss:0.02901790291070938
[epoch 39, batch 20]Loss:0.04743557423353195
[epoch 39, batch 30]Loss:0.055254220962524414
[epoch 39, batch 40]Loss:0.036947738379240036
[epoch 39, batch 50]Loss:0.036688659340143204
[epoch 39, batch 60]Loss:0.09953813254833221
[epoch 39, batch 70]Loss:0.025762129575014114
[epoch 39, batch 80]Loss:0.07805392146110535
[epoch 39, batch 90]Loss:0.0794789269566536
[epoch 39, batch 100]Loss:0.07487282156944275
[epoch 39, batch 110]Loss:0.12727469205856323
[epoch 39, batch 120]Loss:0.037658244371414185
[epoch 39, batch 130]Loss:0.08002059161663055
[epoch 39, batch 140]Loss:0.04046216607093811
[epoch 39, batch 150]Loss:0.06875868141651154
[epoch 39, batch 160]Loss:0.10366976261138916
[train] MAP:0.9776400193925966, MRR:0.978089531697779
[eval] MAP:0.6583238851095993, MRR:0.6592498110355253
[epoch 40, batch 10]Loss:0.053230613470077515
[epoch 40, batch 20]Loss:0.02612367831170559
[epoch 40, batch 30]Loss:0.058883361518383026
[epoch 40, batch 40]Loss:0.02271227166056633
[epoch 40, batch 50]Loss:0.035158686339855194
[epoch 40, batch 60]Loss:0.05504900962114334
[epoch 40, batch 70]Loss:0.044352736324071884
[epoch 40, batch 80]Loss:0.0849820002913475
[epoch 40, batch 90]Loss:0.17056694626808167
[epoch 40, batch 100]Loss:0.046762723475694656
[epoch 40, batch 110]Loss:0.04826855659484863
[epoch 40, batch 120]Loss:0.04438924789428711
[epoch 40, batch 130]Loss:0.05219915509223938
[epoch 40, batch 140]Loss:0.04939231649041176
[epoch 40, batch 150]Loss:0.03067382425069809
[epoch 40, batch 160]Loss:0.014849569648504257
[train] MAP:0.9751222749504538, MRR:0.9759177439589811
[eval] MAP:0.6707010582010581, MRR:0.671626984126984
[epoch 41, batch 10]Loss:0.06834855675697327
[epoch 41, batch 20]Loss:0.06287488341331482
[epoch 41, batch 30]Loss:0.09451155364513397
[epoch 41, batch 40]Loss:0.07071621716022491
[epoch 41, batch 50]Loss:0.09678471088409424
[epoch 41, batch 60]Loss:0.1208794116973877
[epoch 41, batch 70]Loss:0.023185644298791885
[epoch 41, batch 80]Loss:0.04151498153805733
[epoch 41, batch 90]Loss:0.04769812896847725
[epoch 41, batch 100]Loss:0.03541659936308861
[epoch 41, batch 110]Loss:0.09191986918449402
[epoch 41, batch 120]Loss:0.03604414314031601
[epoch 41, batch 130]Loss:0.04188428074121475
[epoch 41, batch 140]Loss:0.0459272526204586
[epoch 41, batch 150]Loss:0.11994911730289459
[epoch 41, batch 160]Loss:0.7208756804466248
[train] MAP:0.9770008469321183, MRR:0.978425831518615
[eval] MAP:0.6704365079365079, MRR:0.6713624338624338
[epoch 42, batch 10]Loss:0.023477604612708092
[epoch 42, batch 20]Loss:0.028781190514564514
[epoch 42, batch 30]Loss:0.040099337697029114
[epoch 42, batch 40]Loss:0.058320432901382446
[epoch 42, batch 50]Loss:0.07869629561901093
[epoch 42, batch 60]Loss:0.021465644240379333
[epoch 42, batch 70]Loss:0.05005078762769699
[epoch 42, batch 80]Loss:0.09092319011688232
[epoch 42, batch 90]Loss:0.09730853140354156
[epoch 42, batch 100]Loss:0.045947473496198654
[epoch 42, batch 110]Loss:0.049494560807943344
[epoch 42, batch 120]Loss:0.06455838680267334
[epoch 42, batch 130]Loss:0.06836200505495071
[epoch 42, batch 140]Loss:0.08081425726413727
[epoch 42, batch 150]Loss:0.04892532527446747
[epoch 42, batch 160]Loss:0.14861240983009338
[train] MAP:0.9774450444553536, MRR:0.9773495881743303
[eval] MAP:0.652891156462585, MRR:0.653817082388511
[epoch 43, batch 10]Loss:0.06251662224531174
[epoch 43, batch 20]Loss:0.11718828976154327
[epoch 43, batch 30]Loss:0.07082249224185944
[epoch 43, batch 40]Loss:0.038955576717853546
[epoch 43, batch 50]Loss:0.07815401256084442
[epoch 43, batch 60]Loss:0.08853809535503387
[epoch 43, batch 70]Loss:0.01716366782784462
[epoch 43, batch 80]Loss:0.04226656258106232
[epoch 43, batch 90]Loss:0.09055079519748688
[epoch 43, batch 100]Loss:0.07440274953842163
[epoch 43, batch 110]Loss:0.02371710166335106
[epoch 43, batch 120]Loss:0.061214253306388855
[epoch 43, batch 130]Loss:0.06973680108785629
[epoch 43, batch 140]Loss:0.0398702546954155
[epoch 43, batch 150]Loss:0.03320705518126488
[epoch 43, batch 160]Loss:0.32246264815330505
[train] MAP:0.9810596556301023, MRR:0.9811678394152622
[eval] MAP:0.6589191232048375, MRR:0.660837112622827
[epoch 44, batch 10]Loss:0.011243270710110664
[epoch 44, batch 20]Loss:0.08657923340797424
[epoch 44, batch 30]Loss:0.03413323312997818
[epoch 44, batch 40]Loss:0.05124204605817795
[epoch 44, batch 50]Loss:0.05172797292470932
[epoch 44, batch 60]Loss:0.15188975632190704
[epoch 44, batch 70]Loss:0.1250867247581482
[epoch 44, batch 80]Loss:0.061466846615076065
[epoch 44, batch 90]Loss:0.11688970029354095
[epoch 44, batch 100]Loss:0.0748986005783081
[epoch 44, batch 110]Loss:0.058584749698638916
[epoch 44, batch 120]Loss:0.048170723021030426
[epoch 44, batch 130]Loss:0.04216010868549347
[epoch 44, batch 140]Loss:0.04025086387991905
[epoch 44, batch 150]Loss:0.03215827792882919
[epoch 44, batch 160]Loss:0.05400776490569115
[train] MAP:0.9614788164616342, MRR:0.9641720059245833
[eval] MAP:0.6872354497354497, MRR:0.689484126984127
[epoch 45, batch 10]Loss:0.02722402662038803
[epoch 45, batch 20]Loss:0.038190167397260666
[epoch 45, batch 30]Loss:0.08535841107368469
[epoch 45, batch 40]Loss:0.041559334844350815
[epoch 45, batch 50]Loss:0.025238465517759323
[epoch 45, batch 60]Loss:0.06042370945215225
[epoch 45, batch 70]Loss:0.06973631680011749
[epoch 45, batch 80]Loss:0.029719389975070953
[epoch 45, batch 90]Loss:0.04230092093348503
[epoch 45, batch 100]Loss:0.04448174685239792
[epoch 45, batch 110]Loss:0.06146014854311943
[epoch 45, batch 120]Loss:0.15099361538887024
[epoch 45, batch 130]Loss:0.029775362461805344
[epoch 45, batch 140]Loss:0.04743729904294014
[epoch 45, batch 150]Loss:0.03989635035395622
[epoch 45, batch 160]Loss:0.011828521266579628
[train] MAP:0.9785259731995126, MRR:0.9794359897452681
[eval] MAP:0.6654761904761903, MRR:0.6693783068783069
[epoch 46, batch 10]Loss:0.00818843673914671
[epoch 46, batch 20]Loss:0.03685604780912399
[epoch 46, batch 30]Loss:0.11949914693832397
[epoch 46, batch 40]Loss:0.05556315928697586
[epoch 46, batch 50]Loss:0.011983620002865791
[epoch 46, batch 60]Loss:0.10290302336215973
[epoch 46, batch 70]Loss:0.04008254036307335
[epoch 46, batch 80]Loss:0.023973241448402405
[epoch 46, batch 90]Loss:0.061588581651449203
[epoch 46, batch 100]Loss:0.07635606825351715
[epoch 46, batch 110]Loss:0.046043917536735535
[epoch 46, batch 120]Loss:0.11508768796920776
[epoch 46, batch 130]Loss:0.026936594396829605
[epoch 46, batch 140]Loss:0.05707238242030144
[epoch 46, batch 150]Loss:0.10442274063825607
[epoch 46, batch 160]Loss:0.0004317451093811542
[train] MAP:0.9759473725968569, MRR:0.9776673212240222
[eval] MAP:0.684589947089947, MRR:0.6868386243386244
[epoch 47, batch 10]Loss:0.02132873237133026
[epoch 47, batch 20]Loss:0.05836808308959007
[epoch 47, batch 30]Loss:0.05769328773021698
[epoch 47, batch 40]Loss:0.028709735721349716
[epoch 47, batch 50]Loss:0.030168328434228897
[epoch 47, batch 60]Loss:0.029157057404518127
[epoch 47, batch 70]Loss:0.03409646824002266
[epoch 47, batch 80]Loss:0.0629149004817009
[epoch 47, batch 90]Loss:0.04009208083152771
[epoch 47, batch 100]Loss:0.05112683027982712
[epoch 47, batch 110]Loss:0.0278337225317955
[epoch 47, batch 120]Loss:0.07282199710607529
[epoch 47, batch 130]Loss:0.07180344313383102
[epoch 47, batch 140]Loss:0.027441799640655518
[epoch 47, batch 150]Loss:0.04339485988020897
[epoch 47, batch 160]Loss:0.019517365843057632
[train] MAP:0.980198276332297, MRR:0.9814378443244423
[eval] MAP:0.6859126984126985, MRR:0.6881613756613756
[epoch 48, batch 10]Loss:0.0396232083439827
[epoch 48, batch 20]Loss:0.08794933557510376
[epoch 48, batch 30]Loss:0.05004052817821503
[epoch 48, batch 40]Loss:0.021177001297473907
[epoch 48, batch 50]Loss:0.08988066017627716
[epoch 48, batch 60]Loss:0.01591436378657818
[epoch 48, batch 70]Loss:0.026397259905934334
[epoch 48, batch 80]Loss:0.019349781796336174
[epoch 48, batch 90]Loss:0.031724605709314346
[epoch 48, batch 100]Loss:0.04731104150414467
[epoch 48, batch 110]Loss:0.0845116525888443
[epoch 48, batch 120]Loss:0.0439799427986145
[epoch 48, batch 130]Loss:0.013427168130874634
[epoch 48, batch 140]Loss:0.05153021961450577
[epoch 48, batch 150]Loss:0.10527746379375458
[epoch 48, batch 160]Loss:0.015229611657559872
[train] MAP:0.9872470408552882, MRR:0.9873043146239022
[eval] MAP:0.6614417989417989, MRR:0.6623677248677248
[epoch 49, batch 10]Loss:0.02506766840815544
[epoch 49, batch 20]Loss:0.014848235994577408
[epoch 49, batch 30]Loss:0.043397169560194016
[epoch 49, batch 40]Loss:0.062337201088666916
[epoch 49, batch 50]Loss:0.07054756581783295
[epoch 49, batch 60]Loss:0.044541433453559875
[epoch 49, batch 70]Loss:0.023772118613123894
[epoch 49, batch 80]Loss:0.043986979871988297
[epoch 49, batch 90]Loss:0.06089566648006439
[epoch 49, batch 100]Loss:0.05645153671503067
[epoch 49, batch 110]Loss:0.07240984588861465
[epoch 49, batch 120]Loss:0.05227403715252876
[epoch 49, batch 130]Loss:0.05477958917617798
[epoch 49, batch 140]Loss:0.03202325105667114
[epoch 49, batch 150]Loss:0.020332809537649155
[epoch 49, batch 160]Loss:0.00024537532590329647
[train] MAP:0.9926534328596184, MRR:0.992901619190279
[eval] MAP:0.6720238095238095, MRR:0.6762566137566137
[epoch 50, batch 10]Loss:0.042891524732112885
[epoch 50, batch 20]Loss:0.06341302394866943
[epoch 50, batch 30]Loss:0.03209051862359047
[epoch 50, batch 40]Loss:0.00919755082577467
[epoch 50, batch 50]Loss:0.0597483366727829
[epoch 50, batch 60]Loss:0.028493523597717285
[epoch 50, batch 70]Loss:0.052739404141902924
[epoch 50, batch 80]Loss:0.016139496117830276
[epoch 50, batch 90]Loss:0.02633224055171013
[epoch 50, batch 100]Loss:0.026689371094107628
[epoch 50, batch 110]Loss:0.00804965477436781
[epoch 50, batch 120]Loss:0.050613339990377426
[epoch 50, batch 130]Loss:0.04027576744556427
[epoch 50, batch 140]Loss:0.109034962952137
[epoch 50, batch 150]Loss:0.07788696885108948
[epoch 50, batch 160]Loss:0.06377901136875153
[train] MAP:0.9923878486102344, MRR:0.9922680412371134
[eval] MAP:0.6894085411942555, MRR:0.6936413454270597
[epoch 51, batch 10]Loss:0.01347710657864809
[epoch 51, batch 20]Loss:0.07987542450428009
[epoch 51, batch 30]Loss:0.04762798547744751
[epoch 51, batch 40]Loss:0.051757678389549255
[epoch 51, batch 50]Loss:0.04283212125301361
[epoch 51, batch 60]Loss:0.037564992904663086
[epoch 51, batch 70]Loss:0.029673554003238678
[epoch 51, batch 80]Loss:0.029986672103405
[epoch 51, batch 90]Loss:0.009506840258836746
[epoch 51, batch 100]Loss:0.039815135300159454
[epoch 51, batch 110]Loss:0.03494817763566971
[epoch 51, batch 120]Loss:0.0585201159119606
[epoch 51, batch 130]Loss:0.06853710114955902
[epoch 51, batch 140]Loss:0.01912671886384487
[epoch 51, batch 150]Loss:0.019986286759376526
[epoch 51, batch 160]Loss:0.046069465577602386
[train] MAP:0.9876365933926071, MRR:0.9876861397479955
[eval] MAP:0.6702947845804987, MRR:0.6725434618291761
[epoch 52, batch 10]Loss:0.04284520074725151
[epoch 52, batch 20]Loss:0.03783209249377251
[epoch 52, batch 30]Loss:0.11243145912885666
[epoch 52, batch 40]Loss:0.014630040153861046
[epoch 52, batch 50]Loss:0.03386949002742767
[epoch 52, batch 60]Loss:0.058413539081811905
[epoch 52, batch 70]Loss:0.05909896641969681
[epoch 52, batch 80]Loss:0.02233445644378662
[epoch 52, batch 90]Loss:0.03829766809940338
[epoch 52, batch 100]Loss:0.019111860543489456
[epoch 52, batch 110]Loss:0.037526220083236694
[epoch 52, batch 120]Loss:0.01989820972084999
[epoch 52, batch 130]Loss:0.03001691773533821
[epoch 52, batch 140]Loss:0.054835475981235504
[epoch 52, batch 150]Loss:0.09920033812522888
[epoch 52, batch 160]Loss:0.02240397222340107
[train] MAP:0.9930535100638194, MRR:0.9936453390061638
[eval] MAP:0.6878212396069538, MRR:0.6900699168556311
[epoch 53, batch 10]Loss:0.013022836297750473
[epoch 53, batch 20]Loss:0.02281847409904003
[epoch 53, batch 30]Loss:0.06155478581786156
[epoch 53, batch 40]Loss:0.05984583497047424
[epoch 53, batch 50]Loss:0.02412990853190422
[epoch 53, batch 60]Loss:0.02080906368792057
[epoch 53, batch 70]Loss:0.026858612895011902
[epoch 53, batch 80]Loss:0.08512541651725769
[epoch 53, batch 90]Loss:0.02787136286497116
[epoch 53, batch 100]Loss:0.03761330246925354
[epoch 53, batch 110]Loss:0.04799490422010422
[epoch 53, batch 120]Loss:0.030777661129832268
[epoch 53, batch 130]Loss:0.03801462799310684
[epoch 53, batch 140]Loss:0.00627262145280838
[epoch 53, batch 150]Loss:0.04341323673725128
[epoch 53, batch 160]Loss:0.003465611021965742
[train] MAP:0.9938907980145093, MRR:0.9936998854524628
[eval] MAP:0.6658541194255478, MRR:0.6667800453514738
[epoch 54, batch 10]Loss:0.03436218947172165
[epoch 54, batch 20]Loss:0.02797923982143402
[epoch 54, batch 30]Loss:0.018580013886094093
[epoch 54, batch 40]Loss:0.017938660457730293
[epoch 54, batch 50]Loss:0.014533312991261482
[epoch 54, batch 60]Loss:0.05001635104417801
[epoch 54, batch 70]Loss:0.008797305636107922
[epoch 54, batch 80]Loss:0.07571270316839218
[epoch 54, batch 90]Loss:0.016386745497584343
[epoch 54, batch 100]Loss:0.08967237174510956
[epoch 54, batch 110]Loss:0.16641174256801605
[epoch 54, batch 120]Loss:0.025881800800561905
[epoch 54, batch 130]Loss:0.0424366295337677
[epoch 54, batch 140]Loss:0.02929522469639778
[epoch 54, batch 150]Loss:0.06582929939031601
[epoch 54, batch 160]Loss:0.004522873554378748
[train] MAP:0.9919498536337025, MRR:0.9919816723940436
[eval] MAP:0.6593820861678004, MRR:0.6622921390778532
[epoch 55, batch 10]Loss:0.022517843171954155
[epoch 55, batch 20]Loss:0.050436608493328094
[epoch 55, batch 30]Loss:0.015662048012018204
[epoch 55, batch 40]Loss:0.0451456755399704
[epoch 55, batch 50]Loss:0.06184463948011398
[epoch 55, batch 60]Loss:0.07090359181165695
[epoch 55, batch 70]Loss:0.04611438885331154
[epoch 55, batch 80]Loss:0.01943865418434143
[epoch 55, batch 90]Loss:0.025434553623199463
[epoch 55, batch 100]Loss:0.01569356769323349
[epoch 55, batch 110]Loss:0.010960238985717297
[epoch 55, batch 120]Loss:0.030496276915073395
[epoch 55, batch 130]Loss:0.030478615313768387
[epoch 55, batch 140]Loss:0.023178543895483017
[epoch 55, batch 150]Loss:0.1224316656589508
[epoch 55, batch 160]Loss:0.004786478355526924
[train] MAP:0.9943185330642376, MRR:0.9942726231386025
[eval] MAP:0.6645313681027966, MRR:0.6674414210128494
[epoch 56, batch 10]Loss:0.030725494027137756
[epoch 56, batch 20]Loss:0.004776609595865011
[epoch 56, batch 30]Loss:0.011539159342646599
[epoch 56, batch 40]Loss:0.09628666937351227
[epoch 56, batch 50]Loss:0.037892282009124756
[epoch 56, batch 60]Loss:0.01191833708435297
[epoch 56, batch 70]Loss:0.010629890486598015
[epoch 56, batch 80]Loss:0.03748597204685211
[epoch 56, batch 90]Loss:0.055084630846977234
[epoch 56, batch 100]Loss:0.045139070600271225
[epoch 56, batch 110]Loss:0.05375528335571289
[epoch 56, batch 120]Loss:0.0553874596953392
[epoch 56, batch 130]Loss:0.03984775394201279
[epoch 56, batch 140]Loss:0.04096074774861336
[epoch 56, batch 150]Loss:0.052225738763809204
[epoch 56, batch 160]Loss:0.0021554757840931416
[train] MAP:0.9910412007491045, MRR:0.9906452844597174
[eval] MAP:0.6693628461485603, MRR:0.6722728990586132
[epoch 57, batch 10]Loss:0.03959820792078972
[epoch 57, batch 20]Loss:0.05364225432276726
[epoch 57, batch 30]Loss:0.02301238477230072
[epoch 57, batch 40]Loss:0.01663491316139698
[epoch 57, batch 50]Loss:0.08790194988250732
[epoch 57, batch 60]Loss:0.019165772944688797
[epoch 57, batch 70]Loss:0.04677147790789604
[epoch 57, batch 80]Loss:0.05977630615234375
[epoch 57, batch 90]Loss:0.0515570268034935
[epoch 57, batch 100]Loss:0.06626199185848236
[epoch 57, batch 110]Loss:0.11829923838376999
[epoch 57, batch 120]Loss:0.04397403448820114
[epoch 57, batch 130]Loss:0.02967897430062294
[epoch 57, batch 140]Loss:0.08827555179595947
[epoch 57, batch 150]Loss:0.03519546985626221
[epoch 57, batch 160]Loss:0.0028790482319891453
[train] MAP:0.9893762354120724, MRR:0.9898052691867125
[eval] MAP:0.6605284706475182, MRR:0.6634385235575712
[epoch 58, batch 10]Loss:0.031775668263435364
[epoch 58, batch 20]Loss:0.025812482461333275
[epoch 58, batch 30]Loss:0.023956574499607086
[epoch 58, batch 40]Loss:0.07646169513463974
[epoch 58, batch 50]Loss:0.017839860171079636
[epoch 58, batch 60]Loss:0.0419243723154068
[epoch 58, batch 70]Loss:0.014552153646945953
[epoch 58, batch 80]Loss:0.03765451908111572
[epoch 58, batch 90]Loss:0.03297682851552963
[epoch 58, batch 100]Loss:0.019817925989627838
[epoch 58, batch 110]Loss:0.028959546238183975
[epoch 58, batch 120]Loss:0.01733085699379444
[epoch 58, batch 130]Loss:0.05323947221040726
[epoch 58, batch 140]Loss:0.05163739621639252
[epoch 58, batch 150]Loss:0.013005430810153484
[epoch 58, batch 160]Loss:3.605647725635208e-05
[train] MAP:0.9830423490217305, MRR:0.9839205468071448
[eval] MAP:0.6931878306878307, MRR:0.6954365079365078
[epoch 59, batch 10]Loss:0.015050585381686687
[epoch 59, batch 20]Loss:0.021723708137869835
[epoch 59, batch 30]Loss:0.043048035353422165
[epoch 59, batch 40]Loss:0.03505764156579971
[epoch 59, batch 50]Loss:0.021758709102869034
[epoch 59, batch 60]Loss:0.05013510584831238
[epoch 59, batch 70]Loss:0.022591326385736465
[epoch 59, batch 80]Loss:0.07557012885808945
[epoch 59, batch 90]Loss:0.031776100397109985
[epoch 59, batch 100]Loss:0.01800031214952469
[epoch 59, batch 110]Loss:0.06087829917669296
[epoch 59, batch 120]Loss:0.05547525733709335
[epoch 59, batch 130]Loss:0.03870231658220291
[epoch 59, batch 140]Loss:0.003490195609629154
[epoch 59, batch 150]Loss:0.03443048894405365
[epoch 59, batch 160]Loss:0.002552138175815344
[train] MAP:0.9912816596665395, MRR:0.9915998472699503
[eval] MAP:0.6572656840513982, MRR:0.6581916099773242
[epoch 60, batch 10]Loss:0.02743513137102127
[epoch 60, batch 20]Loss:0.027638565748929977
[epoch 60, batch 30]Loss:0.06208106130361557
[epoch 60, batch 40]Loss:0.07561763375997543
[epoch 60, batch 50]Loss:0.009212636388838291
[epoch 60, batch 60]Loss:0.0431893914937973
[epoch 60, batch 70]Loss:0.048157140612602234
[epoch 60, batch 80]Loss:0.030055927112698555
[epoch 60, batch 90]Loss:0.016083355993032455
[epoch 60, batch 100]Loss:0.048577502369880676
[epoch 60, batch 110]Loss:0.03544805943965912
[epoch 60, batch 120]Loss:0.04406532645225525
[epoch 60, batch 130]Loss:0.011346520856022835
[epoch 60, batch 140]Loss:0.06841717660427094
[epoch 60, batch 150]Loss:0.025191981345415115
[epoch 60, batch 160]Loss:0.0011986372992396355
[train] MAP:0.9968881252386408, MRR:0.9967926689576174
[eval] MAP:0.6680555555555554, MRR:0.6689814814814814
[epoch 61, batch 10]Loss:0.006105651147663593
[epoch 61, batch 20]Loss:0.003550299210473895
[epoch 61, batch 30]Loss:0.02813345566391945
[epoch 61, batch 40]Loss:0.03698195517063141
[epoch 61, batch 50]Loss:0.03103216551244259
[epoch 61, batch 60]Loss:0.00165464635938406
[epoch 61, batch 70]Loss:0.013154447078704834
[epoch 61, batch 80]Loss:0.024380650371313095
[epoch 61, batch 90]Loss:0.026475001126527786
[epoch 61, batch 100]Loss:0.020985350012779236
[epoch 61, batch 110]Loss:0.014208349399268627
[epoch 61, batch 120]Loss:0.020570367574691772
[epoch 61, batch 130]Loss:0.0653785914182663
[epoch 61, batch 140]Loss:0.06843291223049164
[epoch 61, batch 150]Loss:0.021991383284330368
[epoch 61, batch 160]Loss:0.0022277389653027058
[train] MAP:0.9936998854524628, MRR:0.9935089728904163
[eval] MAP:0.6728741496598638, MRR:0.6738000755857897
[epoch 62, batch 10]Loss:0.03969110921025276
[epoch 62, batch 20]Loss:0.017795423045754433
[epoch 62, batch 30]Loss:0.017750736325979233
[epoch 62, batch 40]Loss:0.04075741395354271
[epoch 62, batch 50]Loss:0.011685265228152275
[epoch 62, batch 60]Loss:0.04627501219511032
[epoch 62, batch 70]Loss:0.027968496084213257
[epoch 62, batch 80]Loss:0.014792252331972122
[epoch 62, batch 90]Loss:0.002529519610106945
[epoch 62, batch 100]Loss:0.009111284278333187
[epoch 62, batch 110]Loss:0.04602173715829849
[epoch 62, batch 120]Loss:0.030619779601693153
[epoch 62, batch 130]Loss:0.05703096091747284
[epoch 62, batch 140]Loss:0.015677010640501976
[epoch 62, batch 150]Loss:0.007237941958010197
[epoch 62, batch 160]Loss:0.022488832473754883
[train] MAP:0.9895125365915746, MRR:0.9900725467735776
[eval] MAP:0.6607804232804232, MRR:0.663690476190476
[epoch 63, batch 10]Loss:0.015362049452960491
[epoch 63, batch 20]Loss:0.15130969882011414
[epoch 63, batch 30]Loss:0.051565274596214294
[epoch 63, batch 40]Loss:0.01147551741451025
[epoch 63, batch 50]Loss:0.027459651231765747
[epoch 63, batch 60]Loss:0.008337737992405891
[epoch 63, batch 70]Loss:0.08765324205160141
[epoch 63, batch 80]Loss:0.021284518763422966
[epoch 63, batch 90]Loss:0.06212623417377472
[epoch 63, batch 100]Loss:0.006830771453678608
[epoch 63, batch 110]Loss:0.0829293355345726
[epoch 63, batch 120]Loss:0.041349396109580994
[epoch 63, batch 130]Loss:0.03371744230389595
[epoch 63, batch 140]Loss:0.005540189798921347
[epoch 63, batch 150]Loss:0.04387173056602478
[epoch 63, batch 160]Loss:0.015201378613710403
[train] MAP:0.9899675448644523, MRR:0.9899770904925544
[eval] MAP:0.6585789871504155, MRR:0.6644652305366588
[epoch 64, batch 10]Loss:0.023777417838573456
[epoch 64, batch 20]Loss:0.04442187026143074
[epoch 64, batch 30]Loss:0.024406149983406067
[epoch 64, batch 40]Loss:0.029021788388490677
[epoch 64, batch 50]Loss:0.02616141363978386
[epoch 64, batch 60]Loss:0.004917086102068424
[epoch 64, batch 70]Loss:0.020866824313998222
[epoch 64, batch 80]Loss:0.034980788826942444
[epoch 64, batch 90]Loss:0.06246718764305115
[epoch 64, batch 100]Loss:0.01341006625443697
[epoch 64, batch 110]Loss:0.025788426399230957
[epoch 64, batch 120]Loss:0.017314765602350235
[epoch 64, batch 130]Loss:0.031825512647628784
[epoch 64, batch 140]Loss:0.01703413762152195
[epoch 64, batch 150]Loss:0.003504436695948243
[epoch 64, batch 160]Loss:0.0005928187747485936
[train] MAP:0.9830278732340588, MRR:0.9831996945399007
[eval] MAP:0.6537824389014866, MRR:0.6566924918115394
[epoch 65, batch 10]Loss:0.002606276422739029
[epoch 65, batch 20]Loss:0.002825080882757902
[epoch 65, batch 30]Loss:0.01574999839067459
[epoch 65, batch 40]Loss:0.022778991609811783
[epoch 65, batch 50]Loss:0.02970440685749054
[epoch 65, batch 60]Loss:0.02111782133579254
[epoch 65, batch 70]Loss:0.021205715835094452
[epoch 65, batch 80]Loss:0.012709193862974644
[epoch 65, batch 90]Loss:0.03119579702615738
[epoch 65, batch 100]Loss:0.0659322738647461
[epoch 65, batch 110]Loss:0.024756010621786118
[epoch 65, batch 120]Loss:0.01324710063636303
[epoch 65, batch 130]Loss:0.03983268141746521
[epoch 65, batch 140]Loss:0.028043925762176514
[epoch 65, batch 150]Loss:0.03578232228755951
[epoch 65, batch 160]Loss:0.21231991052627563
[train] MAP:0.9978454153711885, MRR:0.9977499590901652
[eval] MAP:0.6860355253212395, MRR:0.6919217687074829
[epoch 66, batch 10]Loss:0.031041081994771957
[epoch 66, batch 20]Loss:0.02676503360271454
[epoch 66, batch 30]Loss:0.04617737978696823
[epoch 66, batch 40]Loss:0.03881154954433441
[epoch 66, batch 50]Loss:0.04765009135007858
[epoch 66, batch 60]Loss:0.034908477216959
[epoch 66, batch 70]Loss:0.032161325216293335
[epoch 66, batch 80]Loss:0.04420321807265282
[epoch 66, batch 90]Loss:0.0038453545421361923
[epoch 66, batch 100]Loss:0.011969320476055145
[epoch 66, batch 110]Loss:0.038135968148708344
[epoch 66, batch 120]Loss:0.012290828861296177
[epoch 66, batch 130]Loss:0.025287263095378876
[epoch 66, batch 140]Loss:0.002204516436904669
[epoch 66, batch 150]Loss:0.016541166231036186
[epoch 66, batch 160]Loss:0.0006875880062580109
[train] MAP:0.9962226585937927, MRR:0.9960317460317459
[eval] MAP:0.6875566893424034, MRR:0.6904667422524564
[epoch 67, batch 10]Loss:0.03417735546827316
[epoch 67, batch 20]Loss:0.01784856989979744
[epoch 67, batch 30]Loss:0.005926013458520174
[epoch 67, batch 40]Loss:0.022139228880405426
[epoch 67, batch 50]Loss:0.07057791948318481
[epoch 67, batch 60]Loss:0.024838432669639587
[epoch 67, batch 70]Loss:0.012604943476617336
[epoch 67, batch 80]Loss:0.043094489723443985
[epoch 67, batch 90]Loss:0.015772130340337753
[epoch 67, batch 100]Loss:0.03940420597791672
[epoch 67, batch 110]Loss:0.012995697557926178
[epoch 67, batch 120]Loss:0.03667045012116432
[epoch 67, batch 130]Loss:0.008614682592451572
[epoch 67, batch 140]Loss:0.04925810545682907
[epoch 67, batch 150]Loss:0.025723597034811974
[epoch 67, batch 160]Loss:0.005122230853885412
[train] MAP:0.9929044164439355, MRR:0.9925544100801833
[eval] MAP:0.6596371882086165, MRR:0.6625472411186694
[epoch 68, batch 10]Loss:0.01564408838748932
[epoch 68, batch 20]Loss:0.06554064899682999
[epoch 68, batch 30]Loss:0.05014815554022789
[epoch 68, batch 40]Loss:0.0421801321208477
[epoch 68, batch 50]Loss:0.03580835461616516
[epoch 68, batch 60]Loss:0.010353886522352695
[epoch 68, batch 70]Loss:0.01893562823534012
[epoch 68, batch 80]Loss:0.036088988184928894
[epoch 68, batch 90]Loss:0.006516661960631609
[epoch 68, batch 100]Loss:0.02163262665271759
[epoch 68, batch 110]Loss:0.020408200100064278
[epoch 68, batch 120]Loss:0.02103511430323124
[epoch 68, batch 130]Loss:0.08583313971757889
[epoch 68, batch 140]Loss:0.009410373866558075
[epoch 68, batch 150]Loss:0.01659882254898548
[epoch 68, batch 160]Loss:1.4498566088150255e-05
[train] MAP:0.9955544646266296, MRR:0.9954590083456062
[eval] MAP:0.6853206097253716, MRR:0.6862465356512976
[epoch 69, batch 10]Loss:0.044458065181970596
[epoch 69, batch 20]Loss:0.007042239885777235
[epoch 69, batch 30]Loss:0.011319342069327831
[epoch 69, batch 40]Loss:0.012649904936552048
[epoch 69, batch 50]Loss:0.010597243905067444
[epoch 69, batch 60]Loss:0.030720768496394157
[epoch 69, batch 70]Loss:0.023934055119752884
[epoch 69, batch 80]Loss:0.027068108320236206
[epoch 69, batch 90]Loss:0.0023344624787569046
[epoch 69, batch 100]Loss:0.007043081801384687
[epoch 69, batch 110]Loss:0.01918129436671734
[epoch 69, batch 120]Loss:0.02540196105837822
[epoch 69, batch 130]Loss:0.01262987032532692
[epoch 69, batch 140]Loss:0.014346581883728504
[epoch 69, batch 150]Loss:0.047671377658843994
[epoch 69, batch 160]Loss:0.03445334732532501
[train] MAP:0.9958953799159984, MRR:0.995799923634975
[eval] MAP:0.6860922146636432, MRR:0.6883408919123204
[epoch 70, batch 10]Loss:0.007071253843605518
[epoch 70, batch 20]Loss:0.019779695197939873
[epoch 70, batch 30]Loss:0.045217759907245636
[epoch 70, batch 40]Loss:0.0647742971777916
[epoch 70, batch 50]Loss:0.04754616692662239
[epoch 70, batch 60]Loss:0.014112482778728008
[epoch 70, batch 70]Loss:0.028945427387952805
[epoch 70, batch 80]Loss:0.01685114949941635
[epoch 70, batch 90]Loss:0.05766226723790169
[epoch 70, batch 100]Loss:0.013337768614292145
[epoch 70, batch 110]Loss:0.009323149919509888
[epoch 70, batch 120]Loss:0.060188814997673035
[epoch 70, batch 130]Loss:0.05949261039495468
[epoch 70, batch 140]Loss:0.023991571739315987
[epoch 70, batch 150]Loss:0.01474432647228241
[epoch 70, batch 160]Loss:0.00018231089052278548
[train] MAP:0.9964553900980018, MRR:0.9966781214203895
[eval] MAP:0.6796327790375408, MRR:0.6818814562862182
[epoch 71, batch 10]Loss:0.024030625820159912
[epoch 71, batch 20]Loss:0.01469789631664753
[epoch 71, batch 30]Loss:0.015115014277398586
[epoch 71, batch 40]Loss:0.04089159518480301
[epoch 71, batch 50]Loss:0.013944797217845917
[epoch 71, batch 60]Loss:0.039986222982406616
[epoch 71, batch 70]Loss:0.005416469648480415
[epoch 71, batch 80]Loss:0.012713847681879997
[epoch 71, batch 90]Loss:0.06673581898212433
[epoch 71, batch 100]Loss:0.010260676965117455
[epoch 71, batch 110]Loss:0.0035145520232617855
[epoch 71, batch 120]Loss:0.010825159959495068
[epoch 71, batch 130]Loss:0.008627919480204582
[epoch 71, batch 140]Loss:0.032742246985435486
[epoch 71, batch 150]Loss:0.015882251784205437
[epoch 71, batch 160]Loss:0.0015227673575282097
[train] MAP:0.9989690721649485, MRR:0.9989690721649485
[eval] MAP:0.684448223733938, MRR:0.6866969009826153
[epoch 72, batch 10]Loss:0.048312362283468246
[epoch 72, batch 20]Loss:0.011813843622803688
[epoch 72, batch 30]Loss:0.014812145382165909
[epoch 72, batch 40]Loss:0.008851856924593449
[epoch 72, batch 50]Loss:0.06928837299346924
[epoch 72, batch 60]Loss:0.05313514918088913
[epoch 72, batch 70]Loss:0.010499757714569569
[epoch 72, batch 80]Loss:0.01838572695851326
[epoch 72, batch 90]Loss:0.006385305430740118
[epoch 72, batch 100]Loss:0.019626347348093987
[epoch 72, batch 110]Loss:0.02687535434961319
[epoch 72, batch 120]Loss:0.01817534863948822
[epoch 72, batch 130]Loss:0.024556687101721764
[epoch 72, batch 140]Loss:0.02088870108127594
[epoch 72, batch 150]Loss:0.03917695954442024
[epoch 72, batch 160]Loss:0.0011033788323402405
[train] MAP:0.9811173839524356, MRR:0.9815769377625048
[eval] MAP:0.6511274880322498, MRR:0.6570137314184932
[epoch 73, batch 10]Loss:0.046181775629520416
[epoch 73, batch 20]Loss:0.03408650681376457
[epoch 73, batch 30]Loss:0.03713967278599739
[epoch 73, batch 40]Loss:0.028631573542952538
[epoch 73, batch 50]Loss:0.04264398664236069
[epoch 73, batch 60]Loss:0.07210999727249146
[epoch 73, batch 70]Loss:0.030553050339221954
[epoch 73, batch 80]Loss:0.007123068906366825
[epoch 73, batch 90]Loss:0.02259737253189087
[epoch 73, batch 100]Loss:0.002809029072523117
[epoch 73, batch 110]Loss:0.024298902601003647
[epoch 73, batch 120]Loss:0.035066746175289154
[epoch 73, batch 130]Loss:0.022912241518497467
[epoch 73, batch 140]Loss:0.06259084492921829
[epoch 73, batch 150]Loss:0.03930038958787918
[epoch 73, batch 160]Loss:1.9951152353314683e-05
[train] MAP:0.998036327933235, MRR:0.9983226967763049
[eval] MAP:0.6841175359032501, MRR:0.6850434618291761
[epoch 74, batch 10]Loss:0.011658783070743084
[epoch 74, batch 20]Loss:0.01054374873638153
[epoch 74, batch 30]Loss:0.039894476532936096
[epoch 74, batch 40]Loss:0.004571037366986275
[epoch 74, batch 50]Loss:0.016165848821401596
[epoch 74, batch 60]Loss:0.0118914395570755
[epoch 74, batch 70]Loss:0.04758210852742195
[epoch 74, batch 80]Loss:0.026157477870583534
[epoch 74, batch 90]Loss:0.023925503715872765
[epoch 74, batch 100]Loss:0.03459187597036362
[epoch 74, batch 110]Loss:0.010074364021420479
[epoch 74, batch 120]Loss:0.010468763299286366
[epoch 74, batch 130]Loss:0.024979636073112488
[epoch 74, batch 140]Loss:0.002417242154479027
[epoch 74, batch 150]Loss:0.05384380370378494
[epoch 74, batch 160]Loss:0.013645867817103863
[train] MAP:0.9971363115693013, MRR:0.9971363115693013
[eval] MAP:0.6730190224237843, MRR:0.6759290753338373
[epoch 75, batch 10]Loss:0.010311583057045937
[epoch 75, batch 20]Loss:0.0592050738632679
[epoch 75, batch 30]Loss:0.006803806871175766
[epoch 75, batch 40]Loss:0.027110479772090912
[epoch 75, batch 50]Loss:0.0957866981625557
[epoch 75, batch 60]Loss:0.02308567613363266
[epoch 75, batch 70]Loss:0.018823308870196342
[epoch 75, batch 80]Loss:0.027167510241270065
[epoch 75, batch 90]Loss:0.01797364093363285
[epoch 75, batch 100]Loss:0.02966197393834591
[epoch 75, batch 110]Loss:0.014161497354507446
[epoch 75, batch 120]Loss:0.02155880071222782
[epoch 75, batch 130]Loss:0.008864800445735455
[epoch 75, batch 140]Loss:0.005852883215993643
[epoch 75, batch 150]Loss:0.005902488715946674
[epoch 75, batch 160]Loss:0.009893656708300114
[train] MAP:0.9917907598319968, MRR:0.9917907598319968
[eval] MAP:0.674848828420257, MRR:0.6777588813303099
[epoch 76, batch 10]Loss:0.01507991086691618
[epoch 76, batch 20]Loss:0.00642328429967165
[epoch 76, batch 30]Loss:0.021917594596743584
[epoch 76, batch 40]Loss:0.0033026812598109245
[epoch 76, batch 50]Loss:0.018169434741139412
[epoch 76, batch 60]Loss:0.028323186561465263
[epoch 76, batch 70]Loss:0.010667940601706505
[epoch 76, batch 80]Loss:0.026951365172863007
[epoch 76, batch 90]Loss:0.003966040909290314
[epoch 76, batch 100]Loss:0.008005229756236076
[epoch 76, batch 110]Loss:0.0035242533776909113
[epoch 76, batch 120]Loss:0.008960993029177189
[epoch 76, batch 130]Loss:0.03533973544836044
[epoch 76, batch 140]Loss:0.027761779725551605
[epoch 76, batch 150]Loss:0.02409329265356064
[epoch 76, batch 160]Loss:0.0015362250851467252
[train] MAP:0.99831996945399, MRR:0.9988545246277205
[eval] MAP:0.6990772234819854, MRR:0.7019872763920382
[epoch 77, batch 10]Loss:0.002898536855354905
[epoch 77, batch 20]Loss:0.009387606754899025
[epoch 77, batch 30]Loss:0.07870582491159439
[epoch 77, batch 40]Loss:0.017901960760354996
[epoch 77, batch 50]Loss:0.005496738012880087
[epoch 77, batch 60]Loss:0.008601674810051918
[epoch 77, batch 70]Loss:0.0035207667388021946
[epoch 77, batch 80]Loss:0.020625729113817215
[epoch 77, batch 90]Loss:0.012544289231300354
[epoch 77, batch 100]Loss:0.03939402475953102
[epoch 77, batch 110]Loss:0.035973455756902695
[epoch 77, batch 120]Loss:0.017407651990652084
[epoch 77, batch 130]Loss:0.023278873413801193
[epoch 77, batch 140]Loss:0.0012421959545463324
[epoch 77, batch 150]Loss:0.008818799629807472
[epoch 77, batch 160]Loss:0.0001123555121012032
[train] MAP:0.9940726195021728, MRR:0.9940817105765558
[eval] MAP:0.6734158478206096, MRR:0.6763259007306626
[epoch 78, batch 10]Loss:0.05949121341109276
[epoch 78, batch 20]Loss:0.00509734358638525
[epoch 78, batch 30]Loss:0.035648271441459656
[epoch 78, batch 40]Loss:0.03876862674951553
[epoch 78, batch 50]Loss:0.051464296877384186
[epoch 78, batch 60]Loss:0.04034450277686119
[epoch 78, batch 70]Loss:0.004693401046097279
[epoch 78, batch 80]Loss:0.013515487313270569
[epoch 78, batch 90]Loss:0.06370670348405838
[epoch 78, batch 100]Loss:0.0046082232147455215
[epoch 78, batch 110]Loss:0.028136812150478363
[epoch 78, batch 120]Loss:0.007011652924120426
[epoch 78, batch 130]Loss:0.013704064302146435
[epoch 78, batch 140]Loss:0.003830491565167904
[epoch 78, batch 150]Loss:0.016896910965442657
[epoch 78, batch 160]Loss:0.01791198179125786
[train] MAP:0.9980731467844869, MRR:0.997709049255441
[eval] MAP:0.6791666666666666, MRR:0.6820767195767194
[epoch 79, batch 10]Loss:0.03140772506594658
[epoch 79, batch 20]Loss:0.004914391785860062
[epoch 79, batch 30]Loss:0.05403376370668411
[epoch 79, batch 40]Loss:0.011525806039571762
[epoch 79, batch 50]Loss:0.04456354305148125
[epoch 79, batch 60]Loss:0.005101514048874378
[epoch 79, batch 70]Loss:0.0335356742143631
[epoch 79, batch 80]Loss:0.015461805276572704
[epoch 79, batch 90]Loss:0.014414846897125244
[epoch 79, batch 100]Loss:0.02361314184963703
[epoch 79, batch 110]Loss:0.017973653972148895
[epoch 79, batch 120]Loss:0.020931288599967957
[epoch 79, batch 130]Loss:0.0377015545964241
[epoch 79, batch 140]Loss:0.052805714309215546
[epoch 79, batch 150]Loss:0.008664030581712723
[epoch 79, batch 160]Loss:5.3502975788433105e-05
[train] MAP:0.9974063164784814, MRR:0.9977499590901652
[eval] MAP:0.6985260770975056, MRR:0.7007747543461829
[epoch 80, batch 10]Loss:0.007527313660830259
[epoch 80, batch 20]Loss:0.02616429515182972
[epoch 80, batch 30]Loss:0.020552702248096466
[epoch 80, batch 40]Loss:0.013534601777791977
[epoch 80, batch 50]Loss:0.0009484726469963789
[epoch 80, batch 60]Loss:0.05491993576288223
[epoch 80, batch 70]Loss:0.027438081800937653
[epoch 80, batch 80]Loss:0.05943207070231438
[epoch 80, batch 90]Loss:0.012948947958648205
[epoch 80, batch 100]Loss:0.012412860989570618
[epoch 80, batch 110]Loss:0.005990158766508102
[epoch 80, batch 120]Loss:0.006611395161598921
[epoch 80, batch 130]Loss:0.024517636746168137
[epoch 80, batch 140]Loss:0.020913276821374893
[epoch 80, batch 150]Loss:0.008918916806578636
[epoch 80, batch 160]Loss:0.0581931471824646
[train] MAP:0.9971363115693014, MRR:0.9971363115693013
[eval] MAP:0.6925957420005039, MRR:0.6955057949105568
[epoch 81, batch 10]Loss:0.01830696314573288
[epoch 81, batch 20]Loss:0.006014540791511536
[epoch 81, batch 30]Loss:0.011072555556893349
[epoch 81, batch 40]Loss:0.03578950837254524
[epoch 81, batch 50]Loss:0.025654330849647522
[epoch 81, batch 60]Loss:0.03267667070031166
[epoch 81, batch 70]Loss:0.055644623935222626
[epoch 81, batch 80]Loss:0.034805819392204285
[epoch 81, batch 90]Loss:0.011089134961366653
[epoch 81, batch 100]Loss:0.03738105297088623
[epoch 81, batch 110]Loss:0.021360261365771294
[epoch 81, batch 120]Loss:0.04550386220216751
[epoch 81, batch 130]Loss:0.01632879301905632
[epoch 81, batch 140]Loss:0.001739573199301958
[epoch 81, batch 150]Loss:0.01881232298910618
[epoch 81, batch 160]Loss:0.002384051214903593
[train] MAP:0.9989499809087439, MRR:0.9988545246277205
[eval] MAP:0.6823885109599395, MRR:0.6852985638699923
[epoch 82, batch 10]Loss:0.039052993059158325
[epoch 82, batch 20]Loss:0.03095746599137783
[epoch 82, batch 30]Loss:0.030194301158189774
[epoch 82, batch 40]Loss:0.021457623690366745
[epoch 82, batch 50]Loss:0.05243637412786484
[epoch 82, batch 60]Loss:0.006555857136845589
[epoch 82, batch 70]Loss:0.03096030279994011
[epoch 82, batch 80]Loss:0.020503677427768707
[epoch 82, batch 90]Loss:0.0112534798681736
[epoch 82, batch 100]Loss:0.0016269683837890625
[epoch 82, batch 110]Loss:0.04343828186392784
[epoch 82, batch 120]Loss:0.11917965114116669
[epoch 82, batch 130]Loss:0.04701267182826996
[epoch 82, batch 140]Loss:0.02169382944703102
[epoch 82, batch 150]Loss:0.007556965574622154
[epoch 82, batch 160]Loss:0.0009763170965015888
[train] MAP:0.9971363115693013, MRR:0.9971363115693013
[eval] MAP:0.6736016628873771, MRR:0.67651171579743
[epoch 83, batch 10]Loss:0.011555386707186699
[epoch 83, batch 20]Loss:0.015895547345280647
[epoch 83, batch 30]Loss:0.01635340042412281
[epoch 83, batch 40]Loss:0.007524354849010706
[epoch 83, batch 50]Loss:0.0038609278853982687
[epoch 83, batch 60]Loss:0.016570966690778732
[epoch 83, batch 70]Loss:0.004641487263143063
[epoch 83, batch 80]Loss:0.007213525474071503
[epoch 83, batch 90]Loss:0.008166237734258175
[epoch 83, batch 100]Loss:0.0029267449863255024
[epoch 83, batch 110]Loss:0.006982113234698772
[epoch 83, batch 120]Loss:0.006491278298199177
[epoch 83, batch 130]Loss:0.007523787207901478
[epoch 83, batch 140]Loss:0.018869079649448395
[epoch 83, batch 150]Loss:0.0750439316034317
[epoch 83, batch 160]Loss:0.0016703500878065825
[train] MAP:0.997709049255441, MRR:0.997709049255441
[eval] MAP:0.6869079113126733, MRR:0.6898179642227261
[epoch 84, batch 10]Loss:0.004726460203528404
[epoch 84, batch 20]Loss:0.014500858262181282
[epoch 84, batch 30]Loss:0.027439434081315994
[epoch 84, batch 40]Loss:0.026300352066755295
[epoch 84, batch 50]Loss:0.01369425281882286
[epoch 84, batch 60]Loss:0.033983923494815826
[epoch 84, batch 70]Loss:0.04989505559206009
[epoch 84, batch 80]Loss:0.010436337441205978
[epoch 84, batch 90]Loss:0.009085344150662422
[epoch 84, batch 100]Loss:0.005287605337798595
[epoch 84, batch 110]Loss:0.017554420977830887
[epoch 84, batch 120]Loss:0.005560480989515781
[epoch 84, batch 130]Loss:0.016712812706828117
[epoch 84, batch 140]Loss:0.012496275827288628
[epoch 84, batch 150]Loss:0.04101823642849922
[epoch 84, batch 160]Loss:0.0002831145829986781
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6907974300831443, MRR:0.6937074829931972
[epoch 85, batch 10]Loss:0.028711844235658646
[epoch 85, batch 20]Loss:0.004105642903596163
[epoch 85, batch 30]Loss:0.029385121539235115
[epoch 85, batch 40]Loss:0.010818609036505222
[epoch 85, batch 50]Loss:0.0030404035933315754
[epoch 85, batch 60]Loss:0.002525696763768792
[epoch 85, batch 70]Loss:0.011673648841679096
[epoch 85, batch 80]Loss:0.011418485082685947
[epoch 85, batch 90]Loss:0.01273624412715435
[epoch 85, batch 100]Loss:0.006348034366965294
[epoch 85, batch 110]Loss:0.015214068815112114
[epoch 85, batch 120]Loss:0.010537968948483467
[epoch 85, batch 130]Loss:0.01979697123169899
[epoch 85, batch 140]Loss:0.0260915644466877
[epoch 85, batch 150]Loss:0.007260587066411972
[epoch 85, batch 160]Loss:1.1622791134868748e-05
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6931122448979591, MRR:0.6940381708238851
[epoch 86, batch 10]Loss:0.006687983870506287
[epoch 86, batch 20]Loss:0.03901638835668564
[epoch 86, batch 30]Loss:0.012306833639740944
[epoch 86, batch 40]Loss:0.014187110587954521
[epoch 86, batch 50]Loss:0.04809143766760826
[epoch 86, batch 60]Loss:0.009866012260317802
[epoch 86, batch 70]Loss:0.004611680284142494
[epoch 86, batch 80]Loss:0.0019097873009741306
[epoch 86, batch 90]Loss:0.013705730438232422
[epoch 86, batch 100]Loss:0.028232086449861526
[epoch 86, batch 110]Loss:0.0028860163874924183
[epoch 86, batch 120]Loss:0.03166729211807251
[epoch 86, batch 130]Loss:0.007492877542972565
[epoch 86, batch 140]Loss:0.0014770673587918282
[epoch 86, batch 150]Loss:0.010842985473573208
[epoch 86, batch 160]Loss:0.17721611261367798
[train] MAP:0.9978045055364642, MRR:0.997709049255441
[eval] MAP:0.6821995464852606, MRR:0.6851095993953135
[epoch 87, batch 10]Loss:0.024716030806303024
[epoch 87, batch 20]Loss:0.02824704349040985
[epoch 87, batch 30]Loss:0.04782887175679207
[epoch 87, batch 40]Loss:0.04305252805352211
[epoch 87, batch 50]Loss:0.01622447557747364
[epoch 87, batch 60]Loss:0.04795597866177559
[epoch 87, batch 70]Loss:0.0494973249733448
[epoch 87, batch 80]Loss:0.016915781423449516
[epoch 87, batch 90]Loss:0.04125988110899925
[epoch 87, batch 100]Loss:0.013359290547668934
[epoch 87, batch 110]Loss:0.02262965217232704
[epoch 87, batch 120]Loss:0.00354690570384264
[epoch 87, batch 130]Loss:0.00560760498046875
[epoch 87, batch 140]Loss:0.013918358832597733
[epoch 87, batch 150]Loss:0.003446317743510008
[epoch 87, batch 160]Loss:3.038206705241464e-05
[train] MAP:0.9979776905034637, MRR:0.997709049255441
[eval] MAP:0.6898053665910808, MRR:0.6927154195011337
[epoch 88, batch 10]Loss:0.007758726365864277
[epoch 88, batch 20]Loss:0.009304617531597614
[epoch 88, batch 30]Loss:0.03869166597723961
[epoch 88, batch 40]Loss:0.04079804569482803
[epoch 88, batch 50]Loss:0.008288851007819176
[epoch 88, batch 60]Loss:0.014544052071869373
[epoch 88, batch 70]Loss:0.018203236162662506
[epoch 88, batch 80]Loss:0.0379951149225235
[epoch 88, batch 90]Loss:0.004158480558544397
[epoch 88, batch 100]Loss:0.017122933641076088
[epoch 88, batch 110]Loss:0.003102663904428482
[epoch 88, batch 120]Loss:0.01188972219824791
[epoch 88, batch 130]Loss:0.03282097354531288
[epoch 88, batch 140]Loss:0.01605791226029396
[epoch 88, batch 150]Loss:0.01200072094798088
[epoch 88, batch 160]Loss:0.017662912607192993
[train] MAP:0.9988106926619446, MRR:0.9988545246277205
[eval] MAP:0.677569916855631, MRR:0.6804799697656839
[epoch 89, batch 10]Loss:0.007130016107112169
[epoch 89, batch 20]Loss:0.0080204913392663
[epoch 89, batch 30]Loss:0.013969804160296917
[epoch 89, batch 40]Loss:0.003248512512072921
[epoch 89, batch 50]Loss:0.010471335612237453
[epoch 89, batch 60]Loss:0.0036427422892302275
[epoch 89, batch 70]Loss:0.0027884903829544783
[epoch 89, batch 80]Loss:0.009345585480332375
[epoch 89, batch 90]Loss:0.01628967560827732
[epoch 89, batch 100]Loss:0.03603063523769379
[epoch 89, batch 110]Loss:0.039523717015981674
[epoch 89, batch 120]Loss:0.013030201196670532
[epoch 89, batch 130]Loss:0.009462801739573479
[epoch 89, batch 140]Loss:0.03622586280107498
[epoch 89, batch 150]Loss:0.010170208290219307
[epoch 89, batch 160]Loss:0.03827342018485069
[train] MAP:0.9985681557846506, MRR:0.9985681557846506
[eval] MAP:0.6788926681783825, MRR:0.6827947845804989
[epoch 90, batch 10]Loss:0.005101819988340139
[epoch 90, batch 20]Loss:0.004539860412478447
[epoch 90, batch 30]Loss:0.02898138388991356
[epoch 90, batch 40]Loss:0.011997301131486893
[epoch 90, batch 50]Loss:0.002665035892277956
[epoch 90, batch 60]Loss:0.011261959560215473
[epoch 90, batch 70]Loss:0.007403671741485596
[epoch 90, batch 80]Loss:0.010311819612979889
[epoch 90, batch 90]Loss:0.012010670267045498
[epoch 90, batch 100]Loss:0.00178658461663872
[epoch 90, batch 110]Loss:0.008267244324088097
[epoch 90, batch 120]Loss:0.08149540424346924
[epoch 90, batch 130]Loss:0.007664528675377369
[epoch 90, batch 140]Loss:0.006040811538696289
[epoch 90, batch 150]Loss:0.0041399383917450905
[epoch 90, batch 160]Loss:0.00011134883243357763
[train] MAP:0.9988545246277205, MRR:0.9988545246277205
[eval] MAP:0.6797430083144368, MRR:0.6826530612244898
[epoch 91, batch 10]Loss:0.037709545344114304
[epoch 91, batch 20]Loss:0.003549011889845133
[epoch 91, batch 30]Loss:0.03298041597008705
[epoch 91, batch 40]Loss:0.009100835770368576
[epoch 91, batch 50]Loss:0.04952995106577873
[epoch 91, batch 60]Loss:0.018636945635080338
[epoch 91, batch 70]Loss:0.01563224382698536
[epoch 91, batch 80]Loss:0.0019777482375502586
[epoch 91, batch 90]Loss:0.01021573506295681
[epoch 91, batch 100]Loss:0.0371737964451313
[epoch 91, batch 110]Loss:0.009101787582039833
[epoch 91, batch 120]Loss:0.011089427396655083
[epoch 91, batch 130]Loss:0.00843131821602583
[epoch 91, batch 140]Loss:0.016969915479421616
[epoch 91, batch 150]Loss:0.005237751640379429
[epoch 91, batch 160]Loss:6.16463294136338e-05
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6792233560090701, MRR:0.6821334089191231
[epoch 92, batch 10]Loss:0.05120834708213806
[epoch 92, batch 20]Loss:0.03480715677142143
[epoch 92, batch 30]Loss:0.009044483304023743
[epoch 92, batch 40]Loss:0.003018683521077037
[epoch 92, batch 50]Loss:0.01351209543645382
[epoch 92, batch 60]Loss:0.011534854769706726
[epoch 92, batch 70]Loss:0.0035168942995369434
[epoch 92, batch 80]Loss:0.003220628248527646
[epoch 92, batch 90]Loss:0.006100799888372421
[epoch 92, batch 100]Loss:0.056578170508146286
[epoch 92, batch 110]Loss:0.005988602060824633
[epoch 92, batch 120]Loss:0.027322500944137573
[epoch 92, batch 130]Loss:0.014619171619415283
[epoch 92, batch 140]Loss:0.009965339675545692
[epoch 92, batch 150]Loss:0.04147716611623764
[epoch 92, batch 160]Loss:0.0011216942220926285
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6500566893424035, MRR:0.6509826152683295
[epoch 93, batch 10]Loss:0.00362398661673069
[epoch 93, batch 20]Loss:0.012232753448188305
[epoch 93, batch 30]Loss:0.03952798247337341
[epoch 93, batch 40]Loss:0.011096406728029251
[epoch 93, batch 50]Loss:0.007774569094181061
[epoch 93, batch 60]Loss:0.02972998097538948
[epoch 93, batch 70]Loss:0.001145250746048987
[epoch 93, batch 80]Loss:0.010604589246213436
[epoch 93, batch 90]Loss:0.0009343757992610335
[epoch 93, batch 100]Loss:0.024106761440634727
[epoch 93, batch 110]Loss:0.001901090145111084
[epoch 93, batch 120]Loss:0.013372696004807949
[epoch 93, batch 130]Loss:0.024674803018569946
[epoch 93, batch 140]Loss:0.06128948926925659
[epoch 93, batch 150]Loss:0.06776519864797592
[epoch 93, batch 160]Loss:0.0003009681822732091
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6764361300075585, MRR:0.6793461829176114
[epoch 94, batch 10]Loss:0.02126377820968628
[epoch 94, batch 20]Loss:0.0036712447181344032
[epoch 94, batch 30]Loss:0.00774504616856575
[epoch 94, batch 40]Loss:0.010796956717967987
[epoch 94, batch 50]Loss:0.0009751084144227207
[epoch 94, batch 60]Loss:0.003452520351856947
[epoch 94, batch 70]Loss:0.052608922123909
[epoch 94, batch 80]Loss:0.042723387479782104
[epoch 94, batch 90]Loss:0.005067359656095505
[epoch 94, batch 100]Loss:0.007635058835148811
[epoch 94, batch 110]Loss:0.0020868016872555017
[epoch 94, batch 120]Loss:0.01837949827313423
[epoch 94, batch 130]Loss:0.040930766612291336
[epoch 94, batch 140]Loss:0.010159185156226158
[epoch 94, batch 150]Loss:0.0105164535343647
[epoch 94, batch 160]Loss:0.00019309093477204442
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6905895691609978, MRR:0.6928382464096748
[epoch 95, batch 10]Loss:0.013241294771432877
[epoch 95, batch 20]Loss:0.00854437705129385
[epoch 95, batch 30]Loss:0.013708274811506271
[epoch 95, batch 40]Loss:0.009034624323248863
[epoch 95, batch 50]Loss:0.01722380891442299
[epoch 95, batch 60]Loss:0.007875805720686913
[epoch 95, batch 70]Loss:0.0016665300354361534
[epoch 95, batch 80]Loss:0.017408320680260658
[epoch 95, batch 90]Loss:0.008468062616884708
[epoch 95, batch 100]Loss:0.0308755524456501
[epoch 95, batch 110]Loss:0.03330867737531662
[epoch 95, batch 120]Loss:0.01002995204180479
[epoch 95, batch 130]Loss:0.0164806991815567
[epoch 95, batch 140]Loss:0.0012771215988323092
[epoch 95, batch 150]Loss:0.026682855561375618
[epoch 95, batch 160]Loss:0.056428149342536926
[train] MAP:0.9982817869415808, MRR:0.9982817869415808
[eval] MAP:0.6665154950869235, MRR:0.6694255479969765
[epoch 96, batch 10]Loss:0.007068163715302944
[epoch 96, batch 20]Loss:0.0033495831303298473
[epoch 96, batch 30]Loss:0.02335350215435028
[epoch 96, batch 40]Loss:0.001985105685889721
[epoch 96, batch 50]Loss:0.02475586347281933
[epoch 96, batch 60]Loss:0.06362705677747726
[epoch 96, batch 70]Loss:0.03075161576271057
[epoch 96, batch 80]Loss:0.005235197953879833
[epoch 96, batch 90]Loss:0.0040172552689909935
[epoch 96, batch 100]Loss:0.005456333979964256
[epoch 96, batch 110]Loss:0.040506087243556976
[epoch 96, batch 120]Loss:0.06380216777324677
[epoch 96, batch 130]Loss:0.010505745187401772
[epoch 96, batch 140]Loss:0.013127880170941353
[epoch 96, batch 150]Loss:0.016072086989879608
[epoch 96, batch 160]Loss:0.0031644408591091633
[train] MAP:0.9978822342224405, MRR:0.997709049255441
[eval] MAP:0.6602985638699924, MRR:0.6645313681027966
[epoch 97, batch 10]Loss:0.029917575418949127
[epoch 97, batch 20]Loss:0.028055565431714058
[epoch 97, batch 30]Loss:0.023745324462652206
[epoch 97, batch 40]Loss:0.006090352777391672
[epoch 97, batch 50]Loss:0.028833404183387756
[epoch 97, batch 60]Loss:0.0061228517442941666
[epoch 97, batch 70]Loss:0.003460019128397107
[epoch 97, batch 80]Loss:0.03728916496038437
[epoch 97, batch 90]Loss:0.065163254737854
[epoch 97, batch 100]Loss:0.01953134499490261
[epoch 97, batch 110]Loss:0.003646837780252099
[epoch 97, batch 120]Loss:0.004443229176104069
[epoch 97, batch 130]Loss:0.05018635094165802
[epoch 97, batch 140]Loss:0.006032519042491913
[epoch 97, batch 150]Loss:0.009806591086089611
[epoch 97, batch 160]Loss:0.00010392203694209456
[train] MAP:1.0, MRR:1.0
[eval] MAP:0.6823885109599395, MRR:0.6846371882086167
[epoch 98, batch 10]Loss:0.013485406525433064/home/xh2018/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters

[epoch 98, batch 20]Loss:0.0032377662137150764
[epoch 98, batch 30]Loss:0.013350585475564003
[epoch 98, batch 40]Loss:0.005939341150224209
[epoch 98, batch 50]Loss:0.009033465757966042
[epoch 98, batch 60]Loss:0.009034983813762665
[epoch 98, batch 70]Loss:0.012844733893871307
[epoch 98, batch 80]Loss:0.011399205774068832
[epoch 98, batch 90]Loss:0.0191684290766716
[epoch 98, batch 100]Loss:0.001864830031991005
[epoch 98, batch 110]Loss:0.013533693738281727
[epoch 98, batch 120]Loss:0.004745095502585173
[epoch 98, batch 130]Loss:0.0606657937169075
[epoch 98, batch 140]Loss:0.007008835673332214
[epoch 98, batch 150]Loss:0.0016110908472910523
[epoch 98, batch 160]Loss:5.062803393229842e-05
[train] MAP:0.9994272623138603, MRR:0.9994272623138603
[eval] MAP:0.6850340136054421, MRR:0.6872826908541193
[epoch 99, batch 10]Loss:0.017473462969064713
[epoch 99, batch 20]Loss:0.013725577853620052
[epoch 99, batch 30]Loss:0.0157474298030138
[epoch 99, batch 40]Loss:0.012530283071100712
[epoch 99, batch 50]Loss:0.009940005838871002
[epoch 99, batch 60]Loss:0.008165066130459309
[epoch 99, batch 70]Loss:0.005677967332303524
[epoch 99, batch 80]Loss:0.032603248953819275
[epoch 99, batch 90]Loss:0.0004266875621397048
[epoch 99, batch 100]Loss:0.012184103950858116
[epoch 99, batch 110]Loss:0.031753018498420715
[epoch 99, batch 120]Loss:0.010101838037371635
[epoch 99, batch 130]Loss:0.010846654884517193
[epoch 99, batch 140]Loss:0.005729404743760824
[epoch 99, batch 150]Loss:0.006059624254703522
[epoch 99, batch 160]Loss:1.6107571354950778e-05
[train] MAP:0.9972635866106656, MRR:0.997709049255441
[eval] MAP:0.6643424036281179, MRR:0.6672524565381708
total time:   6785.975976467133
