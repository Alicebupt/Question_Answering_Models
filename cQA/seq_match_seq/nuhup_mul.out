2018-12-03 11:24:22.048870: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
300
Pre-trained: 26838 (92.18%)
(?, 100, 128)
[epoch 0, batch 10]Loss:0.2252453863620758
[epoch 0, batch 20]Loss:0.257650762796402
[epoch 0, batch 30]Loss:0.16103635728359222
[epoch 0, batch 40]Loss:0.2147410660982132
[epoch 0, batch 50]Loss:0.3282092809677124
[epoch 0, batch 60]Loss:0.21336449682712555
[epoch 0, batch 70]Loss:0.1929309368133545
[epoch 0, batch 80]Loss:0.1937446892261505
[epoch 0, batch 90]Loss:0.19306910037994385
[epoch 0, batch 100]Loss:0.18698808550834656
[epoch 0, batch 110]Loss:0.1456281691789627
[epoch 0, batch 120]Loss:0.16218847036361694
[epoch 0, batch 130]Loss:0.14402072131633759
[epoch 0, batch 140]Loss:0.1648181974887848
[epoch 0, batch 150]Loss:0.17335860431194305
[epoch 0, batch 160]Loss:0.4039023518562317
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 1, batch 10]Loss:0.1604289710521698
[epoch 1, batch 20]Loss:0.1854162961244583
[epoch 1, batch 30]Loss:0.2075817584991455
[epoch 1, batch 40]Loss:0.18963520228862762
[epoch 1, batch 50]Loss:0.1010715663433075
[epoch 1, batch 60]Loss:0.19363829493522644
[epoch 1, batch 70]Loss:0.16088920831680298
[epoch 1, batch 80]Loss:0.13816842436790466
[epoch 1, batch 90]Loss:0.11829977482557297
[epoch 1, batch 100]Loss:0.22738923132419586
[epoch 1, batch 110]Loss:0.2506258487701416
[epoch 1, batch 120]Loss:0.1992148607969284
[epoch 1, batch 130]Loss:0.11053458601236343
[epoch 1, batch 140]Loss:0.13686653971672058
[epoch 1, batch 150]Loss:0.16264449059963226
[epoch 1, batch 160]Loss:0.017487067729234695
[train] MAP:0.607650818457862, MRR:0.6124034478852116
[eval] MAP:0.6727891156462585, MRR:0.6750377928949357
[epoch 2, batch 10]Loss:0.341878741979599
[epoch 2, batch 20]Loss:0.16526085138320923
[epoch 2, batch 30]Loss:0.16653487086296082
[epoch 2, batch 40]Loss:0.19576159119606018
[epoch 2, batch 50]Loss:0.1908452957868576
[epoch 2, batch 60]Loss:0.16804510354995728
[epoch 2, batch 70]Loss:0.1268833428621292
[epoch 2, batch 80]Loss:0.27521079778671265
[epoch 2, batch 90]Loss:0.11952443420886993
[epoch 2, batch 100]Loss:0.20412030816078186
[epoch 2, batch 110]Loss:0.1588500291109085
[epoch 2, batch 120]Loss:0.17385008931159973
[epoch 2, batch 130]Loss:0.10733174532651901
[epoch 2, batch 140]Loss:0.14954397082328796
[epoch 2, batch 150]Loss:0.1613759845495224
[epoch 2, batch 160]Loss:0.505294144153595
[train] MAP:0.635688945321877, MRR:0.6407585088863212
[eval] MAP:0.7059240362811792, MRR:0.7111489040060468
[epoch 3, batch 10]Loss:0.22138363122940063
[epoch 3, batch 20]Loss:0.16502995789051056
[epoch 3, batch 30]Loss:0.17829883098602295
[epoch 3, batch 40]Loss:0.23932601511478424
[epoch 3, batch 50]Loss:0.23499663174152374
[epoch 3, batch 60]Loss:0.13614480197429657
[epoch 3, batch 70]Loss:0.09690317511558533
[epoch 3, batch 80]Loss:0.07047426700592041
[epoch 3, batch 90]Loss:0.25106281042099
[epoch 3, batch 100]Loss:0.27180150151252747
[epoch 3, batch 110]Loss:0.175330251455307
[epoch 3, batch 120]Loss:0.20035849511623383
[epoch 3, batch 130]Loss:0.16232338547706604
[epoch 3, batch 140]Loss:0.1575808823108673
[epoch 3, batch 150]Loss:0.1165262758731842
[epoch 3, batch 160]Loss:0.04378440976142883
[train] MAP:0.632639647455855, MRR:0.6380666417614644
[eval] MAP:0.7032123960695389, MRR:0.7054610733182162
[epoch 4, batch 10]Loss:0.15277868509292603
[epoch 4, batch 20]Loss:0.19899147748947144
[epoch 4, batch 30]Loss:0.12313807010650635
[epoch 4, batch 40]Loss:0.21561789512634277
[epoch 4, batch 50]Loss:0.2458389699459076
[epoch 4, batch 60]Loss:0.09881152212619781
[epoch 4, batch 70]Loss:0.08341473340988159
[epoch 4, batch 80]Loss:0.20188570022583008
[epoch 4, batch 90]Loss:0.15705130994319916
[epoch 4, batch 100]Loss:0.27774661779403687
[epoch 4, batch 110]Loss:0.0702403336763382
[epoch 4, batch 120]Loss:0.16077101230621338
[epoch 4, batch 130]Loss:0.17524054646492004
[epoch 4, batch 140]Loss:0.1531292200088501
[epoch 4, batch 150]Loss:0.17157678306102753
[epoch 4, batch 160]Loss:0.04582826793193817
[train] MAP:0.6129422783025864, MRR:0.6176949077299362
[eval] MAP:0.6714663643235073, MRR:0.6737150415721845
[epoch 5, batch 10]Loss:0.16953697800636292
[epoch 5, batch 20]Loss:0.2590705156326294
[epoch 5, batch 30]Loss:0.14500093460083008
[epoch 5, batch 40]Loss:0.1683521568775177
[epoch 5, batch 50]Loss:0.17931969463825226
[epoch 5, batch 60]Loss:0.22270508110523224
[epoch 5, batch 70]Loss:0.19693125784397125
[epoch 5, batch 80]Loss:0.15391044318675995
[epoch 5, batch 90]Loss:0.24584731459617615
[epoch 5, batch 100]Loss:0.17589923739433289
[epoch 5, batch 110]Loss:0.19395239651203156
[epoch 5, batch 120]Loss:0.16860198974609375
[epoch 5, batch 130]Loss:0.24089381098747253
[epoch 5, batch 140]Loss:0.23104941844940186
[epoch 5, batch 150]Loss:0.21162888407707214
[epoch 5, batch 160]Loss:0.023798951879143715
[train] MAP:0.6246515821081103, MRR:0.630072405502623
[eval] MAP:0.6899848828420257, MRR:0.692233560090703
[epoch 6, batch 10]Loss:0.18450863659381866
[epoch 6, batch 20]Loss:0.14454485476016998
[epoch 6, batch 30]Loss:0.15874990820884705
[epoch 6, batch 40]Loss:0.1002441942691803
[epoch 6, batch 50]Loss:0.1634477823972702
[epoch 6, batch 60]Loss:0.13099651038646698
[epoch 6, batch 70]Loss:0.19574517011642456
[epoch 6, batch 80]Loss:0.18649564683437347
[epoch 6, batch 90]Loss:0.07584267109632492
[epoch 6, batch 100]Loss:0.16146749258041382
[epoch 6, batch 110]Loss:0.15602770447731018
[epoch 6, batch 120]Loss:0.17474481463432312
[epoch 6, batch 130]Loss:0.20252451300621033
[epoch 6, batch 140]Loss:0.23573732376098633
[epoch 6, batch 150]Loss:0.1831909567117691
[epoch 6, batch 160]Loss:0.055682551115751266
[train] MAP:0.644995739880676, MRR:0.6526468655341279
[eval] MAP:0.7022203325774754, MRR:0.7074452003023431
[epoch 7, batch 10]Loss:0.1918558031320572
[epoch 7, batch 20]Loss:0.21479520201683044
[epoch 7, batch 30]Loss:0.1258617341518402
[epoch 7, batch 40]Loss:0.16086795926094055
[epoch 7, batch 50]Loss:0.11825019121170044
[epoch 7, batch 60]Loss:0.1780225932598114
[epoch 7, batch 70]Loss:0.14778202772140503
[epoch 7, batch 80]Loss:0.15272140502929688
[epoch 7, batch 90]Loss:0.16440394520759583
[epoch 7, batch 100]Loss:0.08282127231359482
[epoch 7, batch 110]Loss:0.17158803343772888
[epoch 7, batch 120]Loss:0.24516600370407104
[epoch 7, batch 130]Loss:0.20372051000595093
[epoch 7, batch 140]Loss:0.1879824548959732
[epoch 7, batch 150]Loss:0.17749366164207458
[epoch 7, batch 160]Loss:0.2429245412349701
[train] MAP:0.6484873185154393, MRR:0.6559941991220116
[eval] MAP:0.7035430839002268, MRR:0.7087679516250944
[epoch 8, batch 10]Loss:0.21558284759521484
[epoch 8, batch 20]Loss:0.1788564771413803
[epoch 8, batch 30]Loss:0.16491079330444336
[epoch 8, batch 40]Loss:0.170445516705513
[epoch 8, batch 50]Loss:0.21607425808906555
[epoch 8, batch 60]Loss:0.2077053338289261
[epoch 8, batch 70]Loss:0.19923919439315796
[epoch 8, batch 80]Loss:0.10441364347934723
[epoch 8, batch 90]Loss:0.1766694188117981
[epoch 8, batch 100]Loss:0.20830696821212769
[epoch 8, batch 110]Loss:0.1431453377008438
[epoch 8, batch 120]Loss:0.17764437198638916
[epoch 8, batch 130]Loss:0.1932443231344223
[epoch 8, batch 140]Loss:0.1317804604768753
[epoch 8, batch 150]Loss:0.17291486263275146
[epoch 8, batch 160]Loss:0.0511355847120285
[train] MAP:0.6511512099250352, MRR:0.6604465114781041
[eval] MAP:0.6942838246409676, MRR:0.6995086923658351
[epoch 9, batch 10]Loss:0.14408105611801147
[epoch 9, batch 20]Loss:0.3190040588378906
[epoch 9, batch 30]Loss:0.15895476937294006
[epoch 9, batch 40]Loss:0.1903393268585205
[epoch 9, batch 50]Loss:0.21040034294128418
[epoch 9, batch 60]Loss:0.22816014289855957
[epoch 9, batch 70]Loss:0.12891453504562378
[epoch 9, batch 80]Loss:0.26579856872558594
[epoch 9, batch 90]Loss:0.05174092948436737
[epoch 9, batch 100]Loss:0.16659122705459595
[epoch 9, batch 110]Loss:0.1969311237335205
[epoch 9, batch 120]Loss:0.1610720157623291
[epoch 9, batch 130]Loss:0.19852206110954285
[epoch 9, batch 140]Loss:0.23137405514717102
[epoch 9, batch 150]Loss:0.15020976960659027
[epoch 9, batch 160]Loss:0.062444791197776794
[train] MAP:0.6658427337281416, MRR:0.6737016455286697
[eval] MAP:0.7085695389266818, MRR:0.7137944066515497
[epoch 10, batch 10]Loss:0.22189709544181824
[epoch 10, batch 20]Loss:0.2043355405330658
[epoch 10, batch 30]Loss:0.14023640751838684
[epoch 10, batch 40]Loss:0.10055114328861237
[epoch 10, batch 50]Loss:0.17308180034160614
[epoch 10, batch 60]Loss:0.13491740822792053
[epoch 10, batch 70]Loss:0.16504590213298798
[epoch 10, batch 80]Loss:0.1216459572315216
[epoch 10, batch 90]Loss:0.2513849139213562
[epoch 10, batch 100]Loss:0.244617760181427
[epoch 10, batch 110]Loss:0.11205389350652695
[epoch 10, batch 120]Loss:0.14703550934791565
[epoch 10, batch 130]Loss:0.1869845688343048
[epoch 10, batch 140]Loss:0.12937748432159424
[epoch 10, batch 150]Loss:0.12274734675884247
[epoch 10, batch 160]Loss:0.4795709252357483
[train] MAP:0.6570430939097026, MRR:0.6646465878431289
[eval] MAP:0.6903155706727135, MRR:0.6955404383975813
[epoch 11, batch 10]Loss:0.11948536336421967
[epoch 11, batch 20]Loss:0.07337525486946106
[epoch 11, batch 30]Loss:0.11701427400112152
[epoch 11, batch 40]Loss:0.3229801058769226
[epoch 11, batch 50]Loss:0.19024907052516937
[epoch 11, batch 60]Loss:0.15339237451553345
[epoch 11, batch 70]Loss:0.23330244421958923
[epoch 11, batch 80]Loss:0.1279904693365097
[epoch 11, batch 90]Loss:0.2270047962665558
[epoch 11, batch 100]Loss:0.22925502061843872
[epoch 11, batch 110]Loss:0.13984382152557373
[epoch 11, batch 120]Loss:0.1256951242685318
[epoch 11, batch 130]Loss:0.16166549921035767
[epoch 11, batch 140]Loss:0.21756793558597565
[epoch 11, batch 150]Loss:0.17327281832695007
[epoch 11, batch 160]Loss:0.032662369310855865
[train] MAP:0.6476311046008062, MRR:0.6550945959887315
[eval] MAP:0.6863473167044595, MRR:0.6915721844293273
[epoch 12, batch 10]Loss:0.11191704869270325
[epoch 12, batch 20]Loss:0.13860252499580383
[epoch 12, batch 30]Loss:0.09829869866371155
[epoch 12, batch 40]Loss:0.1927947998046875
[epoch 12, batch 50]Loss:0.10651255398988724
[epoch 12, batch 60]Loss:0.14066079258918762
[epoch 12, batch 70]Loss:0.22956576943397522
[epoch 12, batch 80]Loss:0.12185753136873245
[epoch 12, batch 90]Loss:0.1186114251613617
[epoch 12, batch 100]Loss:0.12991680204868317
[epoch 12, batch 110]Loss:0.11706404387950897
[epoch 12, batch 120]Loss:0.1553795039653778
[epoch 12, batch 130]Loss:0.13518363237380981
[epoch 12, batch 140]Loss:0.1290777325630188
[epoch 12, batch 150]Loss:0.15165814757347107
[epoch 12, batch 160]Loss:0.06605413556098938
[train] MAP:0.6444081534397106, MRR:0.6498682199719775
[eval] MAP:0.6810563114134544, MRR:0.686281179138322
[epoch 13, batch 10]Loss:0.13454443216323853
[epoch 13, batch 20]Loss:0.1848408579826355
[epoch 13, batch 30]Loss:0.2281949669122696
[epoch 13, batch 40]Loss:0.13903354108333588
[epoch 13, batch 50]Loss:0.21731814742088318
[epoch 13, batch 60]Loss:0.16395072638988495
[epoch 13, batch 70]Loss:0.09910089522600174
[epoch 13, batch 80]Loss:0.14816831052303314
[epoch 13, batch 90]Loss:0.20680350065231323
[epoch 13, batch 100]Loss:0.1601533442735672
[epoch 13, batch 110]Loss:0.1275421380996704
[epoch 13, batch 120]Loss:0.2638359069824219
[epoch 13, batch 130]Loss:0.04098031297326088
[epoch 13, batch 140]Loss:0.16111868619918823
[epoch 13, batch 150]Loss:0.04631097614765167
[epoch 13, batch 160]Loss:0.05967061221599579
[train] MAP:0.7010224642686972, MRR:0.7113037341616861
[eval] MAP:0.6900510204081634, MRR:0.6952758881330311
[epoch 14, batch 10]Loss:0.1497628092765808
[epoch 14, batch 20]Loss:0.12779787182807922
[epoch 14, batch 30]Loss:0.0991797149181366
[epoch 14, batch 40]Loss:0.17707738280296326
[epoch 14, batch 50]Loss:0.17770598828792572
[epoch 14, batch 60]Loss:0.18281544744968414
[epoch 14, batch 70]Loss:0.22042515873908997
[epoch 14, batch 80]Loss:0.14577245712280273
[epoch 14, batch 90]Loss:0.13960465788841248
[epoch 14, batch 100]Loss:0.20347389578819275
[epoch 14, batch 110]Loss:0.18494917452335358
[epoch 14, batch 120]Loss:0.14409856498241425
[epoch 14, batch 130]Loss:0.18250560760498047
[epoch 14, batch 140]Loss:0.13602657616138458
[epoch 14, batch 150]Loss:0.215741366147995
[epoch 14, batch 160]Loss:0.039691660553216934
[train] MAP:0.6908204192728378, MRR:0.7010062328848035
[eval] MAP:0.680791761148904, MRR:0.6860166288737718
[epoch 15, batch 10]Loss:0.17637021839618683
[epoch 15, batch 20]Loss:0.09550473093986511
[epoch 15, batch 30]Loss:0.14738141000270844
[epoch 15, batch 40]Loss:0.18707552552223206
[epoch 15, batch 50]Loss:0.16363520920276642
[epoch 15, batch 60]Loss:0.14002719521522522
[epoch 15, batch 70]Loss:0.17784523963928223
[epoch 15, batch 80]Loss:0.14722663164138794
[epoch 15, batch 90]Loss:0.16278111934661865
[epoch 15, batch 100]Loss:0.12185720354318619
[epoch 15, batch 110]Loss:0.1511400043964386
[epoch 15, batch 120]Loss:0.1466750204563141
[epoch 15, batch 130]Loss:0.15834492444992065
[epoch 15, batch 140]Loss:0.08748788386583328
[epoch 15, batch 150]Loss:0.10455766320228577
[epoch 15, batch 160]Loss:0.316788911819458
[train] MAP:0.8026548562076015, MRR:0.8116913229184884
[eval] MAP:0.7127456538170823, MRR:0.7179705215419502
[epoch 16, batch 10]Loss:0.08914735913276672
[epoch 16, batch 20]Loss:0.23281753063201904
[epoch 16, batch 30]Loss:0.17882105708122253
[epoch 16, batch 40]Loss:0.06115425378084183
[epoch 16, batch 50]Loss:0.16407273709774017
[epoch 16, batch 60]Loss:0.11572587490081787
[epoch 16, batch 70]Loss:0.24741247296333313
[epoch 16, batch 80]Loss:0.146610289812088
[epoch 16, batch 90]Loss:0.10290850698947906
[epoch 16, batch 100]Loss:0.16675129532814026
[epoch 16, batch 110]Loss:0.10263696312904358
[epoch 16, batch 120]Loss:0.10659800469875336
[epoch 16, batch 130]Loss:0.11910803616046906
[epoch 16, batch 140]Loss:0.08456829190254211
[epoch 16, batch 150]Loss:0.12843167781829834
[epoch 16, batch 160]Loss:0.011423398740589619
[train] MAP:0.719066523521731, MRR:0.7316094752578054
[eval] MAP:0.6854497354497354, MRR:0.6876984126984127
[epoch 17, batch 10]Loss:0.08136383444070816
[epoch 17, batch 20]Loss:0.12806403636932373
[epoch 17, batch 30]Loss:0.09354542195796967
[epoch 17, batch 40]Loss:0.12543703615665436
[epoch 17, batch 50]Loss:0.09893308579921722
[epoch 17, batch 60]Loss:0.1591133326292038
[epoch 17, batch 70]Loss:0.10152331739664078
[epoch 17, batch 80]Loss:0.10065765678882599
[epoch 17, batch 90]Loss:0.11788200587034225
[epoch 17, batch 100]Loss:0.10062183439731598
[epoch 17, batch 110]Loss:0.15153822302818298
[epoch 17, batch 120]Loss:0.10156430304050446
[epoch 17, batch 130]Loss:0.155053049325943
[epoch 17, batch 140]Loss:0.06335711479187012
[epoch 17, batch 150]Loss:0.08732116967439651
[epoch 17, batch 160]Loss:0.044967737048864365
[train] MAP:0.8229637493673417, MRR:0.8325746300731138
[eval] MAP:0.7026360544217688, MRR:0.7078609221466365
[epoch 18, batch 10]Loss:0.125727117061615
[epoch 18, batch 20]Loss:0.05638511851429939
[epoch 18, batch 30]Loss:0.1154899150133133
[epoch 18, batch 40]Loss:0.15898337960243225
[epoch 18, batch 50]Loss:0.21371732652187347
[epoch 18, batch 60]Loss:0.08307811617851257
[epoch 18, batch 70]Loss:0.07440506666898727
[epoch 18, batch 80]Loss:0.14535337686538696
[epoch 18, batch 90]Loss:0.1060553789138794
[epoch 18, batch 100]Loss:0.10057256370782852
[epoch 18, batch 110]Loss:0.15291602909564972
[epoch 18, batch 120]Loss:0.10999222099781036
[epoch 18, batch 130]Loss:0.0960550457239151
[epoch 18, batch 140]Loss:0.10151108354330063
[epoch 18, batch 150]Loss:0.10009612143039703
[epoch 18, batch 160]Loss:0.020526619628071785
[train] MAP:0.76569310795023, MRR:0.7777783677754949
[eval] MAP:0.674867724867725, MRR:0.6771164021164021
[epoch 19, batch 10]Loss:0.11361554265022278
[epoch 19, batch 20]Loss:0.11555411666631699
[epoch 19, batch 30]Loss:0.18347249925136566
[epoch 19, batch 40]Loss:0.13297662138938904
[epoch 19, batch 50]Loss:0.08856327831745148
[epoch 19, batch 60]Loss:0.13981789350509644
[epoch 19, batch 70]Loss:0.05732688307762146
[epoch 19, batch 80]Loss:0.0719451755285263
[epoch 19, batch 90]Loss:0.08224543184041977
[epoch 19, batch 100]Loss:0.13979537785053253
[epoch 19, batch 110]Loss:0.12179239839315414
[epoch 19, batch 120]Loss:0.09293703734874725
[epoch 19, batch 130]Loss:0.09587420523166656
[epoch 19, batch 140]Loss:0.12115651369094849
[epoch 19, batch 150]Loss:0.12334135174751282
[epoch 19, batch 160]Loss:0.45242512226104736
[train] MAP:0.8815257994834361, MRR:0.8903893505217539
[eval] MAP:0.7087868480725624, MRR:0.7140117157974303
[epoch 20, batch 10]Loss:0.09196208417415619
[epoch 20, batch 20]Loss:0.09090244024991989
[epoch 20, batch 30]Loss:0.10413551330566406
[epoch 20, batch 40]Loss:0.07579635083675385
[epoch 20, batch 50]Loss:0.10514316707849503
[epoch 20, batch 60]Loss:0.050977133214473724
[epoch 20, batch 70]Loss:0.15566520392894745
[epoch 20, batch 80]Loss:0.0923502966761589
[epoch 20, batch 90]Loss:0.05802011862397194
[epoch 20, batch 100]Loss:0.07601992040872574
[epoch 20, batch 110]Loss:0.11594732105731964
[epoch 20, batch 120]Loss:0.10424678027629852
[epoch 20, batch 130]Loss:0.06700458377599716
[epoch 20, batch 140]Loss:0.14130422472953796
[epoch 20, batch 150]Loss:0.0856010764837265
[epoch 20, batch 160]Loss:0.28600504994392395
[train] MAP:0.9189802703203321, MRR:0.9260499575741136
[eval] MAP:0.6910619803476946, MRR:0.6962868480725622
[epoch 21, batch 10]Loss:0.08102038502693176
[epoch 21, batch 20]Loss:0.0722554475069046
[epoch 21, batch 30]Loss:0.13223949074745178
[epoch 21, batch 40]Loss:0.06044446676969528
[epoch 21, batch 50]Loss:0.08166100084781647
[epoch 21, batch 60]Loss:0.03978966921567917
[epoch 21, batch 70]Loss:0.10728234052658081
[epoch 21, batch 80]Loss:0.07414348423480988
[epoch 21, batch 90]Loss:0.052543073892593384
[epoch 21, batch 100]Loss:0.09836477041244507
[epoch 21, batch 110]Loss:0.06634518504142761
[epoch 21, batch 120]Loss:0.05134459584951401
[epoch 21, batch 130]Loss:0.12646207213401794
[epoch 21, batch 140]Loss:0.09778079390525818
[epoch 21, batch 150]Loss:0.11645479500293732
[epoch 21, batch 160]Loss:0.014263124205172062
[train] MAP:0.9404094378321181, MRR:0.9447884843932954
[eval] MAP:0.6875661375661376, MRR:0.6927910052910053
[epoch 22, batch 10]Loss:0.0814414918422699
[epoch 22, batch 20]Loss:0.12975147366523743
[epoch 22, batch 30]Loss:0.06297585368156433
[epoch 22, batch 40]Loss:0.0626596063375473
[epoch 22, batch 50]Loss:0.0337364599108696
[epoch 22, batch 60]Loss:0.06096865236759186
[epoch 22, batch 70]Loss:0.05710180848836899
[epoch 22, batch 80]Loss:0.03401115909218788
[epoch 22, batch 90]Loss:0.1091235876083374
[epoch 22, batch 100]Loss:0.09648193418979645
[epoch 22, batch 110]Loss:0.09409224987030029
[epoch 22, batch 120]Loss:0.1664862036705017
[epoch 22, batch 130]Loss:0.10551353543996811
[epoch 22, batch 140]Loss:0.050827402621507645
[epoch 22, batch 150]Loss:0.09941922128200531
[epoch 22, batch 160]Loss:0.019657675176858902
[train] MAP:0.9587951599119985, MRR:0.9600338187967054
[eval] MAP:0.6874244142101285, MRR:0.6926492819349962
[epoch 23, batch 10]Loss:0.045766301453113556
[epoch 23, batch 20]Loss:0.028800416737794876
[epoch 23, batch 30]Loss:0.04940415173768997
[epoch 23, batch 40]Loss:0.051765069365501404
[epoch 23, batch 50]Loss:0.12264052778482437
[epoch 23, batch 60]Loss:0.043863557279109955
[epoch 23, batch 70]Loss:0.05164250731468201
[epoch 23, batch 80]Loss:0.04387906193733215
[epoch 23, batch 90]Loss:0.14466971158981323
[epoch 23, batch 100]Loss:0.055309515446424484
[epoch 23, batch 110]Loss:0.034376759082078934
[epoch 23, batch 120]Loss:0.038901928812265396
[epoch 23, batch 130]Loss:0.07758595049381256
[epoch 23, batch 140]Loss:0.09169162809848785
[epoch 23, batch 150]Loss:0.0873802974820137
[epoch 23, batch 160]Loss:0.31415891647338867
[train] MAP:0.9749040605569815, MRR:0.9762267705566675
[eval] MAP:0.7075963718820861, MRR:0.7128212396069539
[epoch 24, batch 10]Loss:0.06279918551445007
[epoch 24, batch 20]Loss:0.07675182819366455
[epoch 24, batch 30]Loss:0.031141597777605057
[epoch 24, batch 40]Loss:0.044665753841400146
[epoch 24, batch 50]Loss:0.0332493893802166
[epoch 24, batch 60]Loss:0.058651309460401535
[epoch 24, batch 70]Loss:0.07402792572975159
[epoch 24, batch 80]Loss:0.12476392090320587
[epoch 24, batch 90]Loss:0.04489941522479057
[epoch 24, batch 100]Loss:0.08901012688875198
[epoch 24, batch 110]Loss:0.08904938399791718
[epoch 24, batch 120]Loss:0.087354376912117
[epoch 24, batch 130]Loss:0.1022758036851883
[epoch 24, batch 140]Loss:0.08049917221069336
[epoch 24, batch 150]Loss:0.06661023944616318
[epoch 24, batch 160]Loss:0.05267905816435814
[train] MAP:0.969856761690196, MRR:0.9711086026327587
[eval] MAP:0.7051587301587301, MRR:0.710383597883598
[epoch 25, batch 10]Loss:0.0652996227145195
[epoch 25, batch 20]Loss:0.08764362335205078
[epoch 25, batch 30]Loss:0.08773556351661682
[epoch 25, batch 40]Loss:0.07743675261735916
[epoch 25, batch 50]Loss:0.07953375577926636
[epoch 25, batch 60]Loss:0.01989225298166275
[epoch 25, batch 70]Loss:0.013357357122004032
[epoch 25, batch 80]Loss:0.026374854147434235
[epoch 25, batch 90]Loss:0.055809296667575836
[epoch 25, batch 100]Loss:0.07062029838562012
[epoch 25, batch 110]Loss:0.03839637711644173
[epoch 25, batch 120]Loss:0.05963408201932907
[epoch 25, batch 130]Loss:0.060041919350624084
[epoch 25, batch 140]Loss:0.0585264153778553
[epoch 25, batch 150]Loss:0.06416556239128113
[epoch 25, batch 160]Loss:0.00943402573466301
[train] MAP:0.9828901148488777, MRR:0.98362599599713
[eval] MAP:0.6941798941798942, MRR:0.6994047619047619
[epoch 26, batch 10]Loss:0.1086723804473877
[epoch 26, batch 20]Loss:0.04368794709444046
[epoch 26, batch 30]Loss:0.09597328305244446
[epoch 26, batch 40]Loss:0.08402372896671295
[epoch 26, batch 50]Loss:0.10474143922328949
[epoch 26, batch 60]Loss:0.06370022147893906
[epoch 26, batch 70]Loss:0.06507676839828491
[epoch 26, batch 80]Loss:0.02156984806060791
[epoch 26, batch 90]Loss:0.05671212822198868
[epoch 26, batch 100]Loss:0.04606981575489044
[epoch 26, batch 110]Loss:0.06566271185874939
[epoch 26, batch 120]Loss:0.054112762212753296
[epoch 26, batch 130]Loss:0.09417909383773804
[epoch 26, batch 140]Loss:0.07536479830741882
[epoch 26, batch 150]Loss:0.05519650876522064
[epoch 26, batch 160]Loss:0.03440709039568901
[train] MAP:0.98292916514566, MRR:0.9830246214266832
[eval] MAP:0.6957671957671958, MRR:0.7009920634920636
[epoch 27, batch 10]Loss:0.05141551420092583
[epoch 27, batch 20]Loss:0.022272344678640366
[epoch 27, batch 30]Loss:0.11439204961061478
[epoch 27, batch 40]Loss:0.06342492252588272
[epoch 27, batch 50]Loss:0.07859110832214355
[epoch 27, batch 60]Loss:0.06069750338792801
[epoch 27, batch 70]Loss:0.05292565003037453
[epoch 27, batch 80]Loss:0.04854043573141098
[epoch 27, batch 90]Loss:0.08705408871173859
[epoch 27, batch 100]Loss:0.037718966603279114
[epoch 27, batch 110]Loss:0.06959491223096848
[epoch 27, batch 120]Loss:0.115658700466156
[epoch 27, batch 130]Loss:0.1254243403673172
[epoch 27, batch 140]Loss:0.10508694499731064
[epoch 27, batch 150]Loss:0.10121078789234161
[epoch 27, batch 160]Loss:0.06806761771440506
[train] MAP:0.9863647520864016, MRR:0.9866988490699832
[eval] MAP:0.700321239606954, MRR:0.7052815570672715
[epoch 28, batch 10]Loss:0.056487493216991425
[epoch 28, batch 20]Loss:0.10799740254878998
[epoch 28, batch 30]Loss:0.03638933598995209
[epoch 28, batch 40]Loss:0.039708130061626434
[epoch 28, batch 50]Loss:0.07226383686065674
[epoch 28, batch 60]Loss:0.051874224096536636
[epoch 28, batch 70]Loss:0.0400741845369339
[epoch 28, batch 80]Loss:0.06314096599817276
[epoch 28, batch 90]Loss:0.061349187046289444
[epoch 28, batch 100]Loss:0.05787116289138794
[epoch 28, batch 110]Loss:0.03518463298678398
[epoch 28, batch 120]Loss:0.04070677608251572
[epoch 28, batch 130]Loss:0.04865497350692749
[epoch 28, batch 140]Loss:0.040086500346660614
[epoch 28, batch 150]Loss:0.032421838492155075
[epoch 28, batch 160]Loss:0.5253767371177673
[train] MAP:0.9875956136265415, MRR:0.9878819824696113
[eval] MAP:0.6859126984126984, MRR:0.6881613756613757
[epoch 29, batch 10]Loss:0.08237230777740479
[epoch 29, batch 20]Loss:0.033279355615377426
[epoch 29, batch 30]Loss:0.05363885313272476
[epoch 29, batch 40]Loss:0.016654832288622856
[epoch 29, batch 50]Loss:0.05097828805446625
[epoch 29, batch 60]Loss:0.057892028242349625
[epoch 29, batch 70]Loss:0.029397157952189445
[epoch 29, batch 80]Loss:0.07338529080152512
[epoch 29, batch 90]Loss:0.03939476236701012
[epoch 29, batch 100]Loss:0.06967928260564804
[epoch 29, batch 110]Loss:0.03799604997038841
[epoch 29, batch 120]Loss:0.04080898314714432
[epoch 29, batch 130]Loss:0.06185466796159744
[epoch 29, batch 140]Loss:0.057936713099479675
[epoch 29, batch 150]Loss:0.03507978469133377
[epoch 29, batch 160]Loss:0.019357990473508835
[train] MAP:0.9904407352860961, MRR:0.9904407352860961
[eval] MAP:0.6924603174603174, MRR:0.6976851851851852
[epoch 30, batch 10]Loss:0.047980256378650665
[epoch 30, batch 20]Loss:0.08673204481601715
[epoch 30, batch 30]Loss:0.07364773005247116
[epoch 30, batch 40]Loss:0.06604618579149246
[epoch 30, batch 50]Loss:0.11391966044902802
[epoch 30, batch 60]Loss:0.062174707651138306
[epoch 30, batch 70]Loss:0.07980480790138245
[epoch 30, batch 80]Loss:0.028815260156989098
[epoch 30, batch 90]Loss:0.03320735692977905
[epoch 30, batch 100]Loss:0.03648267686367035
[epoch 30, batch 110]Loss:0.04233907163143158
[epoch 30, batch 120]Loss:0.05743350833654404
[epoch 30, batch 130]Loss:0.05397670343518257
[epoch 30, batch 140]Loss:0.031068282201886177
[epoch 30, batch 150]Loss:0.0773085504770279
[epoch 30, batch 160]Loss:0.0032929773442447186
[train] MAP:0.9898865643711005, MRR:0.9898865643711005
[eval] MAP:0.6921957671957673, MRR:0.6974206349206349
[epoch 31, batch 10]Loss:0.05411587283015251
[epoch 31, batch 20]Loss:0.04911341890692711
[epoch 31, batch 30]Loss:0.012291943654417992
[epoch 31, batch 40]Loss:0.02578805759549141
[epoch 31, batch 50]Loss:0.08776894211769104
[epoch 31, batch 60]Loss:0.0868372842669487
[epoch 31, batch 70]Loss:0.09117402881383896
[epoch 31, batch 80]Loss:0.05593665689229965
[epoch 31, batch 90]Loss:0.028768476098775864
[epoch 31, batch 100]Loss:0.020252391695976257
[epoch 31, batch 110]Loss:0.0486159548163414
[epoch 31, batch 120]Loss:0.03933558613061905
[epoch 31, batch 130]Loss:0.04893224686384201
[epoch 31, batch 140]Loss:0.032629966735839844
[epoch 31, batch 150]Loss:0.0332372784614563
[epoch 31, batch 160]Loss:0.0015653569716960192
[train] MAP:0.9882065338250905, MRR:0.9882065338250905
[eval] MAP:0.692857142857143, MRR:0.6980820105820106
[epoch 32, batch 10]Loss:0.04302239418029785
[epoch 32, batch 20]Loss:0.015989094972610474
[epoch 32, batch 30]Loss:0.03871583938598633
[epoch 32, batch 40]Loss:0.021258074790239334
[epoch 32, batch 50]Loss:0.012888403609395027
[epoch 32, batch 60]Loss:0.046109288930892944
[epoch 32, batch 70]Loss:0.017098398879170418
[epoch 32, batch 80]Loss:0.03898975998163223
[epoch 32, batch 90]Loss:0.03542550653219223
[epoch 32, batch 100]Loss:0.04226633161306381
[epoch 32, batch 110]Loss:0.0810793861746788
[epoch 32, batch 120]Loss:0.036518946290016174
[epoch 32, batch 130]Loss:0.013592902570962906
[epoch 32, batch 140]Loss:0.03671696037054062
[epoch 32, batch 150]Loss:0.013485999777913094
[epoch 32, batch 160]Loss:0.07129806280136108
[train] MAP:0.9915065938261814, MRR:0.9915065938261814
[eval] MAP:0.6940381708238852, MRR:0.6962868480725624
[epoch 33, batch 10]Loss:0.022657789289951324
[epoch 33, batch 20]Loss:0.005942372605204582
[epoch 33, batch 30]Loss:0.06583085656166077
[epoch 33, batch 40]Loss:0.018115686252713203
[epoch 33, batch 50]Loss:0.04643862694501877
[epoch 33, batch 60]Loss:0.027182765305042267
[epoch 33, batch 70]Loss:0.05274682119488716
[epoch 33, batch 80]Loss:0.06824249029159546
[epoch 33, batch 90]Loss:0.04195521026849747
[epoch 33, batch 100]Loss:0.030946146696805954
[epoch 33, batch 110]Loss:0.025830555707216263
[epoch 33, batch 120]Loss:0.012166507542133331
[epoch 33, batch 130]Loss:0.01950233057141304
[epoch 33, batch 140]Loss:0.02396896854043007
[epoch 33, batch 150]Loss:0.02999919280409813
[epoch 33, batch 160]Loss:0.0044525908306241035
[train] MAP:0.9917007581956037, MRR:0.9917007581956037
[eval] MAP:0.7115646258503402, MRR:0.7167894935752078
[epoch 34, batch 10]Loss:0.0275997593998909
[epoch 34, batch 20]Loss:0.04395429790019989
[epoch 34, batch 30]Loss:0.0536617636680603
[epoch 34, batch 40]Loss:0.005851765628904104
[epoch 34, batch 50]Loss:0.015632975846529007
[epoch 34, batch 60]Loss:0.05550604313611984
[epoch 34, batch 70]Loss:0.06211552023887634
[epoch 34, batch 80]Loss:0.07120417058467865
[epoch 34, batch 90]Loss:0.009272510185837746
[epoch 34, batch 100]Loss:0.018219534307718277
[epoch 34, batch 110]Loss:0.06488045305013657
[epoch 34, batch 120]Loss:0.01710512489080429
[epoch 34, batch 130]Loss:0.019631318747997284
[epoch 34, batch 140]Loss:0.037204302847385406
[epoch 34, batch 150]Loss:0.050110116600990295
[epoch 34, batch 160]Loss:0.040191736072301865
[train] MAP:0.9912038610492219, MRR:0.9912038610492219
[eval] MAP:0.6963529856386999, MRR:0.7015778533635676
[epoch 35, batch 10]Loss:0.03656979650259018
[epoch 35, batch 20]Loss:0.04625093936920166
[epoch 35, batch 30]Loss:0.14632178843021393
[epoch 35, batch 40]Loss:0.005931724328547716
[epoch 35, batch 50]Loss:0.03700276091694832
[epoch 35, batch 60]Loss:0.05842376500368118
[epoch 35, batch 70]Loss:0.08921734988689423
[epoch 35, batch 80]Loss:0.04446948319673538
[epoch 35, batch 90]Loss:0.08797077089548111
[epoch 35, batch 100]Loss:0.017235659062862396
[epoch 35, batch 110]Loss:0.04769144207239151
[epoch 35, batch 120]Loss:0.024415062740445137
[epoch 35, batch 130]Loss:0.011259675025939941
[epoch 35, batch 140]Loss:0.04894452542066574
[epoch 35, batch 150]Loss:0.08039931207895279
[epoch 35, batch 160]Loss:0.0031994967721402645
[train] MAP:0.9870515128247087, MRR:0.9870515128247087
[eval] MAP:0.6999244142101284, MRR:0.704884731670446
[epoch 36, batch 10]Loss:0.024795548990368843
[epoch 36, batch 20]Loss:0.017096899449825287
[epoch 36, batch 30]Loss:0.03669683635234833
[epoch 36, batch 40]Loss:0.037139229476451874
[epoch 36, batch 50]Loss:0.008378801867365837
[epoch 36, batch 60]Loss:0.01224085409194231
[epoch 36, batch 70]Loss:0.05390036851167679
[epoch 36, batch 80]Loss:0.016351044178009033
[epoch 36, batch 90]Loss:0.02480180189013481
[epoch 36, batch 100]Loss:0.018472570925951004
[epoch 36, batch 110]Loss:0.036707162857055664
[epoch 36, batch 120]Loss:0.0228312686085701
[epoch 36, batch 130]Loss:0.026506181806325912
[epoch 36, batch 140]Loss:0.013466841541230679
[epoch 36, batch 150]Loss:0.024751851335167885
[epoch 36, batch 160]Loss:0.08490468561649323
[train] MAP:0.9915943640170445, MRR:0.9923493364215014
[eval] MAP:0.7011904761904761, MRR:0.7064153439153439
[epoch 37, batch 10]Loss:0.05045204609632492
[epoch 37, batch 20]Loss:0.03200259059667587
[epoch 37, batch 30]Loss:0.036620523780584335
[epoch 37, batch 40]Loss:0.022783100605010986
[epoch 37, batch 50]Loss:0.05011921375989914
[epoch 37, batch 60]Loss:0.03233485296368599
[epoch 37, batch 70]Loss:0.021805766969919205
[epoch 37, batch 80]Loss:0.04126163199543953
[epoch 37, batch 90]Loss:0.025982514023780823
[epoch 37, batch 100]Loss:0.02466747723519802
[epoch 37, batch 110]Loss:0.01567774824798107
[epoch 37, batch 120]Loss:0.056941721588373184
[epoch 37, batch 130]Loss:0.08051428943872452
[epoch 37, batch 140]Loss:0.015859784558415413
[epoch 37, batch 150]Loss:0.009223215281963348
[epoch 37, batch 160]Loss:0.006922461092472076
[train] MAP:0.9913470454707568, MRR:0.9913470454707568
[eval] MAP:0.7066704459561604, MRR:0.711895313681028
[epoch 38, batch 10]Loss:0.022352613508701324
[epoch 38, batch 20]Loss:0.03154251351952553
[epoch 38, batch 30]Loss:0.03940960019826889
[epoch 38, batch 40]Loss:0.02467953786253929
[epoch 38, batch 50]Loss:0.021546967327594757
[epoch 38, batch 60]Loss:0.00442985724657774
[epoch 38, batch 70]Loss:0.03667213022708893
[epoch 38, batch 80]Loss:0.026944782584905624
[epoch 38, batch 90]Loss:0.020841410383582115
[epoch 38, batch 100]Loss:0.020426221191883087
[epoch 38, batch 110]Loss:0.030592409893870354
[epoch 38, batch 120]Loss:0.01399463601410389
[epoch 38, batch 130]Loss:0.03837701678276062
[epoch 38, batch 140]Loss:0.02994484081864357
[epoch 38, batch 150]Loss:0.053078629076480865
[epoch 38, batch 160]Loss:0.0006209670100361109
[train] MAP:0.9907265796441055, MRR:0.9910129484871754
[eval] MAP:0.6974111866969009, MRR:0.7026360544217686
[epoch 39, batch 10]Loss:0.03870547562837601
[epoch 39, batch 20]Loss:0.02211051434278488
[epoch 39, batch 30]Loss:0.030147600919008255
[epoch 39, batch 40]Loss:0.04568052291870117
[epoch 39, batch 50]Loss:0.02536122314631939
[epoch 39, batch 60]Loss:0.01463989820331335
[epoch 39, batch 70]Loss:0.026373647153377533
[epoch 39, batch 80]Loss:0.037588488310575485
[epoch 39, batch 90]Loss:0.01960816979408264
[epoch 39, batch 100]Loss:0.016721926629543304
[epoch 39, batch 110]Loss:0.06360320001840591
[epoch 39, batch 120]Loss:0.026437822729349136
[epoch 39, batch 130]Loss:0.024802180007100105
[epoch 39, batch 140]Loss:0.03681858628988266
[epoch 39, batch 150]Loss:0.04067166522145271
[epoch 39, batch 160]Loss:0.00035147671587765217
[train] MAP:0.9909079465780498, MRR:0.9911465872806079
[eval] MAP:0.6878968253968255, MRR:0.6901455026455026
[epoch 40, batch 10]Loss:0.058992139995098114
[epoch 40, batch 20]Loss:0.023725202307105064
[epoch 40, batch 30]Loss:0.06554057449102402
[epoch 40, batch 40]Loss:0.02975917048752308
[epoch 40, batch 50]Loss:0.036498863250017166
[epoch 40, batch 60]Loss:0.014426152221858501
[epoch 40, batch 70]Loss:0.038830406963825226
[epoch 40, batch 80]Loss:0.018360111862421036
[epoch 40, batch 90]Loss:0.08532770723104477
[epoch 40, batch 100]Loss:0.0643879622220993
[epoch 40, batch 110]Loss:0.006292096339166164
[epoch 40, batch 120]Loss:0.07445147633552551
[epoch 40, batch 130]Loss:0.016971642151474953
[epoch 40, batch 140]Loss:0.018557945266366005
[epoch 40, batch 150]Loss:0.05053818225860596
[epoch 40, batch 160]Loss:0.0007915684254840016
[train] MAP:0.991117082611928, MRR:0.9915856861733151
[eval] MAP:0.6826058201058202, MRR:0.6848544973544974
[epoch 41, batch 10]Loss:0.017296262085437775
[epoch 41, batch 20]Loss:0.056145280599594116
[epoch 41, batch 30]Loss:0.016295287758111954
[epoch 41, batch 40]Loss:0.05624814331531525
[epoch 41, batch 50]Loss:0.03512270003557205
[epoch 41, batch 60]Loss:0.01587275229394436
[epoch 41, batch 70]Loss:0.020411064848303795
[epoch 41, batch 80]Loss:0.03323102369904518
[epoch 41, batch 90]Loss:0.042071424424648285
[epoch 41, batch 100]Loss:0.054132238030433655
[epoch 41, batch 110]Loss:0.038944121450185776
[epoch 41, batch 120]Loss:0.008816186338663101
[epoch 41, batch 130]Loss:0.02876792475581169
[epoch 41, batch 140]Loss:0.017450515180826187
[epoch 41, batch 150]Loss:0.029840469360351562
[epoch 41, batch 160]Loss:0.00020054602646268904
[train] MAP:0.992794385835623, MRR:0.99326298939701
[eval] MAP:0.7027021919879063, MRR:0.707927059712774
[epoch 42, batch 10]Loss:0.029306288808584213
[epoch 42, batch 20]Loss:0.031954407691955566
[epoch 42, batch 30]Loss:0.02906874194741249
[epoch 42, batch 40]Loss:0.03191845491528511
[epoch 42, batch 50]Loss:0.026504047214984894
[epoch 42, batch 60]Loss:0.02078719437122345
[epoch 42, batch 70]Loss:0.011636030860245228
[epoch 42, batch 80]Loss:0.007718956097960472
[epoch 42, batch 90]Loss:0.017971355468034744
[epoch 42, batch 100]Loss:0.01962311379611492
[epoch 42, batch 110]Loss:0.019083425402641296
[epoch 42, batch 120]Loss:0.08833109587430954
[epoch 42, batch 130]Loss:0.0028600674122571945
[epoch 42, batch 140]Loss:0.01825052499771118
[epoch 42, batch 150]Loss:0.006631947588175535
[epoch 42, batch 160]Loss:0.0030553354881703854
[train] MAP:0.9889510928170723, MRR:0.9889510928170723
[eval] MAP:0.6917894935752078, MRR:0.6940381708238852
[epoch 43, batch 10]Loss:0.03884364664554596
[epoch 43, batch 20]Loss:0.013649477623403072
[epoch 43, batch 30]Loss:0.023502491414546967
[epoch 43, batch 40]Loss:0.059326011687517166
[epoch 43, batch 50]Loss:0.0481373593211174
[epoch 43, batch 60]Loss:0.06058879569172859
[epoch 43, batch 70]Loss:0.024531256407499313
[epoch 43, batch 80]Loss:0.025986485183238983
[epoch 43, batch 90]Loss:0.04172665253281593
[epoch 43, batch 100]Loss:0.0066617149859666824
[epoch 43, batch 110]Loss:0.04156941920518875
[epoch 43, batch 120]Loss:0.008714819326996803
[epoch 43, batch 130]Loss:0.041101012378931046
[epoch 43, batch 140]Loss:0.0021579221356660128
[epoch 43, batch 150]Loss:0.034483134746551514
[epoch 43, batch 160]Loss:0.0024679843336343765
[train] MAP:0.9897778011548262, MRR:0.9899770904925544
[eval] MAP:0.7102418745275889, MRR:0.714805366591081
[epoch 44, batch 10]Loss:0.0063051022589206696
[epoch 44, batch 20]Loss:0.016405632719397545
[epoch 44, batch 30]Loss:0.012464821338653564
[epoch 44, batch 40]Loss:0.0034862447064369917
[epoch 44, batch 50]Loss:0.004215229768306017
[epoch 44, batch 60]Loss:0.012876183725893497
[epoch 44, batch 70]Loss:0.026439491659402847
[epoch 44, batch 80]Loss:0.006144534330815077
[epoch 44, batch 90]Loss:0.03679906576871872
[epoch 44, batch 100]Loss:0.020068522542715073
[epoch 44, batch 110]Loss:0.009403834119439125
[epoch 44, batch 120]Loss:0.00660521537065506
[epoch 44, batch 130]Loss:0.014171194285154343
[epoch 44, batch 140]Loss:0.05177859589457512
[epoch 44, batch 150]Loss:0.012046423740684986
[epoch 44, batch 160]Loss:0.00012990445247851312
[train] MAP:0.993065258529176, MRR:0.9933516273722459
[eval] MAP:0.7155328798185941, MRR:0.7207577475434619
[epoch 45, batch 10]Loss:0.021829163655638695
[epoch 45, batch 20]Loss:0.003461998188868165
[epoch 45, batch 30]Loss:0.043159544467926025
[epoch 45, batch 40]Loss:0.011566678062081337
[epoch 45, batch 50]Loss:0.016867201775312424
[epoch 45, batch 60]Loss:0.011286628432571888
[epoch 45, batch 70]Loss:0.037439193576574326
[epoch 45, batch 80]Loss:0.018314125016331673
[epoch 45, batch 90]Loss:0.04911593347787857
[epoch 45, batch 100]Loss:0.043860673904418945
[epoch 45, batch 110]Loss:0.016985269263386726
[epoch 45, batch 120]Loss:0.04347497969865799
[epoch 45, batch 130]Loss:0.08070676028728485
[epoch 45, batch 140]Loss:0.006831694394350052
[epoch 45, batch 150]Loss:0.05250851437449455
[epoch 45, batch 160]Loss:0.0014875768683850765
[train] MAP:0.9916334143138267, MRR:0.9916334143138267
[eval] MAP:0.7009826152683296, MRR:0.7062074829931974
[epoch 46, batch 10]Loss:0.01692136935889721
[epoch 46, batch 20]Loss:0.015436901710927486
[epoch 46, batch 30]Loss:0.007075567729771137
[epoch 46, batch 40]Loss:0.007818072102963924
[epoch 46, batch 50]Loss:0.06161564216017723
[epoch 46, batch 60]Loss:0.09800080209970474
[epoch 46, batch 70]Loss:0.006905692629516125
[epoch 46, batch 80]Loss:0.06719812750816345
[epoch 46, batch 90]Loss:0.02029271051287651
[epoch 46, batch 100]Loss:0.016755342483520508
[epoch 46, batch 110]Loss:0.010902127251029015
[epoch 46, batch 120]Loss:0.0370156392455101
[epoch 46, batch 130]Loss:0.010169810615479946
[epoch 46, batch 140]Loss:0.0047981408424675465
[epoch 46, batch 150]Loss:0.030992448329925537
[epoch 46, batch 160]Loss:0.0003185727691743523
[train] MAP:0.9938553428244151, MRR:0.9938553428244151
[eval] MAP:0.6943688586545729, MRR:0.6995937263794406
[epoch 47, batch 10]Loss:0.008051503449678421
[epoch 47, batch 20]Loss:0.03115183115005493
[epoch 47, batch 30]Loss:0.020443636924028397
[epoch 47, batch 40]Loss:0.006292521953582764
[epoch 47, batch 50]Loss:0.013587117195129395
[epoch 47, batch 60]Loss:0.010161042213439941
[epoch 47, batch 70]Loss:0.008370516821742058
[epoch 47, batch 80]Loss:0.041397660970687866
[epoch 47, batch 90]Loss:0.005085109733045101
[epoch 47, batch 100]Loss:0.022412864491343498
[epoch 47, batch 110]Loss:0.016196904703974724
[epoch 47, batch 120]Loss:0.06977379322052002
[epoch 47, batch 130]Loss:0.054243139922618866
[epoch 47, batch 140]Loss:0.005417655222117901
[epoch 47, batch 150]Loss:0.0030042659491300583
[epoch 47, batch 160]Loss:0.00081876409240067
[train] MAP:0.9911668473892333, MRR:0.9916525055700313
[eval] MAP:0.7036281179138321, MRR:0.7088529856386998
[epoch 48, batch 10]Loss:0.048228248953819275
[epoch 48, batch 20]Loss:0.01185319572687149
[epoch 48, batch 30]Loss:0.017381159588694572
[epoch 48, batch 40]Loss:0.02252667210996151
[epoch 48, batch 50]Loss:0.11715056002140045
[epoch 48, batch 60]Loss:0.032117027789354324
[epoch 48, batch 70]Loss:0.023687709122896194
[epoch 48, batch 80]Loss:0.019738130271434784
[epoch 48, batch 90]Loss:0.008775584399700165
[epoch 48, batch 100]Loss:0.015644486993551254
[epoch 48, batch 110]Loss:0.012369192205369473
[epoch 48, batch 120]Loss:0.0877922996878624
[epoch 48, batch 130]Loss:0.04386083781719208
[epoch 48, batch 140]Loss:0.01924220100045204
[epoch 48, batch 150]Loss:0.005823402665555477
[epoch 48, batch 160]Loss:0.0011270125396549702
[train] MAP:0.992511612099241, MRR:0.992511612099241
[eval] MAP:0.6941798941798943, MRR:0.6994047619047619
[epoch 49, batch 10]Loss:0.0203266441822052
[epoch 49, batch 20]Loss:0.008451803587377071
[epoch 49, batch 30]Loss:0.04985877126455307
[epoch 49, batch 40]Loss:0.018441390246152878
[epoch 49, batch 50]Loss:0.016832195222377777
[epoch 49, batch 60]Loss:0.017442822456359863
[epoch 49, batch 70]Loss:0.04407105594873428
[epoch 49, batch 80]Loss:0.030083011835813522
[epoch 49, batch 90]Loss:0.028285110369324684
[epoch 49, batch 100]Loss:0.008187979459762573
[epoch 49, batch 110]Loss:0.019402850419282913
[epoch 49, batch 120]Loss:0.0047651976346969604
[epoch 49, batch 130]Loss:0.06801630556583405
[epoch 49, batch 140]Loss:0.028183437883853912
[epoch 49, batch 150]Loss:0.01713811419904232
[epoch 49, batch 160]Loss:0.03428292274475098
[train] MAP:0.9893901917097793, MRR:0.9896765605528491
[eval] MAP:0.6961640211640212, MRR:0.7013888888888888
[epoch 50, batch 10]Loss:0.029761122539639473
[epoch 50, batch 20]Loss:0.06216865032911301
[epoch 50, batch 30]Loss:0.012595497071743011
[epoch 50, batch 40]Loss:0.011308765970170498
[epoch 50, batch 50]Loss:0.011379461735486984
[epoch 50, batch 60]Loss:0.01780378259718418
[epoch 50, batch 70]Loss:0.016888508573174477
[epoch 50, batch 80]Loss:0.024953629821538925
[epoch 50, batch 90]Loss:0.00474140141159296
[epoch 50, batch 100]Loss:0.057578667998313904
[epoch 50, batch 110]Loss:0.012580872513353825
[epoch 50, batch 120]Loss:0.024353139102458954
[epoch 50, batch 130]Loss:0.014896998181939125
[epoch 50, batch 140]Loss:0.01359718106687069
[epoch 50, batch 150]Loss:0.009583672508597374
[epoch 50, batch 160]Loss:0.005692006088793278
[train] MAP:0.9922061519999664, MRR:0.9922061519999664
[eval] MAP:0.6970143613000755, MRR:0.7022392290249433
[epoch 51, batch 10]Loss:0.03357163071632385
[epoch 51, batch 20]Loss:0.006155814044177532
[epoch 51, batch 30]Loss:0.013172278180718422
[epoch 51, batch 40]Loss:0.008897142484784126
[epoch 51, batch 50]Loss:0.005329830106347799
[epoch 51, batch 60]Loss:0.006372418720275164
[epoch 51, batch 70]Loss:0.01772715337574482
[epoch 51, batch 80]Loss:0.004574399907141924
[epoch 51, batch 90]Loss:0.06905177980661392
[epoch 51, batch 100]Loss:0.04472682625055313
[epoch 51, batch 110]Loss:0.013818053528666496
[epoch 51, batch 120]Loss:0.018659595400094986
[epoch 51, batch 130]Loss:0.03815722092986107
[epoch 51, batch 140]Loss:0.004863540641963482
[epoch 51, batch 150]Loss:0.01274033635854721
[epoch 51, batch 160]Loss:0.03753950074315071
[train] MAP:0.9934852661656786, MRR:0.9934852661656786
[eval] MAP:0.7052154195011338, MRR:0.7101757369614512
[epoch 52, batch 10]Loss:0.05790180340409279
[epoch 52, batch 20]Loss:0.008342189714312553
[epoch 52, batch 30]Loss:0.03221128508448601
[epoch 52, batch 40]Loss:0.02267294004559517
[epoch 52, batch 50]Loss:0.008655434474349022
[epoch 52, batch 60]Loss:0.016918206587433815
[epoch 52, batch 70]Loss:0.009168161079287529
[epoch 52, batch 80]Loss:0.059637393802404404
[epoch 52, batch 90]Loss:0.007480963133275509
[epoch 52, batch 100]Loss:0.07109998911619186
[epoch 52, batch 110]Loss:0.06956911832094193
[epoch 52, batch 120]Loss:0.03609192371368408
[epoch 52, batch 130]Loss:0.008999072015285492
[epoch 52, batch 140]Loss:0.003830244764685631
[epoch 52, batch 150]Loss:0.006201691459864378
[epoch 52, batch 160]Loss:0.0016132910968735814
[train] MAP:0.9908020768845512, MRR:0.9912706804459382
[eval] MAP:0.6799603174603175, MRR:0.6822089947089947
[epoch 53, batch 10]Loss:0.022590328007936478
[epoch 53, batch 20]Loss:0.011227216571569443
[epoch 53, batch 30]Loss:0.009075669571757317
[epoch 53, batch 40]Loss:0.01305585727095604
[epoch 53, batch 50]Loss:0.022031452506780624
[epoch 53, batch 60]Loss:0.015649551525712013
[epoch 53, batch 70]Loss:0.007523979991674423
[epoch 53, batch 80]Loss:0.016495635733008385
[epoch 53, batch 90]Loss:0.004786858335137367
[epoch 53, batch 100]Loss:0.010003913193941116
[epoch 53, batch 110]Loss:0.018936293199658394
[epoch 53, batch 120]Loss:0.06239340826869011
[epoch 53, batch 130]Loss:0.0035005914978682995
[epoch 53, batch 140]Loss:0.030452625826001167
[epoch 53, batch 150]Loss:0.054312899708747864
[epoch 53, batch 160]Loss:0.004689676687121391
[train] MAP:0.9888174540236395, MRR:0.9894474654783932
[eval] MAP:0.6984032501889644, MRR:0.7006519274376416
[epoch 54, batch 10]Loss:0.03287816047668457
[epoch 54, batch 20]Loss:0.018189257010817528
[epoch 54, batch 30]Loss:0.08087048679590225
[epoch 54, batch 40]Loss:0.026940077543258667
[epoch 54, batch 50]Loss:0.008082709275186062
[epoch 54, batch 60]Loss:0.007596551440656185
[epoch 54, batch 70]Loss:0.023236693814396858
[epoch 54, batch 80]Loss:0.0335269421339035
[epoch 54, batch 90]Loss:0.010071182623505592
[epoch 54, batch 100]Loss:0.0041282204911112785
[epoch 54, batch 110]Loss:0.021399343386292458
[epoch 54, batch 120]Loss:0.035353176295757294
[epoch 54, batch 130]Loss:0.01582540012896061
[epoch 54, batch 140]Loss:0.0348457433283329
[epoch 54, batch 150]Loss:0.007707133889198303
[epoch 54, batch 160]Loss:0.018564991652965546
[train] MAP:0.9907466912621552, MRR:0.9912152948235422
[eval] MAP:0.680952380952381, MRR:0.6861772486772486
[epoch 55, batch 10]Loss:0.036864545196294785
[epoch 55, batch 20]Loss:0.022304747253656387
[epoch 55, batch 30]Loss:0.0010228233877569437
[epoch 55, batch 40]Loss:0.023515673354268074
[epoch 55, batch 50]Loss:0.012620586901903152
[epoch 55, batch 60]Loss:0.08586450666189194
[epoch 55, batch 70]Loss:0.008902030996978283
[epoch 55, batch 80]Loss:0.018820814788341522
[epoch 55, batch 90]Loss:0.00355598796159029
[epoch 55, batch 100]Loss:0.005016633775085211
[epoch 55, batch 110]Loss:0.0322573259472847
[epoch 55, batch 120]Loss:0.007833747193217278
[epoch 55, batch 130]Loss:0.03303300216794014
[epoch 55, batch 140]Loss:0.04022935405373573
[epoch 55, batch 150]Loss:0.05439510568976402
[epoch 55, batch 160]Loss:0.05740116909146309
[train] MAP:0.9943544428080511, MRR:0.9943544428080511
[eval] MAP:0.705347694633409, MRR:0.7105725623582767
[epoch 56, batch 10]Loss:0.012594632804393768
[epoch 56, batch 20]Loss:0.01299935020506382
[epoch 56, batch 30]Loss:0.004912984557449818
[epoch 56, batch 40]Loss:0.025487210601568222
[epoch 56, batch 50]Loss:0.02023981511592865
[epoch 56, batch 60]Loss:0.012827128171920776
[epoch 56, batch 70]Loss:0.015385300852358341
[epoch 56, batch 80]Loss:0.07142163068056107
[epoch 56, batch 90]Loss:0.034761954098939896
[epoch 56, batch 100]Loss:0.013715412467718124
[epoch 56, batch 110]Loss:0.004666274879127741
[epoch 56, batch 120]Loss:0.07516126334667206
[epoch 56, batch 130]Loss:0.028532054275274277
[epoch 56, batch 140]Loss:0.015330411493778229
[epoch 56, batch 150]Loss:0.002540026092901826
[epoch 56, batch 160]Loss:0.0019775398541241884
[train] MAP:0.9925879771240597, MRR:0.9925879771240597
[eval] MAP:0.6967498110355252, MRR:0.701974678760393
[epoch 57, batch 10]Loss:0.012241195887327194
[epoch 57, batch 20]Loss:0.004889099858701229
[epoch 57, batch 30]Loss:0.018729697912931442
[epoch 57, batch 40]Loss:0.0077714985236525536
[epoch 57, batch 50]Loss:0.005318031180649996
[epoch 57, batch 60]Loss:0.0017114502843469381
[epoch 57, batch 70]Loss:0.022950276732444763
[epoch 57, batch 80]Loss:0.0006772031774744391
[epoch 57, batch 90]Loss:0.058456555008888245
[epoch 57, batch 100]Loss:0.002067826921120286
[epoch 57, batch 110]Loss:0.026219388470053673
[epoch 57, batch 120]Loss:0.013287512585520744
[epoch 57, batch 130]Loss:0.058143243193626404
[epoch 57, batch 140]Loss:0.02326323837041855
[epoch 57, batch 150]Loss:0.028449490666389465
[epoch 57, batch 160]Loss:0.011619683355093002
[train] MAP:0.9930794196258113, MRR:0.993270332187858
[eval] MAP:0.705612244897959, MRR:0.7108371126228269
[epoch 58, batch 10]Loss:0.008191078901290894
[epoch 58, batch 20]Loss:0.0034978643525391817
[epoch 58, batch 30]Loss:0.003648016368970275
[epoch 58, batch 40]Loss:0.004200170282274485
[epoch 58, batch 50]Loss:0.07136654108762741
[epoch 58, batch 60]Loss:0.020337309688329697
[epoch 58, batch 70]Loss:0.003862908808514476
[epoch 58, batch 80]Loss:0.0027562412433326244
[epoch 58, batch 90]Loss:0.003735019126906991
[epoch 58, batch 100]Loss:0.009277045726776123
[epoch 58, batch 110]Loss:0.013024342246353626
[epoch 58, batch 120]Loss:0.017760561779141426
[epoch 58, batch 130]Loss:0.0377606526017189
[epoch 58, batch 140]Loss:0.016556324437260628
[epoch 58, batch 150]Loss:0.0187237486243248
[epoch 58, batch 160]Loss:0.47859612107276917
[train] MAP:0.993065258529176, MRR:0.993065258529176
[eval] MAP:0.6946995464852607, MRR:0.6969482237339379
[epoch 59, batch 10]Loss:0.027265992015600204
[epoch 59, batch 20]Loss:0.0042849332094192505
[epoch 59, batch 30]Loss:0.02234937995672226
[epoch 59, batch 40]Loss:0.018231842666864395
[epoch 59, batch 50]Loss:0.01937253400683403
[epoch 59, batch 60]Loss:0.008041180670261383
[epoch 59, batch 70]Loss:0.023281265050172806
[epoch 59, batch 80]Loss:0.012015189044177532
[epoch 59, batch 90]Loss:0.004629422444850206
[epoch 59, batch 100]Loss:0.006839425303041935
[epoch 59, batch 110]Loss:0.006740250159054995
[epoch 59, batch 120]Loss:0.08445513993501663
[epoch 59, batch 130]Loss:0.02914297766983509
[epoch 59, batch 140]Loss:0.028792880475521088
[epoch 59, batch 150]Loss:0.021648721769452095
[epoch 59, batch 160]Loss:0.044377874583005905
[train] MAP:0.9936379962153158, MRR:0.9936379962153158
[eval] MAP:0.6970143613000755, MRR:0.7022392290249432
[epoch 60, batch 10]Loss:0.07702915370464325
[epoch 60, batch 20]Loss:0.016711130738258362
[epoch 60, batch 30]Loss:0.004778777714818716
[epoch 60, batch 40]Loss:0.033376988023519516
[epoch 60, batch 50]Loss:0.01361078955233097
[epoch 60, batch 60]Loss:0.0468057282269001
[epoch 60, batch 70]Loss:0.02199767902493477
[epoch 60, batch 80]Loss:0.0032185399904847145
[epoch 60, batch 90]Loss:0.0029337333980947733
[epoch 60, batch 100]Loss:0.02579190582036972
[epoch 60, batch 110]Loss:0.017276683822274208
[epoch 60, batch 120]Loss:0.0028774840757250786
[epoch 60, batch 130]Loss:0.0036294462624937296
[epoch 60, batch 140]Loss:0.025926681235432625
[epoch 60, batch 150]Loss:0.0018212012946605682
[epoch 60, batch 160]Loss:0.00021616730373352766
[train] MAP:0.9949271804941908, MRR:0.9949271804941908
[eval] MAP:0.6963529856386999, MRR:0.7015778533635676
[epoch 61, batch 10]Loss:0.026493454352021217
[epoch 61, batch 20]Loss:0.00407976983115077
[epoch 61, batch 30]Loss:0.016381796449422836
[epoch 61, batch 40]Loss:0.01818956434726715
[epoch 61, batch 50]Loss:0.0031138951890170574
[epoch 61, batch 60]Loss:0.009677264839410782
[epoch 61, batch 70]Loss:0.0045668017119169235
[epoch 61, batch 80]Loss:0.020288750529289246
[epoch 61, batch 90]Loss:0.041548050940036774
[epoch 61, batch 100]Loss:0.0019444136414676905
[epoch 61, batch 110]Loss:0.008544479496777058
[epoch 61, batch 120]Loss:0.011313291266560555
[epoch 61, batch 130]Loss:0.037595927715301514
[epoch 61, batch 140]Loss:0.03156030923128128
[epoch 61, batch 150]Loss:0.0465400293469429
[epoch 61, batch 160]Loss:0.0002948716573882848
[train] MAP:0.9928939617083947, MRR:0.9928939617083947
[eval] MAP:0.7007180650037791, MRR:0.7059429327286469
[epoch 62, batch 10]Loss:0.04618367180228233
[epoch 62, batch 20]Loss:0.0031114104203879833
[epoch 62, batch 30]Loss:0.0054151322692632675
[epoch 62, batch 40]Loss:0.004096189513802528
[epoch 62, batch 50]Loss:0.031537365168333054
[epoch 62, batch 60]Loss:0.0030407060403376818
[epoch 62, batch 70]Loss:0.0066942754201591015
[epoch 62, batch 80]Loss:0.02466212958097458
[epoch 62, batch 90]Loss:0.008718405850231647
[epoch 62, batch 100]Loss:0.005306871607899666
[epoch 62, batch 110]Loss:0.05312027409672737
[epoch 62, batch 120]Loss:0.003853442380204797
[epoch 62, batch 130]Loss:0.038290832191705704
[epoch 62, batch 140]Loss:0.006815267726778984
[epoch 62, batch 150]Loss:0.01688077487051487
[epoch 62, batch 160]Loss:0.00021128921071067452
[train] MAP:0.9949885452462772, MRR:0.9949885452462772
[eval] MAP:0.7020408163265306, MRR:0.7072656840513983
[epoch 63, batch 10]Loss:0.004306148737668991
[epoch 63, batch 20]Loss:0.0032327123917639256
[epoch 63, batch 30]Loss:0.007809317205101252
[epoch 63, batch 40]Loss:0.061119623482227325
[epoch 63, batch 50]Loss:0.005537344142794609
[epoch 63, batch 60]Loss:0.0034763275180011988
[epoch 63, batch 70]Loss:0.039016589522361755
[epoch 63, batch 80]Loss:0.02060093730688095
[epoch 63, batch 90]Loss:0.024423927068710327
[epoch 63, batch 100]Loss:0.013895651325583458
[epoch 63, batch 110]Loss:0.0321565680205822
[epoch 63, batch 120]Loss:0.039093054831027985
[epoch 63, batch 130]Loss:0.0026619965210556984
[epoch 63, batch 140]Loss:0.015466401353478432
[epoch 63, batch 150]Loss:0.020734092220664024
[epoch 63, batch 160]Loss:0.0023988941684365273
[train] MAP:0.9949334743149176, MRR:0.9949334743149176
[eval] MAP:0.6963529856386997, MRR:0.7015778533635676
[epoch 64, batch 10]Loss:0.033043187111616135
[epoch 64, batch 20]Loss:0.004431829787790775
[epoch 64, batch 30]Loss:0.00651932880282402
[epoch 64, batch 40]Loss:0.05806875601410866
[epoch 64, batch 50]Loss:0.010783771052956581
[epoch 64, batch 60]Loss:0.008338194340467453
[epoch 64, batch 70]Loss:0.006199827417731285
[epoch 64, batch 80]Loss:0.055368244647979736
[epoch 64, batch 90]Loss:0.02572605572640896
[epoch 64, batch 100]Loss:0.0035571239423006773
[epoch 64, batch 110]Loss:0.016542533412575722
[epoch 64, batch 120]Loss:0.007474107202142477
[epoch 64, batch 130]Loss:0.020991245284676552
[epoch 64, batch 140]Loss:0.05670325458049774
[epoch 64, batch 150]Loss:0.026208389550447464
[epoch 64, batch 160]Loss:6.712439062539488e-05
[train] MAP:0.9932916262813171, MRR:0.9932534437689078
[eval] MAP:0.6908730158730159, MRR:0.6960978835978836
[epoch 65, batch 10]Loss:0.022513393312692642
[epoch 65, batch 20]Loss:0.00923248566687107
[epoch 65, batch 30]Loss:0.008759243413805962
[epoch 65, batch 40]Loss:0.008159419521689415
[epoch 65, batch 50]Loss:0.01887507550418377
[epoch 65, batch 60]Loss:0.017957789823412895
[epoch 65, batch 70]Loss:0.010073700919747353
[epoch 65, batch 80]Loss:0.0015988689847290516
[epoch 65, batch 90]Loss:0.01688116416335106
[epoch 65, batch 100]Loss:0.0632951557636261
[epoch 65, batch 110]Loss:0.010314606130123138
[epoch 65, batch 120]Loss:0.009706716053187847
[epoch 65, batch 130]Loss:0.026005368679761887
[epoch 65, batch 140]Loss:0.00265601952560246
[epoch 65, batch 150]Loss:0.03170362114906311
[epoch 65, batch 160]Loss:0.00013672554632648826
[train] MAP:0.994217552207243, MRR:0.994217552207243
[eval] MAP:0.691600529100529, MRR:0.6938492063492063
[epoch 66, batch 10]Loss:0.004397396929562092
[epoch 66, batch 20]Loss:0.0017747272504493594
[epoch 66, batch 30]Loss:0.013799874112010002
[epoch 66, batch 40]Loss:0.024316083639860153
[epoch 66, batch 50]Loss:0.0076368520967662334
[epoch 66, batch 60]Loss:0.008926933631300926
[epoch 66, batch 70]Loss:0.003977075219154358
[epoch 66, batch 80]Loss:0.0317252092063427
[epoch 66, batch 90]Loss:0.04829547181725502
[epoch 66, batch 100]Loss:0.12862937152385712
[epoch 66, batch 110]Loss:0.015147172845900059
[epoch 66, batch 120]Loss:0.011278497986495495
[epoch 66, batch 130]Loss:0.005281842313706875
[epoch 66, batch 140]Loss:0.030805494636297226
[epoch 66, batch 150]Loss:0.009740788489580154
[epoch 66, batch 160]Loss:4.611466283677146e-05
[train] MAP:0.9903079356687604, MRR:0.9905943045118303
[eval] MAP:0.6876322751322751, MRR:0.6898809523809524
[epoch 67, batch 10]Loss:0.01454994734376669
[epoch 67, batch 20]Loss:0.005970134399831295
[epoch 67, batch 30]Loss:0.002159418538212776
[epoch 67, batch 40]Loss:0.02389318309724331
[epoch 67, batch 50]Loss:0.06794565171003342
[epoch 67, batch 60]Loss:0.012897659093141556
[epoch 67, batch 70]Loss:0.006246898323297501
[epoch 67, batch 80]Loss:0.00695999339222908
[epoch 67, batch 90]Loss:0.005435918923467398
[epoch 67, batch 100]Loss:0.03451450914144516
[epoch 67, batch 110]Loss:0.007992175407707691
[epoch 67, batch 120]Loss:0.013078284449875355
[epoch 67, batch 130]Loss:0.007694947998970747
[epoch 67, batch 140]Loss:0.005806004162877798
[epoch 67, batch 150]Loss:0.007386180106550455
[epoch 67, batch 160]Loss:0.05465453863143921
[train] MAP:0.9928620730167121, MRR:0.9928620730167121
[eval] MAP:0.6836640211640211, MRR:0.6859126984126984
[epoch 68, batch 10]Loss:0.09091547876596451
[epoch 68, batch 20]Loss:0.010004610754549503
[epoch 68, batch 30]Loss:0.026834379881620407
[epoch 68, batch 40]Loss:0.022164955735206604
[epoch 68, batch 50]Loss:0.00718429172411561
[epoch 68, batch 60]Loss:0.059235334396362305
[epoch 68, batch 70]Loss:0.029554517939686775
[epoch 68, batch 80]Loss:0.05121335759758949
[epoch 68, batch 90]Loss:0.03272033855319023
[epoch 68, batch 100]Loss:0.0036559165455400944
[epoch 68, batch 110]Loss:0.005917955189943314
[epoch 68, batch 120]Loss:0.03233180567622185
[epoch 68, batch 130]Loss:0.011103078722953796
[epoch 68, batch 140]Loss:0.06541090458631516
[epoch 68, batch 150]Loss:0.002896064892411232
[epoch 68, batch 160]Loss:0.009695271961390972
[train] MAP:0.995582577025876, MRR:0.9955443945134668
[eval] MAP:0.6912037037037038, MRR:0.6934523809523809
[epoch 69, batch 10]Loss:0.006801234558224678
[epoch 69, batch 20]Loss:0.04896271973848343
[epoch 69, batch 30]Loss:0.013404320925474167
[epoch 69, batch 40]Loss:0.003764861263334751
[epoch 69, batch 50]Loss:0.015667686238884926
[epoch 69, batch 60]Loss:0.014266617596149445
[epoch 69, batch 70]Loss:0.012127535417675972
[epoch 69, batch 80]Loss:0.0011048703454434872
[epoch 69, batch 90]Loss:0.01236192137002945
[epoch 69, batch 100]Loss:0.01075927447527647
[epoch 69, batch 110]Loss:0.009153071790933609
[epoch 69, batch 120]Loss:0.002597286133095622
[epoch 69, batch 130]Loss:0.018711594864726067
[epoch 69, batch 140]Loss:0.0031139259226620197
[epoch 69, batch 150]Loss:0.003204821143299341
[epoch 69, batch 160]Loss:2.7581318136071786e-05
[train] MAP:0.9930562373861342, MRR:0.9936862488408881
[eval] MAP:0.6872354497354497, MRR:0.689484126984127
[epoch 70, batch 10]Loss:0.035951949656009674
[epoch 70, batch 20]Loss:0.042008791118860245
[epoch 70, batch 30]Loss:0.03702876716852188
[epoch 70, batch 40]Loss:0.0020105489529669285
[epoch 70, batch 50]Loss:0.005835208110511303
[epoch 70, batch 60]Loss:0.0054895454086363316
[epoch 70, batch 70]Loss:0.0051533873192965984
[epoch 70, batch 80]Loss:0.003935847897082567
[epoch 70, batch 90]Loss:0.007957168854773045
[epoch 70, batch 100]Loss:0.005450842902064323
[epoch 70, batch 110]Loss:0.006574627943336964
[epoch 70, batch 120]Loss:0.006751509848982096
[epoch 70, batch 130]Loss:0.006048128940165043
[epoch 70, batch 140]Loss:0.017637815326452255
[epoch 70, batch 150]Loss:0.019125087186694145
[epoch 70, batch 160]Loss:0.00036762619856745005
[train] MAP:0.9949334743149176, MRR:0.9949334743149176
[eval] MAP:0.692526455026455, MRR:0.6947751322751323
[epoch 71, batch 10]Loss:0.005303239915519953
[epoch 71, batch 20]Loss:0.007232907693833113
[epoch 71, batch 30]Loss:0.03410830721259117
[epoch 71, batch 40]Loss:0.0075360797345638275
[epoch 71, batch 50]Loss:0.02697073109447956
[epoch 71, batch 60]Loss:0.010380683466792107
[epoch 71, batch 70]Loss:0.0030716480687260628
[epoch 71, batch 80]Loss:0.01422274112701416
[epoch 71, batch 90]Loss:0.019787989556789398
[epoch 71, batch 100]Loss:0.0038743894547224045
[epoch 71, batch 110]Loss:0.014124295674264431
[epoch 71, batch 120]Loss:0.03392943739891052
[epoch 71, batch 130]Loss:0.004505842458456755
[epoch 71, batch 140]Loss:0.031112609431147575
[epoch 71, batch 150]Loss:0.04331604018807411
[epoch 71, batch 160]Loss:0.000762188050430268
[train] MAP:0.9933134448598365, MRR:0.9935998137029064
[eval] MAP:0.6876322751322751, MRR:0.6898809523809524
[epoch 72, batch 10]Loss:0.007766335736960173
[epoch 72, batch 20]Loss:0.057585857808589935
[epoch 72, batch 30]Loss:0.013544995337724686
[epoch 72, batch 40]Loss:0.00603188993409276
[epoch 72, batch 50]Loss:0.008163237012922764
[epoch 72, batch 60]Loss:0.0053195166401565075
[epoch 72, batch 70]Loss:0.01079573668539524
[epoch 72, batch 80]Loss:0.012303986586630344
[epoch 72, batch 90]Loss:0.00511798495426774
[epoch 72, batch 100]Loss:0.022744810208678246
[epoch 72, batch 110]Loss:0.023965617641806602
[epoch 72, batch 120]Loss:0.0448669008910656
[epoch 72, batch 130]Loss:0.018185554072260857
[epoch 72, batch 140]Loss:0.04113005846738815
[epoch 72, batch 150]Loss:0.006038579158484936
[epoch 72, batch 160]Loss:0.001083281240426004
[train] MAP:0.995418098510882, MRR:0.995418098510882
[eval] MAP:0.7109032501889644, MRR:0.7161281179138322
[epoch 73, batch 10]Loss:0.010566399432718754
[epoch 73, batch 20]Loss:0.0006979000754654408
[epoch 73, batch 30]Loss:0.017390277236700058
[epoch 73, batch 40]Loss:0.011075060814619064
[epoch 73, batch 50]Loss:0.008316472172737122
[epoch 73, batch 60]Loss:0.0009063798352144659
[epoch 73, batch 70]Loss:0.00931897945702076
[epoch 73, batch 80]Loss:0.011388457380235195
[epoch 73, batch 90]Loss:0.013977600261569023
[epoch 73, batch 100]Loss:0.004827658645808697
[epoch 73, batch 110]Loss:0.04226066917181015
[epoch 73, batch 120]Loss:0.00599708454683423
[epoch 73, batch 130]Loss:0.05819789320230484
[epoch 73, batch 140]Loss:0.0025956896133720875
[epoch 73, batch 150]Loss:0.012538507580757141
[epoch 73, batch 160]Loss:0.04179532453417778
[train] MAP:0.9940653466426662, MRR:0.9943517154857361
[eval] MAP:0.6902116402116403, MRR:0.6954365079365079
[epoch 74, batch 10]Loss:0.02079136297106743
[epoch 74, batch 20]Loss:0.018121397122740746
[epoch 74, batch 30]Loss:0.025173475965857506
[epoch 74, batch 40]Loss:0.014787986874580383
[epoch 74, batch 50]Loss:0.0009544354397803545
[epoch 74, batch 60]Loss:0.051846954971551895
[epoch 74, batch 70]Loss:0.004762351047247648
[epoch 74, batch 80]Loss:0.09478747844696045
[epoch 74, batch 90]Loss:0.019923202693462372
[epoch 74, batch 100]Loss:0.0019846754148602486
[epoch 74, batch 110]Loss:0.007005722261965275
[epoch 74, batch 120]Loss:0.026083379983901978
[epoch 74, batch 130]Loss:0.004469279665499926
[epoch 74, batch 140]Loss:0.003728504292666912
[epoch 74, batch 150]Loss:0.01696724072098732
[epoch 74, batch 160]Loss:3.543097045621835e-05
[train] MAP:0.9942870989262742, MRR:0.9942870989262742
[eval] MAP:0.6826058201058202, MRR:0.6848544973544975
[epoch 75, batch 10]Loss:0.019478026777505875
[epoch 75, batch 20]Loss:0.008109007030725479
[epoch 75, batch 30]Loss:0.0013741332804784179
[epoch 75, batch 40]Loss:0.035201333463191986
[epoch 75, batch 50]Loss:0.009174867533147335
[epoch 75, batch 60]Loss:0.016854364424943924
[epoch 75, batch 70]Loss:0.015811795368790627
[epoch 75, batch 80]Loss:0.007690694183111191
[epoch 75, batch 90]Loss:0.0015906018670648336
[epoch 75, batch 100]Loss:0.02037515491247177
[epoch 75, batch 110]Loss:0.010481787845492363
[epoch 75, batch 120]Loss:0.010957490652799606
[epoch 75, batch 130]Loss:0.014500053599476814
[epoch 75, batch 140]Loss:0.004760549403727055
[epoch 75, batch 150]Loss:0.001142117427662015
[epoch 75, batch 160]Loss:0.002927769673988223
[train] MAP:0.9923634975181367, MRR:0.9923634975181367
[eval] MAP:0.6916131267321743, MRR:0.6968379944570421
[epoch 76, batch 10]Loss:0.06233246624469757
[epoch 76, batch 20]Loss:0.01230806764215231
[epoch 76, batch 30]Loss:0.002402741927653551
[epoch 76, batch 40]Loss:0.07338211685419083
[epoch 76, batch 50]Loss:0.006242775358259678
[epoch 76, batch 60]Loss:0.005882943049073219
[epoch 76, batch 70]Loss:0.003887797938659787
[epoch 76, batch 80]Loss:0.013699510134756565
[epoch 76, batch 90]Loss:0.004098975099623203
[epoch 76, batch 100]Loss:0.04317158833146095
[epoch 76, batch 110]Loss:0.0059767779894173145
[epoch 76, batch 120]Loss:0.0067714122124016285
[epoch 76, batch 130]Loss:0.003677279455587268
[epoch 76, batch 140]Loss:0.02244718372821808
[epoch 76, batch 150]Loss:0.03519895672798157
[epoch 76, batch 160]Loss:0.05568471550941467
[train] MAP:0.9945494463535702, MRR:0.9945494463535702
[eval] MAP:0.6916005291005292, MRR:0.6938492063492063
[epoch 77, batch 10]Loss:0.022743985056877136
[epoch 77, batch 20]Loss:0.008738190867006779
[epoch 77, batch 30]Loss:0.02687026746571064
[epoch 77, batch 40]Loss:0.008785255253314972
[epoch 77, batch 50]Loss:0.024503666907548904
[epoch 77, batch 60]Loss:0.0024057934060692787
[epoch 77, batch 70]Loss:0.002840657252818346
[epoch 77, batch 80]Loss:0.0003389946068637073
[epoch 77, batch 90]Loss:0.01773117296397686
[epoch 77, batch 100]Loss:0.011802840046584606
[epoch 77, batch 110]Loss:0.006364073138684034
[epoch 77, batch 120]Loss:0.018431203439831734
[epoch 77, batch 130]Loss:0.0008211972890421748
[epoch 77, batch 140]Loss:0.005243287887424231
[epoch 77, batch 150]Loss:0.02754250168800354
[epoch 77, batch 160]Loss:4.7516212362097576e-05
[train] MAP:0.9966516873733369, MRR:0.9966516873733369
[eval] MAP:0.6852513227513227, MRR:0.6875000000000001
[epoch 78, batch 10]Loss:0.006418544799089432
[epoch 78, batch 20]Loss:0.04447280615568161
[epoch 78, batch 30]Loss:0.05525015667080879
[epoch 78, batch 40]Loss:0.00622933404520154
[epoch 78, batch 50]Loss:0.005229721311479807
[epoch 78, batch 60]Loss:0.0029346433002501726
[epoch 78, batch 70]Loss:0.014515934512019157
[epoch 78, batch 80]Loss:0.04986784607172012
[epoch 78, batch 90]Loss:0.016848493367433548
[epoch 78, batch 100]Loss:0.0008377589983865619
[epoch 78, batch 110]Loss:0.01558615267276764
[epoch 78, batch 120]Loss:0.0028201688546687365
[epoch 78, batch 130]Loss:0.040899842977523804
[epoch 78, batch 140]Loss:0.0040680416859686375
[epoch 78, batch 150]Loss:0.022950410842895508
[epoch 78, batch 160]Loss:0.2623637020587921
[train] MAP:0.9966590301641849, MRR:0.9966590301641849
[eval] MAP:0.6832671957671957, MRR:0.685515873015873
[epoch 79, batch 10]Loss:0.047792401164770126
[epoch 79, batch 20]Loss:0.0043288348242640495
[epoch 79, batch 30]Loss:0.005617709364742041
[epoch 79, batch 40]Loss:0.007444893009960651
[epoch 79, batch 50]Loss:0.0028475220315158367
[epoch 79, batch 60]Loss:0.004944697953760624
[epoch 79, batch 70]Loss:0.016725022345781326
[epoch 79, batch 80]Loss:0.020202452316880226
[epoch 79, batch 90]Loss:0.004323100671172142
[epoch 79, batch 100]Loss:0.010918498039245605
[epoch 79, batch 110]Loss:0.01841508224606514
[epoch 79, batch 120]Loss:0.03672649711370468
[epoch 79, batch 130]Loss:0.012956628575921059
[epoch 79, batch 140]Loss:0.0025474249850958586
[epoch 79, batch 150]Loss:0.000842989538796246
[epoch 79, batch 160]Loss:0.07691291719675064
[train] MAP:0.9960862924780451, MRR:0.9960862924780451
[eval] MAP:0.6783730158730158, MRR:0.6806216931216932
[epoch 80, batch 10]Loss:0.0036751723382622004
[epoch 80, batch 20]Loss:0.008972739800810814
[epoch 80, batch 30]Loss:0.0402555987238884
[epoch 80, batch 40]Loss:0.021139584481716156
[epoch 80, batch 50]Loss:0.002708670450374484
[epoch 80, batch 60]Loss:0.0028682989068329334
[epoch 80, batch 70]Loss:0.00410663103684783
[epoch 80, batch 80]Loss:0.0035814326256513596
[epoch 80, batch 90]Loss:0.03972858935594559
[epoch 80, batch 100]Loss:0.014402056112885475
[epoch 80, batch 110]Loss:0.026616182178258896
[epoch 80, batch 120]Loss:0.012660905718803406
[epoch 80, batch 130]Loss:0.022209398448467255
[epoch 80, batch 140]Loss:0.00618659658357501
[epoch 80, batch 150]Loss:0.01558772288262844
[epoch 80, batch 160]Loss:0.0005479942192323506
[train] MAP:0.9934443563309543, MRR:0.9934443563309543
[eval] MAP:0.6953609221466364, MRR:0.6976095993953136
[epoch 81, batch 10]Loss:0.004104157444089651
[epoch 81, batch 20]Loss:0.049182694405317307
[epoch 81, batch 30]Loss:0.006202717777341604
[epoch 81, batch 40]Loss:0.01246420294046402
[epoch 81, batch 50]Loss:0.012094531208276749
[epoch 81, batch 60]Loss:0.0536363385617733
[epoch 81, batch 70]Loss:0.0008798599592410028
[epoch 81, batch 80]Loss:0.03649882972240448
[epoch 81, batch 90]Loss:0.004839606117457151
[epoch 81, batch 100]Loss:0.0020952203776687384
[epoch 81, batch 110]Loss:0.01596074178814888
[epoch 81, batch 120]Loss:0.010071092285215855
[epoch 81, batch 130]Loss:0.012038376182317734
[epoch 81, batch 140]Loss:0.003659757785499096
[epoch 81, batch 150]Loss:0.0009575463482178748
[epoch 81, batch 160]Loss:0.0057733748108148575
[train] MAP:0.9960317460317459, MRR:0.9960317460317459
[eval] MAP:0.6920540438397582, MRR:0.6943027210884354
[epoch 82, batch 10]Loss:0.004359239246696234
[epoch 82, batch 20]Loss:0.022235553711652756
[epoch 82, batch 30]Loss:0.03411095216870308
[epoch 82, batch 40]Loss:0.015267735347151756
[epoch 82, batch 50]Loss:0.005007774569094181
[epoch 82, batch 60]Loss:0.0601583756506443
[epoch 82, batch 70]Loss:0.005242490209639072
[epoch 82, batch 80]Loss:0.00398512976244092
[epoch 82, batch 90]Loss:0.003608684753999114
[epoch 82, batch 100]Loss:0.0008318099426105618
[epoch 82, batch 110]Loss:0.002161721233278513
[epoch 82, batch 120]Loss:0.03434056043624878
[epoch 82, batch 130]Loss:0.002741436706855893
[epoch 82, batch 140]Loss:0.00675812317058444
[epoch 82, batch 150]Loss:0.03966391086578369
[epoch 82, batch 160]Loss:8.085726585704833e-05
[train] MAP:0.9949271804941908, MRR:0.9949271804941908
[eval] MAP:0.6744047619047618, MRR:0.6766534391534392
[epoch 83, batch 10]Loss:0.0024022997822612524
[epoch 83, batch 20]Loss:0.0016502386424690485
[epoch 83, batch 30]Loss:0.00446356413885951
[epoch 83, batch 40]Loss:0.007632041350007057
[epoch 83, batch 50]Loss:0.010264134034514427
[epoch 83, batch 60]Loss:0.028821870684623718
[epoch 83, batch 70]Loss:0.00650433823466301
[epoch 83, batch 80]Loss:0.009929399937391281
[epoch 83, batch 90]Loss:0.016581574454903603
[epoch 83, batch 100]Loss:0.00232627522200346
[epoch 83, batch 110]Loss:0.07378443330526352
[epoch 83, batch 120]Loss:0.0027583776973187923
[epoch 83, batch 130]Loss:0.002754977671429515
[epoch 83, batch 140]Loss:0.06368370354175568
[epoch 83, batch 150]Loss:0.015206950716674328
[epoch 83, batch 160]Loss:0.00024846551241353154
[train] MAP:0.9944567173948616, MRR:0.9944567173948616
[eval] MAP:0.6792989417989418, MRR:0.6815476190476191
[epoch 84, batch 10]Loss:0.004479589872062206
[epoch 84, batch 20]Loss:0.0019076310563832521
[epoch 84, batch 30]Loss:0.005876685492694378
[epoch 84, batch 40]Loss:0.015002908185124397
[epoch 84, batch 50]Loss:0.01399904116988182
[epoch 84, batch 60]Loss:0.04032883048057556
[epoch 84, batch 70]Loss:0.007258817087858915
[epoch 84, batch 80]Loss:0.0030669455882161856
[epoch 84, batch 90]Loss:0.0034377924166619778
[epoch 84, batch 100]Loss:0.0014490648172795773
[epoch 84, batch 110]Loss:0.015472429804503918
[epoch 84, batch 120]Loss:0.016318781301379204
[epoch 84, batch 130]Loss:0.003830814501270652
[epoch 84, batch 140]Loss:0.007831867784261703
[epoch 84, batch 150]Loss:0.06092829257249832
[epoch 84, batch 160]Loss:0.000583012355491519
[train] MAP:0.9948453608247423, MRR:0.9948453608247423
[eval] MAP:0.6687169312169312, MRR:0.6709656084656084
[epoch 85, batch 10]Loss:0.08242625743150711
[epoch 85, batch 20]Loss:0.029575929045677185
[epoch 85, batch 30]Loss:0.044312357902526855
[epoch 85, batch 40]Loss:0.006518431939184666
[epoch 85, batch 50]Loss:0.06647069752216339
[epoch 85, batch 60]Loss:0.010544533841311932
[epoch 85, batch 70]Loss:0.00510719558224082
[epoch 85, batch 80]Loss:0.012662292458117008
[epoch 85, batch 90]Loss:0.0019064927473664284
[epoch 85, batch 100]Loss:0.009483213536441326
[epoch 85, batch 110]Loss:0.0011450465535745025
[epoch 85, batch 120]Loss:0.007338574156165123
[epoch 85, batch 130]Loss:0.0011278979945927858
[epoch 85, batch 140]Loss:0.003157765604555607
[epoch 85, batch 150]Loss:0.0018039960414171219
[epoch 85, batch 160]Loss:0.0009295209893025458
[train] MAP:0.9972317678503246, MRR:0.9972317678503246
[eval] MAP:0.6720238095238095, MRR:0.6742724867724869
[epoch 86, batch 10]Loss:0.006055518519133329
[epoch 86, batch 20]Loss:0.0357770174741745
[epoch 86, batch 30]Loss:0.025814523920416832
[epoch 86, batch 40]Loss:0.01147471647709608
[epoch 86, batch 50]Loss:0.008711863309144974
[epoch 86, batch 60]Loss:0.001128339092247188
[epoch 86, batch 70]Loss:0.01014179177582264
[epoch 86, batch 80]Loss:0.006323599722236395
[epoch 86, batch 90]Loss:0.005430786870419979
[epoch 86, batch 100]Loss:0.0647522360086441
[epoch 86, batch 110]Loss:0.0007399526657536626
[epoch 86, batch 120]Loss:0.020068172365427017
[epoch 86, batch 130]Loss:0.0031509986147284508
[epoch 86, batch 140]Loss:0.056029465049505234
[epoch 86, batch 150]Loss:0.031263042241334915
[epoch 86, batch 160]Loss:0.0009744259295985103
[train] MAP:0.9943353515518464, MRR:0.9949653630066001
[eval] MAP:0.6729497354497355, MRR:0.6751984126984127
[epoch 87, batch 10]Loss:0.013054675422608852
[epoch 87, batch 20]Loss:0.0040453337132930756
[epoch 87, batch 30]Loss:0.0020942711271345615
[epoch 87, batch 40]Loss:0.0005053408676758409
[epoch 87, batch 50]Loss:0.0354565791785717
[epoch 87, batch 60]Loss:0.006478907074779272
[epoch 87, batch 70]Loss:0.009157033637166023
[epoch 87, batch 80]Loss:0.001276563503779471
[epoch 87, batch 90]Loss:0.0014434029581025243
[epoch 87, batch 100]Loss:0.0063658207654953
[epoch 87, batch 110]Loss:0.0719979852437973
[epoch 87, batch 120]Loss:0.010326397605240345
[epoch 87, batch 130]Loss:0.030790338292717934
[epoch 87, batch 140]Loss:0.011088835075497627
[epoch 87, batch 150]Loss:0.023063398897647858
[epoch 87, batch 160]Loss:0.00031471007969230413
[train] MAP:0.9939120921079684, MRR:0.9939120921079684
[eval] MAP:0.6836640211640211, MRR:0.6859126984126985
[epoch 88, batch 10]Loss:0.003912610933184624
[epoch 88, batch 20]Loss:0.0002555186511017382
[epoch 88, batch 30]Loss:0.00048208649968728423
[epoch 88, batch 40]Loss:0.004644199274480343
[epoch 88, batch 50]Loss:0.08825655281543732
[epoch 88, batch 60]Loss:0.0027170816902071238
[epoch 88, batch 70]Loss:0.001953855389729142
[epoch 88, batch 80]Loss:0.003106987103819847
[epoch 88, batch 90]Loss:0.002897833939641714
[epoch 88, batch 100]Loss:0.037098754197359085
[epoch 88, batch 110]Loss:0.0051375520415604115
[epoch 88, batch 120]Loss:0.051797132939100266
[epoch 88, batch 130]Loss:0.0061179110780358315
[epoch 88, batch 140]Loss:0.006647611036896706
[epoch 88, batch 150]Loss:0.00727418577298522
[epoch 88, batch 160]Loss:0.0003140487533528358
[train] MAP:0.9977971627456164, MRR:0.9977971627456164
[eval] MAP:0.6878968253968254, MRR:0.6901455026455026
[epoch 89, batch 10]Loss:0.0031553958542644978
[epoch 89, batch 20]Loss:0.06457926332950592
[epoch 89, batch 30]Loss:0.02493603341281414
[epoch 89, batch 40]Loss:0.0015179375186562538
[epoch 89, batch 50]Loss:0.03153495863080025
[epoch 89, batch 60]Loss:0.001875945134088397
[epoch 89, batch 70]Loss:0.008335458114743233
[epoch 89, batch 80]Loss:0.0002646403154358268
[epoch 89, batch 90]Loss:0.0006399255944415927
[epoch 89, batch 100]Loss:0.00246150279417634
[epoch 89, batch 110]Loss:0.0205819271504879
[epoch 89, batch 120]Loss:0.0013768356293439865
[epoch 89, batch 130]Loss:0.007138327229768038
[epoch 89, batch 140]Loss:0.005297492723912001
[epoch 89, batch 150]Loss:0.11684074997901917
[epoch 89, batch 160]Loss:2.0666930140578188e-05
[train] MAP:0.9967471436543602, MRR:0.9967471436543602
[eval] MAP:0.6902116402116403, MRR:0.6954365079365079
[epoch 90, batch 10]Loss:0.02574245259165764
[epoch 90, batch 20]Loss:0.002082193735986948
[epoch 90, batch 30]Loss:0.02536049671471119
[epoch 90, batch 40]Loss:0.004167902749031782
[epoch 90, batch 50]Loss:0.0002699046744965017
[epoch 90, batch 60]Loss:0.0007258522673510015
[epoch 90, batch 70]Loss:0.0018808153690770268
[epoch 90, batch 80]Loss:0.005012981593608856
[epoch 90, batch 90]Loss:0.01263145450502634
[epoch 90, batch 100]Loss:0.004029326606541872
[epoch 90, batch 110]Loss:0.007566968910396099
[epoch 90, batch 120]Loss:0.0045568207278847694
[epoch 90, batch 130]Loss:0.0010754266986623406
[epoch 90, batch 140]Loss:0.005210153292864561
[epoch 90, batch 150]Loss:0.0020223180763423443
[epoch 90, batch 160]Loss:0.0003611880529206246
[train] MAP:0.9942789169593292, MRR:0.9942789169593292
[eval] MAP:0.68260582010582, MRR:0.6848544973544974
[epoch 91, batch 10]Loss:0.023344367742538452
[epoch 91, batch 20]Loss:0.03358322009444237
[epoch 91, batch 30]Loss:0.02268892712891102
[epoch 91, batch 40]Loss:0.0039978944696486
[epoch 91, batch 50]Loss:0.007526027970016003
[epoch 91, batch 60]Loss:0.025361869484186172
[epoch 91, batch 70]Loss:0.0025020968168973923
[epoch 91, batch 80]Loss:0.0329163521528244
[epoch 91, batch 90]Loss:0.001565232640132308
[epoch 91, batch 100]Loss:0.00851084291934967
[epoch 91, batch 110]Loss:0.0017638729186728597
[epoch 91, batch 120]Loss:0.01301048044115305
[epoch 91, batch 130]Loss:0.026684077456593513
[epoch 91, batch 140]Loss:0.043718598783016205
[epoch 91, batch 150]Loss:0.007785573601722717
[epoch 91, batch 160]Loss:0.0006382337887771428
[train] MAP:0.9959431080565102, MRR:0.9959431080565102
[eval] MAP:0.6826719576719577, MRR:0.6878968253968254
[epoch 92, batch 10]Loss:0.012796075083315372
[epoch 92, batch 20]Loss:0.003542047692462802
[epoch 92, batch 30]Loss:0.0045895809307694435
[epoch 92, batch 40]Loss:0.01054432988166809
[epoch 92, batch 50]Loss:0.0011733423452824354
[epoch 92, batch 60]Loss:0.014437450096011162
[epoch 92, batch 70]Loss:0.011554649099707603
[epoch 92, batch 80]Loss:0.007476390805095434
[epoch 92, batch 90]Loss:0.026625795289874077
[epoch 92, batch 100]Loss:0.031220633536577225
[epoch 92, batch 110]Loss:0.005552398040890694
[epoch 92, batch 120]Loss:0.008469192311167717
[epoch 92, batch 130]Loss:0.004807492718100548
[epoch 92, batch 140]Loss:0.0015998007729649544
[epoch 92, batch 150]Loss:0.010435692965984344
[epoch 92, batch 160]Loss:0.009357783012092113
[train] MAP:0.9979954180985109, MRR:0.9979954180985109
[eval] MAP:0.6941798941798942, MRR:0.6994047619047619
[epoch 93, batch 10]Loss:0.000689419568516314
[epoch 93, batch 20]Loss:0.04908403009176254
[epoch 93, batch 30]Loss:0.0002470863109920174
[epoch 93, batch 40]Loss:0.026985539123415947
[epoch 93, batch 50]Loss:0.0003506963839754462
[epoch 93, batch 60]Loss:0.0009698571520857513
[epoch 93, batch 70]Loss:0.055362917482852936
[epoch 93, batch 80]Loss:0.0037805549800395966
[epoch 93, batch 90]Loss:0.0007353766704909503
[epoch 93, batch 100]Loss:0.0003285359125584364
[epoch 93, batch 110]Loss:0.0022474199067801237
[epoch 93, batch 120]Loss:0.003443900030106306
[epoch 93, batch 130]Loss:0.023202918469905853
[epoch 93, batch 140]Loss:0.011513813398778439
[epoch 93, batch 150]Loss:0.0022123234812170267
[epoch 93, batch 160]Loss:0.003840138204395771
[train] MAP:0.9955135547919052, MRR:0.9955135547919052
[eval] MAP:0.6945767195767195, MRR:0.6998015873015873
[epoch 94, batch 10]Loss:0.0012617498869076371
[epoch 94, batch 20]Loss:0.0033451842609792948
[epoch 94, batch 30]Loss:0.004787806887179613
[epoch 94, batch 40]Loss:0.009816955775022507
[epoch 94, batch 50]Loss:0.0028502880595624447
[epoch 94, batch 60]Loss:0.0010280576534569263
[epoch 94, batch 70]Loss:0.006512741092592478
[epoch 94, batch 80]Loss:0.0026070240419358015
[epoch 94, batch 90]Loss:0.02415723353624344
[epoch 94, batch 100]Loss:0.02142471820116043
[epoch 94, batch 110]Loss:0.006080067716538906
[epoch 94, batch 120]Loss:0.007867621257901192
[epoch 94, batch 130]Loss:0.005418814718723297
[epoch 94, batch 140]Loss:0.0035185751039534807
[epoch 94, batch 150]Loss:0.027509165927767754
[epoch 94, batch 160]Loss:0.0007548400899395347
[train] MAP:0.997709049255441, MRR:0.997709049255441
[eval] MAP:0.6984032501889644, MRR:0.7006519274376416
[epoch 95, batch 10]Loss:0.002634372329339385
[epoch 95, batch 20]Loss:0.010387520305812359
[epoch 95, batch 30]Loss:0.0017649945802986622
[epoch 95, batch 40]Loss:0.012259985320270061
[epoch 95, batch 50]Loss:0.01283257082104683
[epoch 95, batch 60]Loss:0.0015812008641660213
[epoch 95, batch 70]Loss:0.010458809323608875
[epoch 95, batch 80]Loss:0.013755128718912601
[epoch 95, batch 90]Loss:0.004204504191875458
[epoch 95, batch 100]Loss:0.0038717128336429596
[epoch 95, batch 110]Loss:0.00062204385176301
[epoch 95, batch 120]Loss:0.06608278304338455
[epoch 95, batch 130]Loss:0.01251593604683876
[epoch 95, batch 140]Loss:0.002190992934629321
[epoch 95, batch 150]Loss:0.0061751664616167545
[epoch 95, batch 160]Loss:0.003608853090554476
[train] MAP:0.996699939998909, MRR:0.996699939998909
[eval] MAP:0.683994708994709, MRR:0.6892195767195769
[epoch 96, batch 10]Loss:0.0023145959712564945
[epoch 96, batch 20]Loss:0.05499383807182312
[epoch 96, batch 30]Loss:0.0014133842196315527
[epoch 96, batch 40]Loss:0.0067695011384785175
[epoch 96, batch 50]Loss:0.006135382689535618
[epoch 96, batch 60]Loss:0.004170936066657305
[epoch 96, batch 70]Loss:0.00837900023907423
[epoch 96, batch 80]Loss:0.07448127120733261
[epoch 96, batch 90]Loss:0.003015703521668911
[epoch 96, batch 100]Loss:0.0175107941031456
[epoch 96, batch 110]Loss:0.011784030124545097
[epoch 96, batch 120]Loss:0.00321702822111547
[epoch 96, batch 130]Loss:0.0022897531744092703
[epoch 96, batch 140]Loss:0.0937737375497818
[epoch 96, batch 150]Loss:0.0038629628252238035
[epoch 96, batch 160]Loss:0.04231610149145126
[train] MAP:0.9965444826269568, MRR:0.9968881252386407
[eval] MAP:0.6958994708994709, MRR:0.7011243386243386
[epoch 97, batch 10]Loss:0.006935613229870796
[epoch 97, batch 20]Loss:0.020648306235671043
[epoch 97, batch 30]Loss:0.069636270403862
[epoch 97, batch 40]Loss:0.008884801529347897
[epoch 97, batch 50]Loss:0.001641821931116283
[epoch 97, batch 60]Loss:0.013976659625768661
[epoch 97, batch 70]Loss:0.023302633315324783
[epoch 97, batch 80]Loss:0.0015568943927064538
[epoch 97, batch 90]Loss:0.03732281178236008/home/xh2018/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters

[epoch 97, batch 100]Loss:0.0030137489084154367
[epoch 97, batch 110]Loss:0.005949331447482109
[epoch 97, batch 120]Loss:0.0027202446945011616
[epoch 97, batch 130]Loss:0.0038115298375487328
[epoch 97, batch 140]Loss:0.004589545540511608
[epoch 97, batch 150]Loss:0.0004689051129389554
[epoch 97, batch 160]Loss:0.0007464599912054837
[train] MAP:0.9972794959908362, MRR:0.9972794959908362
[eval] MAP:0.6967498110355252, MRR:0.701974678760393
[epoch 98, batch 10]Loss:0.001210952177643776
[epoch 98, batch 20]Loss:0.008460432291030884
[epoch 98, batch 30]Loss:0.00526353158056736
[epoch 98, batch 40]Loss:0.026033829897642136
[epoch 98, batch 50]Loss:0.012412858195602894
[epoch 98, batch 60]Loss:0.019617391750216484
[epoch 98, batch 70]Loss:0.006974607706069946
[epoch 98, batch 80]Loss:0.01930226944386959
[epoch 98, batch 90]Loss:0.0008786575635895133
[epoch 98, batch 100]Loss:0.02466607093811035
[epoch 98, batch 110]Loss:0.02918701432645321
[epoch 98, batch 120]Loss:0.006560455542057753
[epoch 98, batch 130]Loss:0.004379205405712128
[epoch 98, batch 140]Loss:0.0014876755885779858
[epoch 98, batch 150]Loss:0.039874881505966187
[epoch 98, batch 160]Loss:0.004290988203138113
[train] MAP:0.9962772050400917, MRR:0.9962772050400917
[eval] MAP:0.6836640211640211, MRR:0.6859126984126984
[epoch 99, batch 10]Loss:0.003099679248407483
[epoch 99, batch 20]Loss:0.0008182541350834072
[epoch 99, batch 30]Loss:0.004639406222850084
[epoch 99, batch 40]Loss:0.0032655009999871254
[epoch 99, batch 50]Loss:0.005477639846503735
[epoch 99, batch 60]Loss:0.00034982722718268633
[epoch 99, batch 70]Loss:0.003282455727458
[epoch 99, batch 80]Loss:0.027343612164258957
[epoch 99, batch 90]Loss:0.0007062680670060217
[epoch 99, batch 100]Loss:0.013516628183424473
[epoch 99, batch 110]Loss:0.0021978600416332483
[epoch 99, batch 120]Loss:0.0030918377451598644
[epoch 99, batch 130]Loss:0.0009454439859837294
[epoch 99, batch 140]Loss:0.031493179500103
[epoch 99, batch 150]Loss:0.002927804132923484
[epoch 99, batch 160]Loss:0.0017224596813321114
[train] MAP:0.9963181148748158, MRR:0.9963181148748158
[eval] MAP:0.6951719576719577, MRR:0.6974206349206349
total time:   5851.276518344879
